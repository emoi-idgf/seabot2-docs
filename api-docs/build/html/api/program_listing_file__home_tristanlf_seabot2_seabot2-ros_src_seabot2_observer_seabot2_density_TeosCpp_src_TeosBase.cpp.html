

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Program Listing for File TeosBase.cpp &mdash; Seabot2 ROS2 API 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css?v=a885cde7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js?v=73120307"></script>
      <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js?v=660e4f45"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #1D8BC2" >

          
          
          <a href="../index.html" class="icon icon-home">
            Seabot2 ROS2 API
              <img src="../_static/seabot2_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Program Listing for File TeosBase.cpp</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #1D8BC2" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Seabot2 ROS2 API</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Program Listing for File TeosBase.cpp</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/program_listing_file__home_tristanlf_seabot2_seabot2-ros_src_seabot2_observer_seabot2_density_TeosCpp_src_TeosBase.cpp.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="program-listing-for-file-teosbase-cpp">
<span id="program-listing-file-home-tristanlf-seabot2-seabot2-ros-src-seabot2-observer-seabot2-density-teoscpp-src-teosbase-cpp"></span><h1>Program Listing for File TeosBase.cpp<a class="headerlink" href="#program-listing-for-file-teosbase-cpp" title="Link to this heading"></a></h1>
<p>↰ <a class="reference internal" href="file__home_tristanlf_seabot2_seabot2-ros_src_seabot2_observer_seabot2_density_TeosCpp_src_TeosBase.cpp.html#file-home-tristanlf-seabot2-seabot2-ros-src-seabot2-observer-seabot2-density-teoscpp-src-teosbase-cpp"><span class="std std-ref">Return to documentation for file</span></a> (<code class="docutils literal notranslate"><span class="pre">/home/tristanlf/seabot2/seabot2-ros/src/seabot2_observer/seabot2_density/TeosCpp/src/TeosBase.cpp</span></code>)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cm">/******************************************</span>
<span class="cm">  TeosBase.cpp Version 1.06</span>
<span class="cm">  Base class for TeosIce, TeosSea, and</span>
<span class="cm">  Teos_Matlab classes</span>
<span class="cm">  ---------------------------------------</span>
<span class="cm">  by Randall Kent Whited</span>
<span class="cm">  rkwhited@gmail.com</span>
<span class="cm">  ---------------------------------------</span>
<span class="cm">  All copyrights and all license issues</span>
<span class="cm">  are the same as for previous versions</span>
<span class="cm">*******************************************/</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TeosBase.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;TeosCppSupp.h&quot;</span>

<span class="n">TeosBase</span><span class="o">::</span><span class="n">TeosBase</span><span class="p">()</span>
<span class="o">:</span><span class="w"> </span><span class="n">t1</span><span class="p">(</span><span class="mf">3.68017112855051e-2</span><span class="p">,</span><span class="w"> </span><span class="mf">5.10878114959572e-2</span><span class="p">),</span><span class="n">t2</span><span class="p">(</span><span class="mf">3.37315741065416e-1</span><span class="p">,</span><span class="w"> </span><span class="mf">3.35449415919309e-1</span><span class="p">),</span>
<span class="n">r1</span><span class="p">(</span><span class="mf">4.47050716285388e1</span><span class="p">,</span><span class="w"> </span><span class="mf">6.56876847463481e1</span><span class="p">),</span>
<span class="n">r20</span><span class="p">(</span><span class="mf">-7.25974574329220e1</span><span class="p">,</span><span class="w"> </span><span class="mf">-7.81008427112870e1</span><span class="p">),</span>
<span class="n">r21</span><span class="p">(</span><span class="mf">-5.57107698030123e-5</span><span class="p">,</span><span class="w"> </span><span class="mf">4.64578634580806e-5</span><span class="p">),</span>
<span class="n">r22</span><span class="p">(</span><span class="mf">2.34801409215913e-11</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.85651142904972e-11</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pSaarData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SaarDataHandler</span><span class="p">();</span>

<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">init_GSW_SPECVOL_COEFFICIENTS</span><span class="p">();</span>

<span class="w">    </span><span class="n">gtc</span><span class="p">.</span><span class="n">init_GSW_TEOS10_CONSTANTS</span><span class="p">();</span>

<span class="w">    </span><span class="n">gbalt</span><span class="p">.</span><span class="n">init_GSW_BALTIC_DATA</span><span class="p">();</span>

<span class="w">    </span><span class="n">gsaar</span><span class="p">.</span><span class="n">init_GSW_SAAR_DATA</span><span class="p">();</span>

<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">init_GSW_SP_COEFFICIENTS</span><span class="p">();</span>

<span class="w">    </span><span class="n">gfpc</span><span class="p">.</span><span class="n">init_GSW_FREEZING_POLY_COEFFICIENTS</span><span class="p">();</span>

<span class="w">    </span><span class="n">gic</span><span class="p">.</span><span class="n">init_GSW_GIBBS_ICE_COEFFICIENTS</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="n">bad_alloc</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">badBaseAlloc</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="cm">/***************************************</span>
<span class="cm">    This destructor deletes &quot;pSaarData&quot;</span>
<span class="cm">    ----------------------------------</span>
<span class="cm">    (a pointer to an object of the</span>
<span class="cm">    &quot;SaarDataHandler&quot; class)</span>
<span class="cm">****************************************/</span>
<span class="n">TeosBase</span><span class="o">::~</span><span class="n">TeosBase</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pSaarData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">pSaarData</span><span class="p">;</span>
<span class="w">    </span><span class="n">pSaarData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_alpha                   thermal expansion coefficient with respect to</span>
<span class="cm">%                               Conservative Temperature (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_alpha(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the thermal expansion coefficient of seawater with respect to</span>
<span class="cm">%  Conservative Temperature using the computationally-efficient expression</span>
<span class="cm">%  for specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  alpha  =  thermal expansion coefficient                          [ 1/K ]</span>
<span class="cm">%            with respect to Conservative Temperature</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.18.3) of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_alpha</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">v_ct_part</span><span class="p">;</span>

<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>
<span class="w">  </span><span class="n">v_ct_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_get_v_ct_part</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v_ct_part</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_specvol</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_beta                       saline contraction coefficient at constant</span>
<span class="cm">%                               Conservative Temperature (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_beta(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the saline (i.e. haline) contraction coefficient of seawater</span>
<span class="cm">%  at constant Conservative Temperature using the computationally-efficient</span>
<span class="cm">%  75-term expression for specific volume in terms of SA, CT and p</span>
<span class="cm">%  (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  beta  =  saline contraction coefficient                         [ kg/g ]</span>
<span class="cm">%           at constant Conservative Temperature</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.19.3) of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_beta</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">v_sa_part</span><span class="p">;</span>

<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>
<span class="w">  </span><span class="n">v_sa_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gsvco_b</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">v_sa_part</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_specvol</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_chem_potential_water_t_exact              chemical potential of water</span>
<span class="cm">%                                                               in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  chem_potential_water_t_exact  = gsw_chem_potential_water_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the chemical potential of water in seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  chem_potential_water_t_exact  =  chemical potential of water in seawater</span>
<span class="cm">%                                                                   [ J/g ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_chem_potential_water_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03g_plus_g08g</span><span class="p">,</span><span class="w"> </span><span class="n">g_sa_part</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">kg2g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-3</span><span class="p">;</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>

<span class="w">  </span><span class="n">g03g_plus_g08g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_get_g03plusg08_h</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>

<span class="w">  </span><span class="n">g_sa_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8645.36753595126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">180.142097805543</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-219.1676534131548</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">-16.32775915649044</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">120.7020447884644</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">598.378809221703</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-156.8822727844005</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">204.1334828179377</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10.23755797323846</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1149.174198007428</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-162.5751787551336</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">76.9195462169742</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1380.9597954037708</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.626801985426835</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">703.695562834065</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1187.3715515697959</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">kg2g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g03g_plus_g08g</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_sa_part</span><span class="p">);</span>
<span class="p">}</span>


<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_ct_first_derivatives_wrt_t_exact    first derivatives of Conservative</span>
<span class="cm">%                                           Temperature with respect to (or</span>
<span class="cm">%                                          at constant) in-situ temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_ct_first_derivatives_wrt_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following three derivatives of Conservative Temperature.</span>
<span class="cm">%  These derivatives are done with respect to in-situ temperature t (in the</span>
<span class="cm">%  case of CT_T_wrt_t) or at constant in-situ tempertature (in the cases of</span>
<span class="cm">%  CT_SA_wrt_t and CT_P_wrt_t).</span>
<span class="cm">%   (1) CT_SA_wrt_t, the derivative of CT with respect to Absolute Salinity</span>
<span class="cm">%       at constant t and p, and</span>
<span class="cm">%   (2) CT_T_wrt_t, derivative of CT with respect to in-situ temperature t</span>
<span class="cm">%       at constant SA and p.</span>
<span class="cm">%   (3) CT_P_wrt_t, derivative of CT with respect to pressure P (in Pa) at</span>
<span class="cm">%       constant SA and t.</span>
<span class="cm">%</span>
<span class="cm">%  This function uses the full Gibbs function. Note that this function</span>
<span class="cm">%  avoids the NaN that would exist in CT_SA_wrt_t at SA = 0 if it were</span>
<span class="cm">%  evaluated in the straightforward way from the derivatives of the Gibbs</span>
<span class="cm">%  function function.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar)</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  CT_SA_wrt_t  =  The first derivative of Conservative Temperature with</span>
<span class="cm">%                  respect to Absolute Salinity at constant t and p.</span>
<span class="cm">%                                              [ K/(g/kg)]  i.e. [ K kg/g ]</span>
<span class="cm">%  CT_T_wrt_t  =  The first derivative of Conservative Temperature with</span>
<span class="cm">%                 respect to in-situ temperature, t, at constant SA and p.</span>
<span class="cm">%                                                              [ unitless ]</span>
<span class="cm">%  CT_P_wrt_t  =  The first derivative of Conservative Temperature with</span>
<span class="cm">%                 respect to pressure P (in Pa) at constant SA and t.</span>
<span class="cm">%                                                                  [ K/Pa ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See Eqns. (A.15.3) and (A.15.8) of this TEOS-10 Manual for</span>
<span class="cm">%    CT_T_wrt_t and CT_SA_wrt_t respectively.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_ct_first_derivatives_wrt_t_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct_sa_wrt_t</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct_t_wrt_t</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct_p_wrt_t</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g_sa_mod</span><span class="p">,</span><span class="w"> </span><span class="n">g_sa_t_mod</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y_pt</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt0_from_t</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ct_sa_wrt_t</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">);</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pt0</span><span class="p">;</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">    </span><span class="n">g_sa_t_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1458.233059470092</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">249.375342232496</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-63.313928772146</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">14.09317606630898</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-980.14153344888</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-548.4580073635929</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">592.4012338275047</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2361238716608</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-258.3988055868252</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2298.348396014856</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-325.1503575102672</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">153.8390924339484</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-90.2046337756875</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4142.8793862113125</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">10.50720794170734</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">2814.78225133626</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3520.125411988816</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1351.605895580406</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">731.4083582010072</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-216.60324087531103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">25.56203650166196</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2381.829935897496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">597.809129110048</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">291.8983352012704</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4165.4688847996085</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1229.337851789418</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="p">(</span><span class="mf">681.370187043564</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">66.7696405958478</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3443.057215135908</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1349.638121077468</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-713.258224830552</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="p">(</span><span class="mf">176.8161433232</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">31.68006188846728</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">    </span><span class="n">g_sa_t_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_sa_t_mod</span><span class="p">;</span>

<span class="w">    </span><span class="n">g_sa_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8645.36753595126</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.626801985426835</span><span class="w"> </span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-450.535298526802</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">182.8520895502518</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-43.3206481750622</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">4.26033941694366</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">)))));</span>

<span class="w">    </span><span class="n">g_sa_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_sa_mod</span><span class="p">;</span>

<span class="w">    </span><span class="o">*</span><span class="n">ct_sa_wrt_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">g_sa_mod</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_sa_t_mod</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ct_t_wrt_t</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">ct_t_wrt_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ct_p_wrt_t</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">ct_p_wrt_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">% gsw_ct_freezing                               Conservative Temperature at</span>
<span class="cm">%                                                    which seawater freezes</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_ct_freezing(SA,p,saturation_fraction)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Conservative Temperature at which seawater freezes.  The</span>
<span class="cm">%  Conservative Temperature freezing point is calculated from the exact</span>
<span class="cm">%  in-situ freezing temperature which is found by a modified Newton-Raphson</span>
<span class="cm">%  iteration (McDougall and Wotherspoon, 2014) of the equality of the</span>
<span class="cm">%  chemical potentials of water in seawater and in ice.</span>
<span class="cm">%</span>
<span class="cm">%  An alternative GSW function, gsw_CT_freezing_poly, it is based on a</span>
<span class="cm">%  computationally-efficient polynomial, and is accurate to within -5e-4 K</span>
<span class="cm">%  and 6e-4 K, when compared with this function.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OPTIONAL:</span>
<span class="cm">%  saturation_fraction = the saturation fraction of dissolved air in</span>
<span class="cm">%                        seawater</span>
<span class="cm">%  (i.e., saturation_fraction must be between 0 and 1, and the default</span>
<span class="cm">%    is 0, air free)</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  CT_freezing = Conservative Temperature at freezing of seawater [ deg C ]</span>
<span class="cm">%                That is, the freezing temperature expressed in terms of</span>
<span class="cm">%                Conservative Temperature (ITS-90).</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_ct_freezing</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">saturation_fraction</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">t_freezing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_freezing</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">saturation_fraction</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gsw_ct_from_t</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t_freezing</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>


<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_ct_from_enthalpy               Conservative Temperature from specific</span>
<span class="cm">%                                   enthalpy of seawater (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_ct_from_enthalpy(SA,h,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Conservative Temperature of seawater, given the Absolute</span>
<span class="cm">%  Salinity, specific enthalpy, h, and pressure p.  The specific enthalpy</span>
<span class="cm">%  input is the one calculated from the computationally-efficient</span>
<span class="cm">%  expression for specific volume in terms of SA, CT and p (Roquet et al.,</span>
<span class="cm">%  2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  h   =  specific enthalpy                                        [ J/kg ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  CT  =  Conservative Temperature ( ITS-90)                      [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_ct_from_enthalpy</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">ct_freezing</span><span class="p">,</span><span class="w"> </span><span class="n">ct_mean</span><span class="p">,</span><span class="w"> </span><span class="n">ct_old</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">h_freezing</span><span class="p">,</span>
<span class="w">    </span><span class="n">h_ct</span><span class="p">,</span><span class="w"> </span><span class="n">h_40</span><span class="p">,</span><span class="w"> </span><span class="n">ct_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">40.0</span><span class="p">;</span>

<span class="w">  </span><span class="n">ct_freezing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_ct_freezing</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">);</span>
<span class="w">  </span><span class="n">h_freezing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_freezing</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">h_freezing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">h_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_40</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">h_40</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_freezing</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ct_40</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_freezing</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h_freezing</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">h_40</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h_freezing</span><span class="p">);</span>

<span class="w">  </span><span class="n">gsw_enthalpy_first_derivatives</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">h_ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">ct_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">h_ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ct</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ct_old</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsw_enthalpy_first_derivatives</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_mean</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">h_ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">h_ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">h_ct</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">ct</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_ct_from_enthalpy_exact         Conservative Temperature from specific</span>
<span class="cm">%                                                      enthalpy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_ct_from_enthalpy_exact(SA,h,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Conservative Temperature of seawater, given the Absolute</span>
<span class="cm">%  Salinity, SA, specific enthalpy, h, and pressure p.  The specific</span>
<span class="cm">%  enthalpy input is calculated from the full Gibbs function of seawater,</span>
<span class="cm">%  gsw_enthalpy_t_exact.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_CT_from_enthalpy(SA,h,p), which uses the computationally</span>
<span class="cm">%  efficient 75-term expression for specific volume in terms of SA, CT</span>
<span class="cm">%  and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  h   =  specific enthalpy                                        [ J/kg ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  CT  =  Conservative Temperature ( ITS-90)                      [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T.J. and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_ct_from_enthalpy_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">ct_freezing</span><span class="p">,</span><span class="w"> </span><span class="n">ct_mean</span><span class="p">,</span><span class="w"> </span><span class="n">ct_old</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">h_freezing</span><span class="p">,</span>
<span class="w">    </span><span class="n">h_ct</span><span class="p">,</span><span class="w"> </span><span class="n">h_40</span><span class="p">,</span><span class="w"> </span><span class="n">ct_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">40.0</span><span class="p">;</span>

<span class="w">  </span><span class="n">ct_freezing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_freezing</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">);</span>
<span class="w">  </span><span class="n">h_freezing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy_ct_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_freezing</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">h_freezing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">h_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy_ct_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_40</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">h_40</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_freezing</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ct_40</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_freezing</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h_freezing</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">h_40</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h_freezing</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsw_enthalpy_first_derivatives_ct_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">h_ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">ct_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy_ct_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">h_ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ct</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ct_old</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsw_enthalpy_first_derivatives_ct_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_mean</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">h_ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">h_ct</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">ct</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_ct_from_t           Conservative Temperature from in-situ temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_ct_from_t(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Conservative Temperature of seawater from in-situ</span>
<span class="cm">%  temperature.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.3 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_ct_from_t</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt0_from_t</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gsw_ct_from_pt</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_ct_from_pt        Conservative Temperature from potential temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_ct_from_pt(SA,pt)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Conservative Temperature of seawater from potential</span>
<span class="cm">%  temperature (whose reference sea pressure is zero dbar).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  pt  =  potential temperature (ITS-90)                          [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.3 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_ct_from_pt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pot_enthalpy</span><span class="p">;</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025e0</span><span class="p">;</span>
<span class="w">  </span><span class="n">pot_enthalpy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_get_pot_ent</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">pot_enthalpy</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">% gsw_ct_maxdensity                     Conservative Temperature of maximum</span>
<span class="cm">%                                    density of seawater (75-term equation)</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_ct_maxdensity(SA,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Conservative Temperature of maximum density of seawater.</span>
<span class="cm">%  This function returns the Conservative temperature at which the density</span>
<span class="cm">%  of seawater is a maximum, at given Absolute Salinity, SA, and sea</span>
<span class="cm">%  pressure, p (in dbar).  This function uses the computationally-efficient</span>
<span class="cm">%  expression for specific volume in terms of SA, CT and p</span>
<span class="cm">%  (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA =  Absolute Salinity                                         [ g/kg ]</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%        ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  CT_maxdensity  =  Conservative Temperature at which            [ deg C ]</span>
<span class="cm">%                    the density of seawater is a maximum for</span>
<span class="cm">%                    given Absolute Salinity and pressure.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall &amp; Paul Barker                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.42 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_ct_maxdensity</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">number_of_iterations</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">ct_mean</span><span class="p">,</span><span class="w"> </span><span class="n">ct_old</span><span class="p">,</span><span class="w"> </span><span class="n">dalpha_dct</span><span class="p">,</span><span class="w"> </span><span class="n">dct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.001</span><span class="p">;</span>

<span class="w">  </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.978</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.22072</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">dalpha_dct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1e-5</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">number_of_iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">number_of_iterations</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">number_of_iterations</span><span class="o">++</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">ct_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">;</span>
<span class="w">    </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_alpha</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dalpha_dct</span><span class="p">;</span>
<span class="w">    </span><span class="n">ct_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ct</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ct_old</span><span class="p">);</span>
<span class="w">    </span><span class="n">dalpha_dct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_alpha</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_mean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">      </span><span class="n">gsw_alpha</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct_mean</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">dct</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dct</span><span class="p">);</span>
<span class="w">    </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dalpha_dct</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">ct</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_deltaSA_atlas                   Absolute Salinity Anomaly atlas value</span>
<span class="cm">%                                                (excluding the Baltic Sea)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_deltaSA_atlas(p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Absolute Salinity Anomaly atlas value, SA - SR, in</span>
<span class="cm">%  the open ocean by spatially interpolating the global reference data set</span>
<span class="cm">%  of deltaSA_atlas to the location of the seawater sample.</span>
<span class="cm">%</span>
<span class="cm">%  The Absolute Salinity Anomaly atlas value in the Baltic Sea is</span>
<span class="cm">%  evaluated separately, since it is a function of Practical Salinity, not</span>
<span class="cm">%  of space.  The present function returns a deltaSA_atlas of zero for</span>
<span class="cm">%  data in the Baltic Sea.  The correct way of calculating Absolute</span>
<span class="cm">%  Salinity in the Baltic Sea is by calling gsw_SA_from_SP.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%          ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon  =  Longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                      or [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  Latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  deltaSA_atlas   =  Absolute Salinity Anomaly atlas value        [ g/kg ]</span>
<span class="cm">%  in_ocean        =  0, if lon and lat are a long way from the ocean</span>
<span class="cm">%                  =  1, if lon and lat are in the ocean</span>
<span class="cm">%  Note. This flag is only set when the observation is well and truly on</span>
<span class="cm">%    dry land; often the warning flag is not set until one is several</span>
<span class="cm">%    hundred kilometres inland from the coast.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett                                       [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% MODIFIED:</span>
<span class="cm">%  Paul Barker and Trevor McDougall</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_deltasa_atlas</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_nx</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_ny</span><span class="p">,</span><span class="w"> </span><span class="n">nz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_nz</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">indx0</span><span class="p">,</span><span class="w"> </span><span class="n">indy0</span><span class="p">,</span><span class="w"> </span><span class="n">indz0</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">ndepth_index</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">dsar</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">dsar_old</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">dlong</span><span class="p">,</span><span class="w"> </span><span class="n">dlat</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">return_value</span><span class="p">,</span><span class="w"> </span><span class="n">sa_upper</span><span class="p">,</span><span class="w"> </span><span class="n">sa_lower</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r1</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">ndepth_max</span><span class="p">;</span>

<span class="w">  </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isnan</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isnan</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">return_value</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">-86.0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">90.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">return_value</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">lon</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">360.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">dlong</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">dlat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">longsrefzero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">nxminusone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">longsrefnxminusone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">nxminusone</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">lonminuslongsrefzero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">longsrefzero</span><span class="p">;</span>
<span class="w">  </span><span class="n">indx0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="n">nxminusone</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">lonminuslongsrefzero</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">longsrefnxminusone</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">longsrefzero</span><span class="p">)));</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">indx0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">latsrefzero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">nyminusone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">ny</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">latsrefnyminusone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">nyminusone</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">latminuslatsrefzero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">latsrefzero</span><span class="p">;</span>
<span class="w">  </span><span class="n">indy0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="n">nyminusone</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">latminuslatsrefzero</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">latsrefnyminusone</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">latsrefzero</span><span class="p">)));</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indy0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">indy0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">ndepth_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ndepth_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indy0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">delj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">deli</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ny</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_ndepth_ref</span><span class="p">(</span><span class="n">ndepth_index</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ndepth_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_max_d</span><span class="p">(</span><span class="n">ndepth_max</span><span class="p">,</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_ndepth_ref</span><span class="p">(</span><span class="n">ndepth_index</span><span class="p">));</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ndepth_max</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_ndepth_ref</span><span class="p">(</span><span class="n">ndepth_index</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ndepth_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_ndepth_ref</span><span class="p">(</span><span class="n">ndepth_index</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ndepth_max</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">-1.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">ndepth_max</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">ndepth_max</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">        </span><span class="cm">/*************************************************</span>
<span class="cm">           gsw_util_indxPref is relocated to TeosBase.cpp</span>
<span class="cm">           for a more clear continuity with gsw_util_indx</span>
<span class="cm">        *************************************************/</span>
<span class="w">  </span><span class="n">indz0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_indxPref</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lon</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="p">));</span>
<span class="w">  </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="p">));</span>
<span class="w">  </span><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">indz0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">indz0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">indz0</span><span class="p">));</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dsar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_delta_sa_ref</span><span class="p">(</span><span class="n">indz0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nz</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">indy0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">delj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">deli</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ny</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">memmove</span><span class="p">(</span><span class="n">dsar_old</span><span class="p">,</span><span class="w"> </span><span class="n">dsar</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="w">    </span><span class="n">gsw_add_barrier</span><span class="p">(</span><span class="n">dsar_old</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="p">),</span>
<span class="w">                                                         </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="p">),</span><span class="w"> </span><span class="n">dlong</span><span class="p">,</span>
<span class="w">      </span><span class="n">dlat</span><span class="p">,</span><span class="w"> </span><span class="n">dsar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">gsw_sum</span><span class="p">(</span><span class="n">dsar</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">dsar</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">)))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">memmove</span><span class="p">(</span><span class="n">dsar_old</span><span class="p">,</span><span class="w"> </span><span class="n">dsar</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="w">    </span><span class="n">gsw_add_mean</span><span class="p">(</span><span class="n">dsar_old</span><span class="p">,</span><span class="w"> </span><span class="n">dsar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">sa_upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dsar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dsar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dsar</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dsar</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dsar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dsar</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dsar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_delta_sa_ref</span><span class="p">(</span><span class="n">indz0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nz</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">indy0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">delj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">deli</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ny</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">memmove</span><span class="p">(</span><span class="n">dsar_old</span><span class="p">,</span><span class="w"> </span><span class="n">dsar</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="w">    </span><span class="n">gsw_add_barrier</span><span class="p">(</span><span class="n">dsar_old</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="p">),</span>
<span class="w">                                                         </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="p">),</span><span class="w"> </span><span class="n">dlong</span><span class="p">,</span>
<span class="w">      </span><span class="n">dlat</span><span class="p">,</span><span class="w"> </span><span class="n">dsar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">gsw_sum</span><span class="p">(</span><span class="n">dsar</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">dsar</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">)))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">memmove</span><span class="p">(</span><span class="n">dsar_old</span><span class="p">,</span><span class="w"> </span><span class="n">dsar</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="w">    </span><span class="n">gsw_add_mean</span><span class="p">(</span><span class="n">dsar_old</span><span class="p">,</span><span class="w"> </span><span class="n">dsar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">sa_lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dsar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dsar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dsar</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dsar</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">dsar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dsar</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_lower</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sa_lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa_upper</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa_upper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">sa_lower</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_upper</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">return_value</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">return_value</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_dilution_coefficient_t_exact         dilution coefficient of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_dilution_coefficient_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the dilution coefficient of seawater.  The dilution</span>
<span class="cm">%  coefficient of seawater is defined as the Absolute Salinity times the</span>
<span class="cm">%  second derivative of the Gibbs function with respect to Absolute</span>
<span class="cm">%  Salinity, that is, SA.*g_SA_SA.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA =  Absolute Salinity                                         [ g/kg ]</span>
<span class="cm">%  t  =  in-situ temperature (ITS-90)                             [ deg C ]</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%        ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  dilution_coefficient_t_exact  =  dilution coefficient   [ (J/kg)(kg/g) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall                                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_dilution_coefficient_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">g08</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>
<span class="w">  </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_g08_d</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g08</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_dynamic_enthalpy                         dynamic enthalpy of seawater</span>
<span class="cm">%                                                        (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_dynamic_enthalpy(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates dynamic enthalpy of seawater using the computationally-</span>
<span class="cm">%  efficient expression for specific volume in terms of SA, CT and p</span>
<span class="cm">%  (Roquet et al., 2015).  Dynamic enthalpy is defined as enthalpy minus</span>
<span class="cm">%  potential enthalpy (Young, 2010).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  dynamic_enthalpy  =  dynamic enthalpy                           [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.2 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T. J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%    See Eqns. (18) and (22)</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  Young, W.R., 2010: Dynamic enthalpy, Conservative Temperature, and the</span>
<span class="cm">%   seawater Boussinesq approximation. Journal of Physical Oceanography,</span>
<span class="cm">%   40, 394-400.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_dynamic_enthalpy</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">dynamic_enthalpy_part</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>

<span class="w">  </span><span class="n">dynamic_enthalpy_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_get_dyn_enth_prt</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">dynamic_enthalpy_part</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e4</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_enthalpy                                specific enthalpy of seawater</span>
<span class="cm">%                                                        (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_enthalpy(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific enthalpy of seawater using the computationally-</span>
<span class="cm">%  efficient expression for specific volume in terms of SA, CT and p</span>
<span class="cm">%  (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  enthalpy  =  specific enthalpy                                  [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall, David Jackett, Claire Roberts-Thomson and Paul Barker.</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (A.30.6) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%    See Eqns. (18) and (22)</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_enthalpy</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsw_dynamic_enthalpy</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_enthalpy_ct_exact                       specific enthalpy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_enthalpy_ct_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific enthalpy of seawater from Absolute Salinity and</span>
<span class="cm">%  Conservative Temperature and pressure.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely gsw_enthalpy(SA,CT,p),</span>
<span class="cm">%  which uses the computationally-efficient 75-term expression for specific</span>
<span class="cm">%  volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  enthalpy_ct_exact  =  specific enthalpy                         [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See apendix A.11 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T. J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%    See Eqns. (18) and (22)</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_enthalpy_ct_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gsw_enthalpy_t_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_enthalpy_first_derivatives              first derivatives of enthalpy</span>
<span class="cm">%                                                        (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_enthalpy_first_derivatives(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following two derivatives of specific enthalpy (h) of</span>
<span class="cm">%  seawater using the computationally-efficient expression for</span>
<span class="cm">%  specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%   (1) h_SA, the derivative with respect to Absolute Salinity at</span>
<span class="cm">%       constant CT and p, and</span>
<span class="cm">%   (2) h_CT, derivative with respect to CT at constant SA and p.</span>
<span class="cm">%  Note that h_P is specific volume (1/rho) it can be caclulated by calling</span>
<span class="cm">%  gsw_specvol(SA,CT,p).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  h_SA  =  The first derivative of specific enthalpy with respect to</span>
<span class="cm">%           Absolute Salinity at constant CT and p.</span>
<span class="cm">%                                            [ J/(kg (g/kg))]  i.e. [ J/g ]</span>
<span class="cm">%  h_CT  =  The first derivative of specific enthalpy with respect to</span>
<span class="cm">%           CT at constant SA and p.                           [ J/(kg K) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See Eqns. (A.11.18), (A.11.15) and (A.11.12) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%    See Eqns. (18) and (22)</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_enthalpy_first_derivatives</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_ct</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">dynamic_h_ct_part</span><span class="p">,</span><span class="w"> </span><span class="n">dynamic_h_sa_part</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h_sa</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dynamic_h_sa_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h101</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h301</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h401</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h501</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">6.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h601</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h111</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h311</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h411</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h511</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h221</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h321</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h421</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h231</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h331</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h141</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h241</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h151</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h202</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h302</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h402</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h502</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h112</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h212</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h312</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h412</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h122</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h222</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h322</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h132</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h232</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h142</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h103</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h203</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h303</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h403</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h113</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h213</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h313</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h123</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h223</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h133</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h104</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h204</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h114</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h105</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">    </span><span class="o">*</span><span class="n">h_sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dynamic_h_sa_part</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">xs</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h_ct</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">dynamic_h_ct_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h011</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h111</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h311</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h411</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h511</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h021</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h121</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h221</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h321</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h421</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h031</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h231</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h331</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h041</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h141</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h241</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h051</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h151</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">6.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h061</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h012</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h212</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h312</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h412</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h122</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h222</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h322</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h032</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h132</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h232</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h042</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h142</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h052</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h013</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h113</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h213</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h313</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h023</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h123</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h223</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h033</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h133</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h043</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h014</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h114</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h015</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">    </span><span class="o">*</span><span class="n">h_ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1e8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dynamic_h_ct_part</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_enthalpy_first_derivatives_ct_exact     first derivatives of enthalpy</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_enthalpy_first_derivatives_ct_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following two derivatives of specific enthalpy, h,</span>
<span class="cm">%   (1) h_SA, the derivative with respect to Absolute Salinity at</span>
<span class="cm">%       constant CT and p, and</span>
<span class="cm">%   (2) h_CT, derivative with respect to CT at constant SA and p.</span>
<span class="cm">%  Note that h_P is specific volume, v, it can be calulated by calling</span>
<span class="cm">%  gsw_specvol_CT_exact(SA,CT,p).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_enthalpy_first_derivatives(SA,CT,p) which uses the computationally</span>
<span class="cm">%  efficient 75-term expression for specific volume in terms of SA, CT and</span>
<span class="cm">%  p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  h_SA  =  The first derivative of specific enthalpy with respect to</span>
<span class="cm">%           Absolute Salinity at constant CT and p.</span>
<span class="cm">%                                            [ J/(kg (g/kg))]  i.e. [ J/g ]</span>
<span class="cm">%  h_CT  =  The first derivative of specific enthalpy with respect to</span>
<span class="cm">%           CT at constant SA and p.                           [ J/(kg K) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall.                                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See Eqns. (A.11.18), (A.11.15) and (A.11.12) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%    See Eqns. (18) and (22)</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_enthalpy_first_derivatives_ct_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_sa</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">h_ct</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g_sa_mod_pt</span><span class="p">,</span><span class="w"> </span><span class="n">g_sa_mod_t</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">temp_ratio</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y_pt</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">temp_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h_ct</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">h_ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">temp_ratio</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">h_sa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">  </span><span class="n">g_sa_mod_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8645.36753595126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-6620.98308089678</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">769.588305957198</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-193.0648640214916</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">31.6816345533648</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">5.24960313181984</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">180.142097805543</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-219.1676534131548</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-16.32775915649044</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">120.7020447884644</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">598.378809221703</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-156.8822727844005</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">204.1334828179377</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10.23755797323846</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1149.174198007428</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-162.5751787551336</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">76.9195462169742</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1380.9597954037708</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.626801985426835</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">703.695562834065</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1458.233059470092</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">249.375342232496</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-63.313928772146</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">14.09317606630898</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-450.535298526802</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">182.8520895502518</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-43.3206481750622</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">4.26033941694366</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-595.457483974374</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">149.452282277512</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">72.9745838003176</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1388.489628266536</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-409.779283929806</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">227.123395681188</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.2565468652826</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1721.528607567954</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">674.819060538734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-356.629112415276</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">88.4080716616</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.84003094423364</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">g_sa_mod_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_sa_mod_t</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pt0</span><span class="p">;</span>
<span class="w">  </span><span class="n">g_sa_mod_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8645.36753595126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.626801985426835</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-450.535298526802</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">182.8520895502518</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-43.3206481750622</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.26033941694366</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">g_sa_mod_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_sa_mod_pt</span><span class="p">;</span>

<span class="w">  </span><span class="o">*</span><span class="n">h_sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_sa_mod_t</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">temp_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_sa_mod_pt</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_enthalpy_second_derivatives_ct_exact   second derivatives of enthalpy</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_enthalpy_second_derivatives_ct_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following three second-order derivatives of specific</span>
<span class="cm">%  enthalpy (h),</span>
<span class="cm">%   (1) h_SA_SA, second-order derivative with respect to Absolute Salinity</span>
<span class="cm">%       at constant CT &amp; p.</span>
<span class="cm">%   (2) h_SA_CT, second-order derivative with respect to SA &amp; CT at</span>
<span class="cm">%       constant p.</span>
<span class="cm">%   (3) h_CT_CT, second-order derivative with respect to CT at constant SA</span>
<span class="cm">%       and p.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_enthalpy_second_derivatives(SA,CT,p) which uses the computationally</span>
<span class="cm">%  efficient 75-term expression for specific volume in terms of SA, CT and</span>
<span class="cm">%  p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  h_SA_SA  =  The second derivative of specific enthalpy with respect to</span>
<span class="cm">%              Absolute Salinity at constant CT &amp; p.    [ J/(kg (g/kg)^2) ]</span>
<span class="cm">%  h_SA_CT  =  The second derivative of specific enthalpy with respect to</span>
<span class="cm">%              SA and CT at constant p.                  [ J/(kg K(g/kg)) ]</span>
<span class="cm">%  h_CT_CT  =  The second derivative of specific enthalpy with respect to</span>
<span class="cm">%              CT at constant SA and p.                      [ J/(kg K^2) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T. J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%    See Eqns. (18) and (22)</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_enthalpy_second_derivatives_ct_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">h_sa_sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">h_sa_ct</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">h_ct_ct</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">factor</span><span class="p">,</span><span class="w"> </span><span class="n">gsa_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">gsat_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">gsat</span><span class="p">,</span><span class="w"> </span><span class="n">part_b</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">h_ct_ct_val</span><span class="p">,</span>
<span class="w">    </span><span class="n">rec_abs_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">rec_gtt_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">rec_gtt</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">temp_ratio</span><span class="p">,</span>
<span class="w">    </span><span class="n">gsasa</span><span class="p">,</span><span class="w"> </span><span class="n">gsasa_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">sa_small</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-100</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">);</span>
<span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_t</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">temp_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="p">;</span>
<span class="w">  </span><span class="n">rec_gtt_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">  </span><span class="n">rec_gtt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">h_ct_ct_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">temp_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gtt_pt0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rec_gtt</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="p">);</span>

<span class="w">  </span><span class="n">h_ct_ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h_ct_ct_val</span><span class="p">;</span>

<span class="w">  </span><span class="n">gsat_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsa_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">  </span><span class="n">part_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">temp_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsat_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gtt_pt0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gtt</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="p">;</span>
<span class="w">  </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsa_pt0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span>

<span class="w">  </span><span class="n">gsasa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsasa_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">  </span><span class="n">h_sa_sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsasa</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">temp_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsasa_pt0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">temp_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsat_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsat_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gtt_pt0</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">gsat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gtt</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsa_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part_b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">factor</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">factor</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">h_ct_ct_val</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sa</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sa_small</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">rec_gtt_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa_small</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">    </span><span class="n">rec_gtt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa_small</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="n">gsat_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa_small</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">    </span><span class="n">gsat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa_small</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="n">gsa_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa_small</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">    </span><span class="n">part_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">temp_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsat_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gtt_pt0</span><span class="w"> </span><span class="o">-</span>
<span class="w">      </span><span class="n">gsat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gtt</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="p">;</span>
<span class="w">    </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsa_pt0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">h_sa_ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part_b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">h_ct_ct_val</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_enthalpy_SSO_0                               enthalpy at (SSO,CT=0,p)</span>
<span class="cm">%                                                            (75-term eqn.)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%  This function calculates enthalpy at the Standard Ocean Salinity, SSO,</span>
<span class="cm">%  and at a Conservative Temperature of zero degrees C, as a function of</span>
<span class="cm">%  pressure, p, in dbar, using a streamlined version of the 75-term</span>
<span class="cm">%  computationally-efficient expression for specific volume, that is, a</span>
<span class="cm">%  streamlined version of the code &quot;gsw_enthalpy(SA,CT,p)&quot;.</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_enthalpy_sso_0</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">dynamic_enthalpy_sso_0_p</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0e-4</span><span class="p">;</span>
<span class="w">  </span><span class="n">dynamic_enthalpy_sso_0_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">9.726613854843870e-4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2.252956605630465e-5</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mf">2.376909655387404e-6</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1.664294869986011e-7</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5.988108894465758e-9</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h006</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h007</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))));</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">dynamic_enthalpy_sso_0_p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0e4</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_enthalpy_t_exact                        specific enthalpy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_enthalpy_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the specific enthalpy of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA =  Absolute Salinity                                         [ g/kg ]</span>
<span class="cm">%  t  =  in-situ temperature (ITS-90)                             [ deg C ]</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%        ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  enthalpy_t_exact  =  specific enthalpy                          [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_enthalpy_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">         </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_entropy_first_derivatives                first derivatives of entropy</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_eta_first_derivatives(SA,CT)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following two partial derivatives of specific entropy</span>
<span class="cm">%  (eta)</span>
<span class="cm">%   (1) eta_SA, the derivative with respect to Absolute Salinity at</span>
<span class="cm">%       constant Conservative Temperature, and</span>
<span class="cm">%   (2) eta_CT, the derivative with respect to Conservative Temperature at</span>
<span class="cm">%       constant Absolute Salinity.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  eta_SA =  The derivative of specific entropy with respect to</span>
<span class="cm">%            Absolute Salinity (in units of g kg^-1) at constant</span>
<span class="cm">%            Conservative Temperature.</span>
<span class="cm">%            eta_SA has units of:         [ J/(kg K(g/kg))]  or [ J/(g K) ]</span>
<span class="cm">%  eta_CT =  The derivative of specific entropy with respect to</span>
<span class="cm">%            Conservative Temperature at constant Absolute Salinity.</span>
<span class="cm">%            eta_CT has units of:                            [ J/(kg K^2) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall.                                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See Eqns. (A.12.8) and (P.14a,c) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_entropy_first_derivatives</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">eta_sa</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">eta_ct</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eta_sa</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">eta_sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eta_ct</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">eta_ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_entropy_from_ct                          specific entropy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_entropy_from_ct(SA,CT)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific entropy of seawater from Conservative Temperature.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                     [ g kg^-1 ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  entropy  =  specific entropy                                [ J/(kg*K) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix A.10 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_entropy_from_ct</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="o">-</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_entropy_part   entropy minus the terms that are a function of only SA</span>
<span class="cm">%==========================================================================</span>
<span class="cm">% This function calculates entropy, except that it does not evaluate any</span>
<span class="cm">% terms that are functions of Absolute Salinity alone.  By not calculating</span>
<span class="cm">% these terms, which are a function only of Absolute Salinity, several</span>
<span class="cm">% unnecessary computations are avoided (including saving the computation</span>
<span class="cm">% of a natural logarithm).  These terms are a necessary part of entropy,</span>
<span class="cm">% but are not needed when calculating potential temperature from in-situ</span>
<span class="cm">% temperature.</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_entropy_part</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_get_g03plusg08</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_entropy_part_zerop          entropy_part evaluated at the sea surface</span>
<span class="cm">%==========================================================================</span>
<span class="cm">% This function calculates entropy at a sea pressure of zero, except that</span>
<span class="cm">% it does not evaluate any terms that are functions of Absolute Salinity</span>
<span class="cm">% alone.  By not calculating these terms, which are a function only of</span>
<span class="cm">% Absolute Salinity, several unnecessary computations are avoided</span>
<span class="cm">% (including saving the computation of a natural logarithm). These terms</span>
<span class="cm">% are a necessary part of entropy, but are not needed when calculating</span>
<span class="cm">% potential temperature from in-situ temperature.</span>
<span class="cm">% The inputs to &quot;gsw_entropy_part_zerop(SA,pt0)&quot; are Absolute Salinity</span>
<span class="cm">% and potential temperature with reference sea pressure of zero dbar.</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_entropy_part_zerop</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">g03</span><span class="p">,</span><span class="w"> </span><span class="n">g08</span><span class="p">;</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>

<span class="w">  </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-24715.571866078</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2210.2236124548363</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-592.743745734632</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">290.12956292128547</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-113.90630790850321</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">21.35571525415769</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-137.1145018408982</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">148.10030845687618</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">12.4848504784754</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-86.1329351956084</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">3.50240264723578</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-675.802947790203</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">365.7041791005036</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.30162043765552</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">12.78101825083098</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))));</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="o">-</span><span class="p">(</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_entropy_second_derivatives              second derivatives of entropy</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_entropy_second_derivatives(SA,CT)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following three second-order partial derivatives of</span>
<span class="cm">%  specific entropy (eta)</span>
<span class="cm">%   (1) eta_SA_SA, the second derivative with respect to Absolute</span>
<span class="cm">%       Salinity at constant Conservative Temperature, and</span>
<span class="cm">%   (2) eta_SA_CT, the derivative with respect to Absolute Salinity and</span>
<span class="cm">%       Conservative Temperature.</span>
<span class="cm">%   (3) eta_CT_CT, the second derivative with respect to Conservative</span>
<span class="cm">%       Temperature at constant Absolute Salinity.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  eta_SA_SA =  The second derivative of specific entropy with respect</span>
<span class="cm">%               to Absolute Salinity (in units of g kg^-1) at constant</span>
<span class="cm">%               Conservative Temperature.</span>
<span class="cm">%               eta_SA_SA has units of:                 [ J/(kg K(g/kg)^2)]</span>
<span class="cm">%  eta_SA_CT =  The second derivative of specific entropy with respect</span>
<span class="cm">%               to Conservative Temperature at constant Absolute</span>
<span class="cm">%               Salinity. eta_SA_CT has units of:     [ J/(kg (g/kg) K^2) ]</span>
<span class="cm">%  eta_CT_CT =  The second derivative of specific entropy with respect</span>
<span class="cm">%               to Conservative Temperature at constant Absolute</span>
<span class="cm">%               Salinity.  eta_CT_CT has units of:           [ J/(kg K^3) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See Eqns. (P.14b) and (P.15a,b) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_entropy_second_derivatives</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">eta_sa_sa</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">eta_sa_ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">eta_ct_ct</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">abs_pt</span><span class="p">,</span><span class="w"> </span><span class="n">ct_pt</span><span class="p">,</span><span class="w"> </span><span class="n">ct_sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">ct_ct</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">abs_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">abs_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">ct_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">abs_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">abs_pt</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">eta_sa_ct</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">eta_sa_sa</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ct_sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">      </span><span class="p">(</span><span class="n">abs_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">)))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eta_sa_ct</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="o">*</span><span class="n">eta_sa_ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">ct_sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_ct</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eta_sa_sa</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="o">*</span><span class="n">eta_sa_sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">abs_pt</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">ct_sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_ct</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eta_ct_ct</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">eta_ct_ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_ct</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Fdelta                                                         Fdelta</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_Fdelta(p,long,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Fdelta from the Absolute Salinity Anomaly Ratio (SAAR).  It</span>
<span class="cm">%  finds SAAR by calling the function &quot;gsw_SAAR(p,long,lat)&quot; and then</span>
<span class="cm">%  simply calculates Fdelta from</span>
<span class="cm">%</span>
<span class="cm">%     Fdelta = (1 + r1)SAAR/(1 - r1*SAAR)</span>
<span class="cm">%            = (SA/Sstar) - 1</span>
<span class="cm">%</span>
<span class="cm">%  with r1 being the constant 0.35 based on the work of Pawlowicz et al.</span>
<span class="cm">%  (2011). Note that since SAAR is everywhere less than 0.001 in the global</span>
<span class="cm">%  ocean, Fdelta is only slighty different to 1.35*SAAR.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  p    =  sea pressure                                            [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  long =  longitude in decimal degrees                      [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat  =  latitude in decimal degrees north                [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Fdelta  =  ratio of SA to Sstar, minus 1                    [ unitless ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall &amp; Paul Barker                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.5 and appendices A.4 and A.5 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">% Pawlawicz, R., D.G. Wright and F.J. Millero, 2011; The effects of</span>
<span class="cm">%   biogeochemical processes on oceanic conductivity/salinty/density</span>
<span class="cm">%   relationships and the characterization of real seawater. Ocean Science,</span>
<span class="cm">%   7, 363-387.  http://www.ocean-sci.net/7/363/2011/os-7-363-2011.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_fdelta</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_saar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.35</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">saar</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.35</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">sa</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_gibbs_ice                     Gibbs energy of ice and its derivatives</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_gibbs_ice(nt,np,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Ice specific Gibbs energy and derivatives up to order 2.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  nt  =  order of t derivative                      [ integers 0, 1 or 2 ]</span>
<span class="cm">%  np  =  order of p derivative                      [ integers 0, 1 or 2 ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  gibbs_ice = Specific Gibbs energy of ice or its derivatives.</span>
<span class="cm">%            The Gibbs energy (when nt = np = 0) has units of:     [ J/kg ]</span>
<span class="cm">%            The temperature derivatives are output in units of:</span>
<span class="cm">%                                                      [ (J/kg) (K)^(-nt) ]</span>
<span class="cm">%            The pressure derivatives are output in units of:</span>
<span class="cm">%                                                     [ (J/kg) (Pa)^(-np) ]</span>
<span class="cm">%            The mixed derivatives are output in units of:</span>
<span class="cm">%                                           [ (J/kg) (K)^(-nt) (Pa)^(-np) ]</span>
<span class="cm">%  Note. The derivatives are taken with respect to pressure in Pa, not</span>
<span class="cm">%    withstanding that the pressure input into this routine is in dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IAPWS, 2009: Revised release on the Equation of State 2006 for H2O Ice</span>
<span class="cm">%   Ih. The International Association for the Properties of Water and</span>
<span class="cm">%   Steam. Doorwerth, The Netherlands, September 2009.</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See appendix I.</span>
<span class="cm">%</span>
<span class="cm">%  Reference page in Help browser</span>
<span class="cm">%       &lt;a href=&quot;matlab:doc gsw_gibbs_ice&quot;&gt;doc gsw_gibbs_ice&lt;/a&gt;</span>
<span class="cm">%  Note that this reference page includes the code contained in</span>
<span class="cm">%  gsw_gibbs_ice.  We have opted to encode this programme as it is a global</span>
<span class="cm">%  standard and such we cannot allow anyone to change it.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_ice</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">nt</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">np</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">dzi</span><span class="p">,</span><span class="w"> </span><span class="n">g0</span><span class="p">,</span><span class="w"> </span><span class="n">g0p</span><span class="p">,</span><span class="w"> </span><span class="n">g0pp</span><span class="p">,</span><span class="w"> </span><span class="n">sqrec_pt</span><span class="p">;</span>
<span class="w">  </span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">r2</span><span class="p">,</span><span class="w"> </span><span class="n">r2p</span><span class="p">,</span><span class="w"> </span><span class="n">r2pp</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">sqtau_t1</span><span class="p">,</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">,</span><span class="w"> </span><span class="n">tau</span><span class="p">,</span><span class="w"> </span><span class="n">tau_t1</span><span class="p">,</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">s0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.32733756492168e3</span><span class="p">;</span>

<span class="w">  </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_tt</span><span class="p">;</span>
<span class="w">  </span><span class="n">dzi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_pt</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tau_t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t1</span><span class="p">;</span>
<span class="w">    </span><span class="n">sqtau_t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau_t1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau_t1</span><span class="p">;</span>
<span class="w">    </span><span class="n">tau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t2</span><span class="p">;</span>
<span class="w">    </span><span class="n">sqtau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau_t2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">;</span>
<span class="w">    </span><span class="n">g0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">g00</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gic</span><span class="p">.</span><span class="n">g01</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gic</span><span class="p">.</span><span class="n">g02</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gic</span><span class="p">.</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">g04</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dzi</span><span class="p">)));</span>
<span class="w">    </span><span class="n">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r20</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r21</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dzi</span><span class="p">);</span>

<span class="w">    </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">tau</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau_t1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau_t1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">t1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">r2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">tau</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">t2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">));</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">g0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">tt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">s0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">g</span><span class="p">)));</span><span class="w">          </span><span class="c1">// EF: bug in original.</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tau_t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t1</span><span class="p">;</span>
<span class="w">    </span><span class="n">tau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t2</span><span class="p">;</span>
<span class="w">    </span><span class="n">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r20</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r21</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dzi</span><span class="p">);</span>
<span class="w">    </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">((</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau_t1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau_t1</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau_t1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">r2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">((</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="o">-</span><span class="n">s0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t2</span><span class="p">;</span>
<span class="w">    </span><span class="n">sqtau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau_t2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">;</span>
<span class="w">    </span><span class="n">g0p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_pt</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="p">(</span><span class="n">gic</span><span class="p">.</span><span class="n">g01</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">g02</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">g04</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dzi</span><span class="p">)));</span>
<span class="w">    </span><span class="n">r2p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r21</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dzi</span><span class="p">);</span>
<span class="w">    </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">tau</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">t2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">));</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">g0p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">tt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t2</span><span class="p">;</span>
<span class="w">    </span><span class="n">r2p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r21</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dzi</span><span class="p">);</span>
<span class="w">    </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">((</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">real</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r20</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r21</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dzi</span><span class="p">);</span>
<span class="w">    </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">r2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t2</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_tt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sqrec_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_pt</span><span class="p">;</span>
<span class="w">    </span><span class="n">tau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t2</span><span class="p">;</span>
<span class="w">    </span><span class="n">sqtau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tau_t2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">;</span>
<span class="w">    </span><span class="n">g0pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrec_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">g02</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dzi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">6.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">12.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">g04</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dzi</span><span class="p">));</span>
<span class="w">    </span><span class="n">r2pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sqrec_pt</span><span class="p">;</span>
<span class="w">    </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2pp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">tau</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tau_t2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">t2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">));</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">g0pp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">tt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_gibbs                                Gibbs energy and its derivatives</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%   gsw_gibbs(ns,nt,np,SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific Gibbs energy and its derivatives up to order 3 for</span>
<span class="cm">%  seawater.  The Gibbs function for seawater is that of TEOS-10</span>
<span class="cm">%  (IOC et al., 2010), being the sum of IAPWS-08 for the saline part and</span>
<span class="cm">%  IAPWS-09 for the pure water part.  These IAPWS releases are the</span>
<span class="cm">%  officially blessed IAPWS descriptions of Feistel (2008) and the pure</span>
<span class="cm">%  water part of Feistel (2003).  Absolute Salinity, SA, in all of the GSW</span>
<span class="cm">%  routines is expressed on the Reference-Composition Salinity Scale of</span>
<span class="cm">%  2008 (RCSS-08) of Millero et al. (2008).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  ns  =  order of SA derivative                     [ integers 0, 1 or 2 ]</span>
<span class="cm">%  nt  =  order of t derivative                      [ integers 0, 1 or 2 ]</span>
<span class="cm">%  np  =  order of p derivative                      [ integers 0, 1 or 2 ]</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         (ie. absolute pressure - 10.1325 dbar)</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  gibbs  =  Specific Gibbs energy or its derivatives.</span>
<span class="cm">%</span>
<span class="cm">%            The Gibbs energy (when ns = nt = np = 0) has units of:</span>
<span class="cm">%                                                                  [ J/kg ]</span>
<span class="cm">%            The Absolute Salinity derivatives are output in units of:</span>
<span class="cm">%                                                   [ (J/kg) (g/kg)^(-ns) ]</span>
<span class="cm">%            The temperature derivatives are output in units of:</span>
<span class="cm">%                                                      [ (J/kg) (K)^(-nt) ]</span>
<span class="cm">%            The pressure derivatives are output in units of:</span>
<span class="cm">%                                                     [ (J/kg) (Pa)^(-np) ]</span>
<span class="cm">%            The mixed derivatives are output in units of:</span>
<span class="cm">%                              [ (J/kg) (g/kg)^(-ns) (K)^(-nt) (Pa)^(-np) ]</span>
<span class="cm">%  Note. The derivatives are taken with respect to pressure in Pa, not</span>
<span class="cm">%    withstanding that the pressure input into this routine is in dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Paul Barker and Trevor McDougall     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Feistel, R., 2003: A new extended Gibbs thermodynamic potential of</span>
<span class="cm">%   seawater,  Progr. Oceanogr., 58, 43-114.</span>
<span class="cm">%</span>
<span class="cm">%  Feistel, R., 2008: A Gibbs function for seawater thermodynamics</span>
<span class="cm">%   for -6 to 80°C and salinity up to 120 g kg1, Deep-Sea Res. I,</span>
<span class="cm">%   55, 1639-1671.</span>
<span class="cm">%</span>
<span class="cm">%  IAPWS, 2008: Release on the IAPWS Formulation 2008 for the</span>
<span class="cm">%   Thermodynamic Properties of Seawater. The International Association</span>
<span class="cm">%   for the Properties of Water and Steam. Berlin, Germany, September</span>
<span class="cm">%   2008, available from http://www.iapws.org.  This Release is referred</span>
<span class="cm">%   to as IAPWS-08.</span>
<span class="cm">%</span>
<span class="cm">%  IAPWS, 2009: Supplementary Release on a Computationally Efficient</span>
<span class="cm">%   Thermodynamic Formulation for Liquid Water for Oceanographic Use.</span>
<span class="cm">%   The International Association for the Properties of Water and Steam.</span>
<span class="cm">%   Doorwerth, The Netherlands, September 2009, available from</span>
<span class="cm">%   http://www.iapws.org.  This Release is referred to as IAPWS-09.</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.6 and appendices A.6,  G and H of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Millero, F.J., R. Feistel, D.G. Wright, and T.J. McDougall, 2008:</span>
<span class="cm">%   The composition of Standard Seawater and the definition of the</span>
<span class="cm">%   Reference-Composition Salinity Scale, Deep-Sea Res. I, 55, 50-72.</span>
<span class="cm">%</span>
<span class="cm">%  Reference page in Help browser</span>
<span class="cm">%       &lt;a href=&quot;matlab:doc gsw_gibbs&quot;&gt;doc gsw_gibbs&lt;/a&gt;</span>
<span class="cm">%  Note that this reference page includes the code contained in gsw_gibbs.</span>
<span class="cm">%  We have opted to encode this programme as it is a global standard and</span>
<span class="cm">%  such we cannot allow anyone to change it.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">ns</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nt</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">np</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g03plusg08_a</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g08_a</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g03plusg08_b</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g03plusg08_c</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g03plusg08_d</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g08_b</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g03plusg08_e</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g08_c</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g03plusg08_f</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ns</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs_g03plusg08_g</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">return_value</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_gibbs_pt0_pt0                                   gibbs_tt at (SA,pt,0)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">% This function calculates the second derivative of the specific Gibbs</span>
<span class="cm">% function with respect to temperature at zero sea pressure.  The inputs</span>
<span class="cm">% are Absolute Salinity and potential temperature with reference sea</span>
<span class="cm">% pressure of zero dbar.  This library function is called by both</span>
<span class="cm">% &quot;gsw_pt_from_CT(SA,CT)&quot; ,&quot;gsw_pt0_from_t(SA,t,p)&quot; and</span>
<span class="cm">% &quot;gsw_pt_from_entropy(SA,entropy)&quot;.</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_pt0_pt0</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">g03</span><span class="p">,</span><span class="w"> </span><span class="n">g08</span><span class="p">;</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>

<span class="w">  </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-24715.571866078</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4420.4472249096725</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1778.231237203896</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1160.5182516851419</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-569.531539542516</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">128.13429152494615</span><span class="p">))));</span>

<span class="w">  </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-86.1329351956084</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-137.1145018408982</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">296.20061691375236</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-205.67709290374563</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-60.136422517125</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">10.50720794170734</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1351.605895580406</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1097.1125373015109</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-433.20648175062206</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">63.905091254154904</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))));</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="p">(</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.000625</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_grav                                       gravitational acceleration</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_grav(lat,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates acceleration due to gravity as a function of latitude and as</span>
<span class="cm">%  a function of pressure in the ocean.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  lat  =  latitude in decimal degress north                [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% Optional:</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%        ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  (If pressure is not given then it is assumed that pressure = 0 dbar.)</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  grav  =  gravitational acceleration                           [ m s^-2 ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall &amp; Paul Barker                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix D of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Moritz, H., 2000: Geodetic reference system 1980. J. Geodesy, 74,</span>
<span class="cm">%   pp. 128-133.</span>
<span class="cm">%</span>
<span class="cm">%  Saunders, P.M., and N.P. Fofonoff, 1976: Conversion of pressure to</span>
<span class="cm">%   depth in the ocean. Deep-Sea Res., pp. 109-111.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_grav</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sin2</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">deg2rad</span><span class="p">);</span>
<span class="w">  </span><span class="n">sin2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="n">gs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9.780327</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">5.2792e-3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">2.32e-5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin2</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin2</span><span class="p">);</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_z_from_p</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Hill_ratio_at_SP2                               Hill ratio at SP of 2</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_Hill_ratio_at_SP2(t)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Hill ratio, which is the adjustment needed to apply for</span>
<span class="cm">%  Practical Salinities smaller than 2.  This ratio is defined at a</span>
<span class="cm">%  Practical Salinity = 2 and in-situ temperature, t using PSS-78. The Hill</span>
<span class="cm">%  ratio is the ratio of 2 to the output of the Hill et al. (1986) formula</span>
<span class="cm">%  for Practical Salinity at the conductivity ratio, Rt, at which Practical</span>
<span class="cm">%  Salinity on the PSS-78 scale is exactly 2.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  t  =  in-situ temperature (ITS-90)                             [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Hill_ratio  =  Hill ratio at SP of 2                        [ unitless ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Hill, K.D., T.M. Dauphinee &amp; D.J. Woods, 1986: The extension of the</span>
<span class="cm">%   Practical Salinity Scale 1978 to low salinities. IEEE J. Oceanic Eng.,</span>
<span class="cm">%   11, 109 - 112.</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix E of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T.J. and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  Unesco, 1983: Algorithms for computation of fundamental properties of</span>
<span class="cm">%   seawater. Unesco Technical Papers in Marine Science, 44, 53 pp.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_hill_ratio_at_sp2</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">g0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.641463563366498e-1</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.007883247811176e-4</span><span class="p">,</span>
<span class="w">    </span><span class="n">g2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.107694432853053e-6</span><span class="p">,</span><span class="w"> </span><span class="n">g3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.401670882091225e-8</span><span class="p">,</span>
<span class="w">    </span><span class="n">g4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.711392021989210e-9</span><span class="p">,</span><span class="w"> </span><span class="n">g5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.374193893377380e-11</span><span class="p">,</span>
<span class="w">    </span><span class="n">g6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.923731174730784e-13</span><span class="p">,</span><span class="w"> </span><span class="n">g7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.057771569962299e-15</span><span class="p">,</span>
<span class="w">    </span><span class="n">g8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.054313817447962e-17</span><span class="p">,</span><span class="w"> </span><span class="n">g9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.859992717347235e-19</span><span class="p">,</span>
<span class="w">    </span><span class="n">sp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t68</span><span class="p">,</span><span class="w"> </span><span class="n">ft68</span><span class="p">,</span><span class="w"> </span><span class="n">rtx0</span><span class="p">,</span><span class="w"> </span><span class="n">dsp_drtx</span><span class="p">,</span><span class="w"> </span><span class="n">sp_est</span><span class="p">,</span><span class="w"> </span><span class="n">rtx</span><span class="p">,</span><span class="w"> </span><span class="n">rtxm</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">part1</span><span class="p">,</span><span class="w"> </span><span class="n">part2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sqrty</span><span class="p">,</span><span class="w"> </span><span class="n">sp_hill_raw_at_sp2</span><span class="p">;</span>

<span class="w">  </span><span class="n">t68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>
<span class="w">  </span><span class="n">ft68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.0</span><span class="p">));</span>
<span class="w">  </span><span class="n">rtx0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g5</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g9</span><span class="p">))))))));</span>

<span class="w">  </span><span class="n">dsp_drtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">);</span>
<span class="w">  </span><span class="n">sp_est</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx0</span><span class="p">);</span>

<span class="w">  </span><span class="n">rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtx0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">sp_est</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sp2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dsp_drtx</span><span class="p">;</span>
<span class="w">  </span><span class="n">rtxm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">rtx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rtx0</span><span class="p">);</span>
<span class="w">  </span><span class="n">dsp_drtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtxm</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtxm</span><span class="p">);</span>

<span class="w">  </span><span class="n">rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtx0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">sp_est</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sp2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dsp_drtx</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">400.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">;</span>
<span class="w">  </span><span class="n">sqrty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">;</span>
<span class="w">  </span><span class="n">part1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="n">part2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="p">));</span>
<span class="w">  </span><span class="n">sp_hill_raw_at_sp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ft68</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part2</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="mf">2.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sp_hill_raw_at_sp2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_internal_energy                   specific interal energy of seawater</span>
<span class="cm">%                                                        (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_internal_energy(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific internal energy of seawater using the</span>
<span class="cm">%  computationally-efficient expression for specific volume in terms of SA,</span>
<span class="cm">%  CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature                                [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  internal_energy  =  specific internal energy                    [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_internal_energy</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gsw_enthalpy</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_p0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="n">gsw_specvol</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_kappa                   isentropic compressibility (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_kappa(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the isentropic compressibility of seawater.  This function</span>
<span class="cm">%  has inputs of Absolute Salinity and Conservative Temperature.  This</span>
<span class="cm">%  function uses the computationally-efficient expression for</span>
<span class="cm">%  specific volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  kappa  =  isentropic compressibility of seawater                [ 1/Pa ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.17.1) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_kappa</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">v_p</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>
<span class="w">  </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gsvco_v</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>
<span class="w">  </span><span class="n">v_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gsvco_c</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="mf">-1e-8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v_p</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">% gsw_kappa_t_exact                              isentropic compressibility</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_kappa_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the isentropic compressibility of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  kappa_t_exact  =  isentropic compressibility                    [ 1/Pa ]</span>
<span class="cm">%   Note. The output units are 1/Pa not 1/dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqns. (2.16.1) and the row for kappa in Table P.1 of appendix P</span>
<span class="cm">%    of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_kappa_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g_tt</span><span class="p">,</span><span class="w"> </span><span class="n">g_tp</span><span class="p">;</span>

<span class="w">  </span><span class="n">g_tt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">g_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="p">(</span><span class="n">g_tp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_tp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">g_tt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">         </span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_tt</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_linear_interp_SA_ct             linear interpolation to p_i on a cast</span>
<span class="cm">%==========================================================================</span>
<span class="cm">% This function interpolates the cast with respect to the interpolating</span>
<span class="cm">% variable p. This function finds the values of SA, CT at p_i on this cast.</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% This function was adapted from Matlab&#39;s interp1q.</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_linear_interp_sa_ct</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">np</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">p_i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">npi</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">sa_i</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct_i</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">in_rng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">jrev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">ki</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">imax_p</span><span class="p">,</span><span class="w"> </span><span class="n">imin_p</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">xxi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">max_p</span><span class="p">,</span><span class="w"> </span><span class="n">min_p</span><span class="p">;</span>

<span class="w">  </span><span class="n">min_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">  </span><span class="n">imin_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imax_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">np</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">min_p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">min_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">      </span><span class="n">imin_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">max_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">      </span><span class="n">imax_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">in_rng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">char</span><span class="p">[</span><span class="n">npi</span><span class="p">];</span>
<span class="w">  </span><span class="n">memset</span><span class="p">(</span><span class="n">in_rng</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">npi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">npi</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p_i</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">min_p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sa_i</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">imin_p</span><span class="p">];</span>
<span class="w">      </span><span class="n">ct_i</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">imin_p</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p_i</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">max_p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sa_i</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">imax_p</span><span class="p">];</span>
<span class="w">      </span><span class="n">ct_i</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">imax_p</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">in_rng</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">n</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">in_rng</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">in_rng</span><span class="p">;}</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
<span class="w">  </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">];</span>
<span class="w">  </span><span class="n">ki</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">  </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ki</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">  </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">  </span><span class="n">xxi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">[</span><span class="n">m</span><span class="p">];</span>
<span class="w">  </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">];</span>
<span class="w">  </span><span class="n">jrev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">  </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">npi</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">in_rng</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">xi</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_i</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">      </span><span class="n">ki</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">      </span><span class="n">ii</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">in_rng</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">in_rng</span><span class="p">;</span>
<span class="w">    </span><span class="n">in_rng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">gsw_util_sort_dbl</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">np</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">xxi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">xxi</span><span class="p">[</span><span class="n">np</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xi</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">gsw_util_sort_dbl</span><span class="p">(</span><span class="n">xxi</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">jrev</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jrev</span><span class="p">[</span><span class="n">np</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]]);</span>
<span class="w">    </span><span class="n">sa_i</span><span class="p">[</span><span class="n">ki</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">    </span><span class="n">ct_i</span><span class="p">[</span><span class="n">ki</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">xi</span><span class="p">;}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">k</span><span class="p">;}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xxi</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">xxi</span><span class="p">;}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">j</span><span class="p">;}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_O2sol                                    solubility of O2 in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_O2sol(SA,CT,p,long,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the oxygen concentration expected at equilibrium with air at</span>
<span class="cm">%  an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar) including</span>
<span class="cm">%  saturated water vapor.  This function uses the solubility coefficients</span>
<span class="cm">%  derived from the data of Benson and Krause (1984), as fitted by Garcia</span>
<span class="cm">%  and Gordon (1992, 1993).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127.  It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity                                      [ g/kg ]</span>
<span class="cm">%  CT    =  Conservative Temperature (ITS-90)                     [ deg C ]</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%           ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  long  =  longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  O2sol = solubility of oxygen in micro-moles per kg           [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Benson, B.B., and D. Krause, 1984: The concentration and isotopic</span>
<span class="cm">%   fractionation of oxygen dissolved in freshwater and seawater in</span>
<span class="cm">%   equilibrium with the atmosphere. Limnology and Oceanography, 29,</span>
<span class="cm">%   620-632.</span>
<span class="cm">%</span>
<span class="cm">%  Garcia, H.E., and L.I. Gordon, 1992: Oxygen solubility in seawater:</span>
<span class="cm">%   Better fitting equations. Limnology and Oceanography, 37, 1307-1312.</span>
<span class="cm">%</span>
<span class="cm">%  Garcia, H.E., and L.I. Gordon, 1993: Erratum: Oxygen solubility in</span>
<span class="cm">%   seawater: better fitting equations. Limnology and Oceanography, 38,</span>
<span class="cm">%   656.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_o2sol</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pt68</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span>
<span class="w">    </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">a3</span><span class="p">,</span><span class="w"> </span><span class="n">a4</span><span class="p">,</span><span class="w"> </span><span class="n">a5</span><span class="p">,</span>
<span class="w">    </span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">b2</span><span class="p">,</span><span class="w"> </span><span class="n">b3</span><span class="p">,</span><span class="w"> </span><span class="n">c0</span><span class="p">;</span>

<span class="w">  </span><span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sp_from_sa</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">;</span>
<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">pt68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">298.15</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pt68</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt68</span><span class="p">));</span>

<span class="w">  </span><span class="n">a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.80871</span><span class="p">;</span>
<span class="w">  </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.20291</span><span class="p">;</span>
<span class="w">  </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.17887</span><span class="p">;</span>
<span class="w">  </span><span class="n">a3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.10006</span><span class="p">;</span>
<span class="w">  </span><span class="n">a4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.86643e-2</span><span class="p">;</span>
<span class="w">  </span><span class="n">a5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.80369</span><span class="p">;</span>
<span class="w">  </span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.01577e-3</span><span class="p">;</span>
<span class="w">  </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.70028e-3</span><span class="p">;</span>
<span class="w">  </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.13864e-2</span><span class="p">;</span>
<span class="w">  </span><span class="n">b3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.51519e-3</span><span class="p">;</span>
<span class="w">  </span><span class="n">c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.75915e-7</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                          </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_O2sol_SP_pt                              solubility of O2 in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_O2sol_SP_pt(SP,pt)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the oxygen concentration expected at equilibrium with air at</span>
<span class="cm">%  an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar) including</span>
<span class="cm">%  saturated water vapor.  This function uses the solubility coefficients</span>
<span class="cm">%  derived from the data of Benson and Krause (1984), as fitted by Garcia</span>
<span class="cm">%  and Gordon (1992, 1993).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP  =  Practical Salinity  (PSS-78)                         [ unitless ]</span>
<span class="cm">%  pt  =  potential temperature (ITS-90) referenced               [ deg C ]</span>
<span class="cm">%         to one standard atmosphere (0 dbar).</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  O2sol = solubility of oxygen in micro-moles per kg           [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Benson, B.B., and D. Krause, 1984: The concentration and isotopic</span>
<span class="cm">%   fractionation of oxygen dissolved in freshwater and seawater in</span>
<span class="cm">%   equilibrium with the atmosphere. Limnology and Oceanography, 29,</span>
<span class="cm">%   620-632.</span>
<span class="cm">%</span>
<span class="cm">%  Garcia, H.E., and L.I. Gordon, 1992: Oxygen solubility in seawater:</span>
<span class="cm">%   Better fitting equations. Limnology and Oceanography, 37, 1307-1312.</span>
<span class="cm">%</span>
<span class="cm">%  Garcia, H.E., and L.I. Gordon, 1993: Erratum: Oxygen solubility in</span>
<span class="cm">%   seawater: better fitting equations. Limnology and Oceanography, 38,</span>
<span class="cm">%   656.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_o2sol_sp_pt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt68</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span>
<span class="w">    </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">a3</span><span class="p">,</span><span class="w"> </span><span class="n">a4</span><span class="p">,</span><span class="w"> </span><span class="n">a5</span><span class="p">,</span>
<span class="w">    </span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">b2</span><span class="p">,</span><span class="w"> </span><span class="n">b3</span><span class="p">,</span><span class="w"> </span><span class="n">c0</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="p">;</span>
<span class="w">  </span><span class="n">pt68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">298.15</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pt68</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt68</span><span class="p">));</span>

<span class="w">  </span><span class="n">a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.80871</span><span class="p">;</span>
<span class="w">  </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.20291</span><span class="p">;</span>
<span class="w">  </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.17887</span><span class="p">;</span>
<span class="w">  </span><span class="n">a3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.10006</span><span class="p">;</span>
<span class="w">  </span><span class="n">a4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.86643e-2</span><span class="p">;</span>
<span class="w">  </span><span class="n">a5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.80369</span><span class="p">;</span>

<span class="w">  </span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.01577e-3</span><span class="p">;</span>
<span class="w">  </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.70028e-3</span><span class="p">;</span>
<span class="w">  </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.13864e-2</span><span class="p">;</span>
<span class="w">  </span><span class="n">b3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.51519e-3</span><span class="p">;</span>
<span class="w">  </span><span class="n">c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.75915e-7</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                          </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_p_from_z                      pressure from height (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_p_from_z(z,lat,geo_strf_dyn_height,sea_surface_geopotental)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates sea pressure from height using computationally-efficient</span>
<span class="cm">%  75-term expression for density, in terms of SA, CT and p (Roquet et al.,</span>
<span class="cm">%  2015).  Dynamic height anomaly, geo_strf_dyn_height, if provided,</span>
<span class="cm">%  must be computed with its p_ref = 0 (the surface). Also if provided,</span>
<span class="cm">%  sea_surface_geopotental is the geopotential at zero sea pressure. This</span>
<span class="cm">%  function solves Eqn.(3.32.3) of IOC et al. (2010) iteratively for p.</span>
<span class="cm">%</span>
<span class="cm">%  Note. Height (z) is NEGATIVE in the ocean.  Depth is -z.</span>
<span class="cm">%    Depth is not used in the GSW computer software library.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  z  =  height                                                       [ m ]</span>
<span class="cm">%   Note. At sea level z = 0, and since z (HEIGHT) is defined</span>
<span class="cm">%     to be positive upwards, it follows that while z is</span>
<span class="cm">%     positive in the atmosphere, it is NEGATIVE in the ocean.</span>
<span class="cm">%  lat  =  latitude in decimal degrees north                [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OPTIONAL:</span>
<span class="cm">%  geo_strf_dyn_height = dynamic height anomaly                 [ m^2/s^2 ]</span>
<span class="cm">%    Note that the reference pressure, p_ref, of geo_strf_dyn_height must</span>
<span class="cm">%     be zero (0) dbar.</span>
<span class="cm">%  sea_surface_geopotental = geopotential at zero sea pressure  [ m^2/s^2 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%   p  =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall, Claire Roberts-Thomson and Paul Barker.</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, pp. 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  Moritz, H., 2000: Geodetic reference system 1980. J. Geodesy, 74,</span>
<span class="cm">%   pp. 128-133.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  Saunders, P.M., 1981: Practical conversion of pressure to depth.</span>
<span class="cm">%   Journal of Physical Oceanography, 11, pp. 573-574.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_p_from_z</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">geo_strf_dyn_height</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sea_surface_geopotential</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sinlat</span><span class="p">,</span><span class="w"> </span><span class="n">sin2</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">df_dp</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">p_old</span><span class="p">,</span><span class="w"> </span><span class="n">p_mid</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;}</span>

<span class="w">  </span><span class="n">sinlat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">deg2rad</span><span class="p">);</span>
<span class="w">  </span><span class="n">sin2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sinlat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sinlat</span><span class="p">;</span>
<span class="w">  </span><span class="n">gs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9.780327</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">5.2792e-3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">2.32e-5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin2</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin2</span><span class="p">);</span>
<span class="w">  </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.25e-3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">5.92e-3</span><span class="p">;</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.84e-6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">));</span>
<span class="w">  </span><span class="n">df_dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_specvol_sso_0</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy_sso_0</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="p">(</span><span class="n">geo_strf_dyn_height</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sea_surface_geopotential</span><span class="p">);</span>
<span class="w">  </span><span class="n">p_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df_dp</span><span class="p">;</span>
<span class="w">  </span><span class="n">p_mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_old</span><span class="p">);</span>
<span class="w">  </span><span class="n">df_dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_specvol_sso_0</span><span class="p">(</span><span class="n">p_mid</span><span class="p">);</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df_dp</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_pot_enthalpy_from_pt_ice               potential enthalpy of ice from</span>
<span class="cm">%                              potential temperature refered to the surface</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_pot_enthalpy_from_pt_ice(pt0_ice)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the potential enthalpy of ice from potential temperature of</span>
<span class="cm">%  ice (whose reference sea pressure is zero dbar).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  pt0_ice  =  potential temperature of ice (ITS-90)              [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  pot_enthalpy_ice  =  potential enthalpy of ice                  [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pot_enthalpy_from_pt_ice</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">pt0_ice</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">tau</span><span class="p">;</span>
<span class="w">  </span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">h0_part</span><span class="p">,</span><span class="w"> </span><span class="n">sqtau_t1</span><span class="p">,</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">;</span>

<span class="w">  </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pt0_ice</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">rec_tt</span><span class="p">;</span>
<span class="w">  </span><span class="n">sqtau_t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t1</span><span class="p">);</span>
<span class="w">  </span><span class="n">sqtau_t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">tau</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t2</span><span class="p">);</span>
<span class="w">  </span><span class="n">h0_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqtau_t1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">r20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqtau_t2</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gic</span><span class="p">.</span><span class="n">g00</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gic</span><span class="p">.</span><span class="n">tt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">real</span><span class="p">(</span><span class="n">h0_part</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_pot_enthalpy_ice_freezing_first_derivatives_poly    first derivatives</span>
<span class="cm">%                  of the potential enthalpy of ice at the conditions where</span>
<span class="cm">%                  ice and seawater are in thermodynamic equilibrium (poly)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_pot_enthalpy_ice_freezing_first_derivatives_poly(SA,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the first derivatives of the potential enthalpy of ice Ih at</span>
<span class="cm">%  which ice melts into seawater with Absolute Salinity SA and at pressure</span>
<span class="cm">%  p.  This code uses the computationally efficient polynomial fit of the</span>
<span class="cm">%  freezing potential enthalpy of ice Ih (McDougall et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  pot_enthalpy_ice_freezing_SA = the derivative of the potential enthalpy</span>
<span class="cm">%                of ice at freezing (ITS-90) with respect to Absolute</span>
<span class="cm">%                salinity at fixed pressure  [ (J/kg)/(g/kg) ] i.e. [ J/g ]</span>
<span class="cm">%</span>
<span class="cm">%  pot_enthalpy_ice_freezing_P  = the derivative of the potential enthalpy</span>
<span class="cm">%                of ice at freezing (ITS-90) with respect to pressure</span>
<span class="cm">%                (in Pa) at fixed Absolute Salinity           [ (J/kg)/Pa ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="cm">%   Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="cm">%   Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall et al. 2015: A reference for this polynomial.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pot_enthalpy_ice_freezing_first_derivatives_poly</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">pot_enthalpy_ice_freezing_sa</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">pot_enthalpy_ice_freezing_p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">p_r</span><span class="p">,</span><span class="w"> </span><span class="n">sa_r</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">    </span><span class="n">d1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.249490228128056e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">d2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.336783910789822e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">d3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.811989517774642e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">d4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.044864276240987e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">d5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.124452125071862e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">d6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.280706828014839e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">d7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.315423710959628e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.592775732074710e2</span><span class="p">,</span>
<span class="w">    </span><span class="n">d9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.644828513129230e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.809640968940840e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.901071777977272e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.218459682855746e2</span><span class="p">,</span>
<span class="w">    </span><span class="n">d13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.379377450285737e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.672164989849465e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.044317489422632e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.631711865886377e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.160245473297112e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">d18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.029061696035465e2</span><span class="p">,</span>
<span class="w">    </span><span class="n">d19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.682950019675760e2</span><span class="p">,</span>
<span class="w">    </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.034535061416256e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.315423710959628e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.239518382138314e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.822414256564615e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.923856387576336e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.967023925992424e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.263384562367307e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.051613740291480e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.587549005714740e2</span><span class="p">,</span>
<span class="w">    </span><span class="n">f10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.562886653132620e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.044317489422632e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.105369492709102e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">f13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.387082316647800e2</span><span class="p">,</span>
<span class="w">    </span><span class="n">f14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.807364198913360e2</span><span class="p">,</span>
<span class="w">    </span><span class="n">f15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.058123392070929e2</span><span class="p">,</span>
<span class="w">    </span><span class="n">f16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.524425029513641e2</span><span class="p">;</span>

<span class="w">  </span><span class="n">sa_r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">sa_r</span><span class="p">);</span>
<span class="w">  </span><span class="n">p_r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pot_enthalpy_ice_freezing_sa</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">pot_enthalpy_ice_freezing_sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">d1</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d9</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d11</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d15</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d17</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d18</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d19</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)))))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pot_enthalpy_ice_freezing_p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">pot_enthalpy_ice_freezing_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">f1</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f9</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f11</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">f15</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)))))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-8</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_pot_enthalpy_ice_freezing_poly              potential enthalpy of ice</span>
<span class="cm">%                                          at which seawater freezes (poly)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_pot_enthalpy_ice_freezing_poly(SA,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the potential enthalpy of ice at which seawater freezes.</span>
<span class="cm">%  The error of this fit ranges between -2.5 and 1 J/kg with an rms of</span>
<span class="cm">%  1.07, between SA of 0 and 120 g/kg and p between 0 and 10,000 dbar (the</span>
<span class="cm">%  error in the fit is between -0.7 and 0.7 with an rms of</span>
<span class="cm">%  0.3, between SA of 0 and 120 g/kg and p between 0 and 5,000 dbar) when</span>
<span class="cm">%  compared with the potential enthalpy calculated from the exact in-situ</span>
<span class="cm">%  freezing temperature which is found by a Newton-Raphson iteration of the</span>
<span class="cm">%  equality of the chemical potentials of water in seawater and in ice.</span>
<span class="cm">%  Note that the potential enthalpy at freezing can be found</span>
<span class="cm">%  by this exact method using the function gsw_pot_enthalpy_ice_freezing.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  pot_enthalpy_ice_freezing = potential enthalpy of ice at freezing</span>
<span class="cm">%                              of seawater                         [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="cm">%   Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="cm">%   Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pot_enthalpy_ice_freezing_poly</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p_r</span><span class="p">,</span><span class="w"> </span><span class="n">sa_r</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">    </span><span class="n">c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.333548730778702e5</span><span class="p">,</span>
<span class="w">    </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.249490228128056e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.891189273859881e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.405994758887321e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.217945710496395e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.374817375023954e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.651630522289954e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.034535061416256e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.252580687014574e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.021290274388826e4</span><span class="p">,</span>
<span class="w">    </span><span class="n">c10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.315423710959628e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.239518382138314e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.379377450285737e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.822414256564615e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.781443326566310e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.160245473297112e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.923856387576336e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.522158744711316e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.268604113069031e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.967023925992424e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.052684746354551e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.184147500983788e3</span><span class="p">,</span>
<span class="w">    </span><span class="n">c22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.263384562367307e3</span><span class="p">;</span>

<span class="w">  </span><span class="n">sa_r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">sa_r</span><span class="p">);</span>
<span class="w">  </span><span class="n">p_r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">c0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c9</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c12</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c15</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c21</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_r</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c17</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c19</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_r</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c11</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c18</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">c16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_r</span><span class="p">)));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_pt_from_ct        potential temperature from Conservative Temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_pt_from_ct(SA,CT)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates potential temperature (with a reference sea pressure of</span>
<span class="cm">%  zero dbar) from Conservative Temperature.  This function uses 1.5</span>
<span class="cm">%  iterations through a modified Newton-Raphson (N-R) iterative solution</span>
<span class="cm">%  proceedure, starting from a rational-function-based initial condition</span>
<span class="cm">%  for both pt and dCT_dpt.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  pt  =  potential temperature referenced to a sea pressure</span>
<span class="cm">%         of zero dbar (ITS-90)                                   [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall, David Jackett, Claire Roberts-Thomson and Paul Barker.</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See sections 3.1 and 3.3 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a5ct</span><span class="p">,</span><span class="w"> </span><span class="n">b3ct</span><span class="p">,</span><span class="w"> </span><span class="n">ct_factor</span><span class="p">,</span><span class="w"> </span><span class="n">pt_num</span><span class="p">,</span><span class="w"> </span><span class="n">pt_recden</span><span class="p">,</span><span class="w"> </span><span class="n">ct_diff</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pt_old</span><span class="p">,</span><span class="w"> </span><span class="n">ptm</span><span class="p">,</span><span class="w"> </span><span class="n">dpt_dct</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.446013646344788e-2</span><span class="p">,</span>
<span class="w">    </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.305308995852924e-3</span><span class="p">,</span>
<span class="w">    </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.062415929128982e-4</span><span class="p">,</span>
<span class="w">    </span><span class="n">a3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9.477566673794488e-1</span><span class="p">,</span>
<span class="w">    </span><span class="n">a4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.166591947736613e-3</span><span class="p">,</span>
<span class="w">    </span><span class="n">a5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.828842955039902e-3</span><span class="p">,</span>
<span class="w">    </span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.000000000000000e0</span><span class="p">,</span>
<span class="w">    </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.506097115635800e-4</span><span class="p">,</span>
<span class="w">    </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.830289486850898e-3</span><span class="p">,</span>
<span class="w">    </span><span class="n">b3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.247811760368034e-6</span><span class="p">;</span>

<span class="w">  </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_ups</span><span class="p">;</span>
<span class="w">  </span><span class="n">a5ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">b3ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a5ct</span><span class="p">);</span>
<span class="w">  </span><span class="n">pt_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_factor</span><span class="p">;</span>
<span class="w">  </span><span class="n">pt_recden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b3ct</span><span class="p">));</span>
<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt_num</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pt_recden</span><span class="p">;</span>
<span class="w">  </span><span class="n">dpt_dct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt_recden</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ct_factor</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a5ct</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b3ct</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b3ct</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pt</span><span class="p">);</span>
<span class="w">  </span><span class="n">ct_diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_ct_from_pt</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">pt_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="p">;</span>
<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_diff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dpt_dct</span><span class="p">;</span>
<span class="w">  </span><span class="n">ptm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt_old</span><span class="p">);</span>
<span class="w">  </span><span class="n">dpt_dct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="n">ptm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs_pt0_pt0</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ptm</span><span class="p">));</span>
<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_diff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dpt_dct</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_ct_from_pt</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct</span><span class="p">;</span>
<span class="w">  </span><span class="n">pt_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">pt_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_diff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dpt_dct</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_pt_from_t                                       potential temperature</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_pt_from_t(SA,t,p,p_ref)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates potential temperature with the general reference pressure,</span>
<span class="cm">%  p_ref, from in-situ temperature, t.  This function calls</span>
<span class="cm">%  &quot;gsw_entropy_part&quot; which evaluates entropy except for the parts which</span>
<span class="cm">%  are a function of Absolute Salinity alone.</span>
<span class="cm">%  A faster gsw routine exists if p_ref is indeed zero dbar.  This routine</span>
<span class="cm">%  is &quot;gsw_pt0_from_t(SA,t,p)&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OPTIONAL:</span>
<span class="cm">%  p_ref  =  reference pressure                                    [ dbar ]</span>
<span class="cm">%  (If reference pressure is not given then it is assumed that reference</span>
<span class="cm">%   pressure is zero).</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  pt  =  potential temperature with reference pressure, p_ref, on the</span>
<span class="cm">%         ITS-90 temperature scale                                [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall, David Jackett, Claire Roberts-Thomson and Paul Barker.</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.1 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pt_from_t</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p_ref</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">no_iter</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">ptm</span><span class="p">,</span><span class="w"> </span><span class="n">pt_old</span><span class="p">,</span><span class="w"> </span><span class="n">dentropy</span><span class="p">,</span><span class="w"> </span><span class="n">dentropy_dt</span><span class="p">,</span><span class="w"> </span><span class="n">true_entropy_part</span><span class="p">;</span>

<span class="w">  </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_ups</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p_ref</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">8.65483913395442e-6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">1.41636299744881e-6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_ref</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">7.38286467135737e-9</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-8.38241357039698e-6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">2.83933368585534e-8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">1.77803965218656e-8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_ref</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">1.71155619208233e-10</span><span class="p">));</span>

<span class="w">  </span><span class="n">dentropy_dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="p">)));</span>
<span class="w">  </span><span class="n">true_entropy_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_entropy_part</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">no_iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">no_iter</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">no_iter</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pt_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="p">;</span>
<span class="w">    </span><span class="n">dentropy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_entropy_part</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt_old</span><span class="p">,</span><span class="w"> </span><span class="n">p_ref</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">true_entropy_part</span><span class="p">;</span>
<span class="w">    </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dentropy</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dentropy_dt</span><span class="p">;</span>
<span class="w">    </span><span class="n">ptm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt_old</span><span class="p">);</span>
<span class="w">    </span><span class="n">dentropy_dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ptm</span><span class="p">,</span><span class="w"> </span><span class="n">p_ref</span><span class="p">);</span>
<span class="w">    </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dentropy</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dentropy_dt</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">pt</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_pt0_from_t                               potential temperature with a</span>
<span class="cm">%                                       reference sea pressure of zero dbar</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_pt0_from_t(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates potential temperature with reference pressure, p_ref = 0 dbar.</span>
<span class="cm">%  The present routine is computationally faster than the more general</span>
<span class="cm">%  function &quot;gsw_pt_from_t(SA,t,p,p_ref)&quot; which can be used for any</span>
<span class="cm">%  reference pressure value.</span>
<span class="cm">%  This subroutine calls &quot;gsw_entropy_part(SA,t,p)&quot;,</span>
<span class="cm">%  &quot;gsw_entropy_part_zerop(SA,pt0)&quot; and &quot;gsw_gibbs_pt0_pt0(SA,pt0)&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  pt0  =  potential temperature                                  [ deg C ]</span>
<span class="cm">%          with reference sea pressure (p_ref) = 0 dbar.</span>
<span class="cm">%  Note. The reference sea pressure of the output, pt0, is zero dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall, David Jackett, Claire Roberts-Thomson and Paul Barker.</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.1 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pt0_from_t</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">no_iter</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pt0_old</span><span class="p">,</span><span class="w"> </span><span class="n">dentropy</span><span class="p">,</span><span class="w"> </span><span class="n">dentropy_dt</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">true_entropy_part</span><span class="p">,</span><span class="w"> </span><span class="n">pt0m</span><span class="p">;</span>

<span class="w">  </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_ups</span><span class="p">;</span>
<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">8.65483913395442e-6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">1.41636299744881e-6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">7.38286467135737e-9</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-8.38241357039698e-6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">2.83933368585534e-8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">1.77803965218656e-8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="mf">1.71155619208233e-10</span><span class="p">));</span>

<span class="w">  </span><span class="n">dentropy_dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="p">)));</span>
<span class="w">  </span><span class="n">true_entropy_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_entropy_part</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">no_iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">no_iter</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">no_iter</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pt0_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt0</span><span class="p">;</span>
<span class="w">    </span><span class="n">dentropy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_entropy_part_zerop</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0_old</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">      </span><span class="n">true_entropy_part</span><span class="p">;</span>
<span class="w">    </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt0_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dentropy</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dentropy_dt</span><span class="p">;</span>
<span class="w">    </span><span class="n">pt0m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pt0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0_old</span><span class="p">);</span>
<span class="w">    </span><span class="n">dentropy_dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gsw_gibbs_pt0_pt0</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0m</span><span class="p">);</span>
<span class="w">    </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt0_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dentropy</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dentropy_dt</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">pt0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">% gsw_rho                                in-situ density (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_rho(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates in-situ density from Absolute Salinity and Conservative</span>
<span class="cm">%  Temperature, using the computationally-efficient expression for</span>
<span class="cm">%  specific volume in terms of SA, CT and p  (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that potential density with respect to reference pressure, pr, is</span>
<span class="cm">%  obtained by calling this function with the pressure argument being pr</span>
<span class="cm">%  (i.e. &quot;gsw_rho(SA,CT,pr)&quot;).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  rho  =  in-situ density                                         [ kg/m ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rho</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_specvol</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">% gsw_rho_alpha_beta            in-situ density, thermal expansion &amp; saline</span>
<span class="cm">%                                contraction coefficient (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">% gsw_rho_alpha_beta(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates in-situ density, the appropiate thermal expansion coefficient</span>
<span class="cm">%  and the appropriate saline contraction coefficient of seawater from</span>
<span class="cm">%  Absolute Salinity and Conservative Temperature.  This function uses the</span>
<span class="cm">%  computationally-efficient expression for specific volume in terms of</span>
<span class="cm">%  SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that potential density (pot_rho) with respect to reference pressure</span>
<span class="cm">%  p_ref is obtained by calling this function with the pressure argument</span>
<span class="cm">%  being p_ref as in [pot_rho, ~, ~] = gsw_rho_alpha_beta(SA,CT,p_ref).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  rho    =  in-situ density                                       [ kg/m ]</span>
<span class="cm">%  alpha  =  thermal expansion coefficient                          [ 1/K ]</span>
<span class="cm">%            with respect to Conservative Temperature</span>
<span class="cm">%  beta   =  saline (i.e. haline) contraction                      [ kg/g ]</span>
<span class="cm">%            coefficient at constant Conservative Temperature</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rho_alpha_beta</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">rho</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">beta</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">v_ct_part</span><span class="p">,</span><span class="w"> </span><span class="n">v_sa_part</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>
<span class="w">  </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gsvco_v</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rho</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">rho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v_ct_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gsvco_a</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v_ct_part</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beta</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v_sa_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gsvco_b</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">v_sa_part</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SA_from_SP                  Absolute Salinity from Practical Salinity</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_SA_from_SP(SP,p,long,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Absolute Salinity from Practical Salinity.  Since SP is</span>
<span class="cm">%  non-negative by definition, this function changes any negative input</span>
<span class="cm">%  values of SP to be zero.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP   =  Practical Salinity  (PSS-78)                        [ unitless ]</span>
<span class="cm">%  p    =  sea pressure                                            [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  long =  longitude in decimal degrees                      [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat  =  latitude in decimal degrees north                [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SA        =  Absolute Salinity                                  [ g/kg ]</span>
<span class="cm">%  in_ocean  =  0, if long and lat are a long way from the ocean</span>
<span class="cm">%            =  1, if long and lat are in the ocean</span>
<span class="cm">%  Note. This flag is only set when the observation is well and truly on</span>
<span class="cm">%    dry land; often the warning flag is not set until one is several</span>
<span class="cm">%    hundred kilometres inland from the coast.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall &amp; Paul Barker       [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.5 and appendices A.4 and A.5 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sa_from_sp</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="n">gsw_sa_baltic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sa_from_sp_baltic</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_sa_baltic</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">gsw_sa_baltic</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">saar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_saar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">saar</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_ups</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.</span><span class="n">e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SA_from_SP_Baltic      Calculates Absolute Salinity in the Baltic Sea</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_SA_from_SP_Baltic(SP,long,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Absolute Salinity in the Baltic Sea, from Practical Salinity.</span>
<span class="cm">%  Since SP is non-negative by definition, this function changes any</span>
<span class="cm">%  negative input values of SP to be zero.</span>
<span class="cm">%  Note. This programme will only produce Absolute Salinity values for the</span>
<span class="cm">%    Baltic Sea.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP    =  Practical Salinity  (PSS-78)                       [ unitless ]</span>
<span class="cm">%  long  =  Longitude in decimal degrees east                [ 0 ... +360 ]</span>
<span class="cm">%  lat   =  Latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SA_baltic  =  Absolute Salinity in the Baltic Sea            [ g kg^-1 ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall &amp; Paul Barker       [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Feistel, R., S. Weinreben, H. Wolf, S. Seitz, P. Spitzer, B. Adel,</span>
<span class="cm">%   G. Nausch, B. Schneider and D. G. Wright, 2010: Density and Absolute</span>
<span class="cm">%   Salinity of the Baltic Sea 2006-2009.  Ocean Science, 6, 3-24.</span>
<span class="cm">%   http://www.ocean-sci.net/6/3/2010/os-6-3-2010.pdf</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sa_from_sp_baltic</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xx_left</span><span class="p">,</span><span class="w"> </span><span class="n">xx_right</span><span class="p">,</span><span class="w"> </span><span class="n">return_value</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gbalt</span><span class="p">.</span><span class="n">xb_left</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">gbalt</span><span class="p">.</span><span class="n">xb_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="n">gbalt</span><span class="p">.</span><span class="n">yb_left</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">gbalt</span><span class="p">.</span><span class="n">yb_left</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">xx_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_xinterp1</span><span class="p">(</span><span class="n">gbalt</span><span class="p">.</span><span class="n">yb_left</span><span class="p">,</span><span class="w"> </span><span class="n">gbalt</span><span class="p">.</span><span class="n">xb_left</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>
<span class="w">    </span><span class="n">xx_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_xinterp1</span><span class="p">(</span><span class="n">gbalt</span><span class="p">.</span><span class="n">yb_right</span><span class="p">,</span><span class="w"> </span><span class="n">gbalt</span><span class="p">.</span><span class="n">xb_right</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xx_left</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">xx_right</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.087</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">35.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.087</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">return_value</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SA_from_Sstar               Absolute Salinity from Preformed Salinity</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_SA_from_Sstar(Sstar,p,long,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Absolute Salinity from Preformed Salinity.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  Sstar  =  Preformed Salinity                                    [ g/kg ]</span>
<span class="cm">%  p      =  sea pressure                                          [ dbar ]</span>
<span class="cm">%            ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  long   =  longitude in decimal degrees                    [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat    =  latitude in decimal degrees north              [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SA        =  Absolute Salinity                                  [ g/kg ]</span>
<span class="cm">%  in_ocean  =  0, if long and lat are a long way from the ocean</span>
<span class="cm">%            =  1, if long and lat are in the ocean</span>
<span class="cm">%  Note. This flag is only set when the observation is well and truly on</span>
<span class="cm">%    dry land; often the warning flag is not set until one is several</span>
<span class="cm">%    hundred kilometres inland from the coast.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sa_from_sstar</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sstar</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">saar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_saar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">saar</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">sstar</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">saar</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.35e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SAAR       Absolute Salinity Anomaly Ratio (excluding the Baltic Sea)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_SAAR(p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Absolute Salinity Anomaly Ratio, SAAR, in the open ocean</span>
<span class="cm">%  by spatially interpolating the global reference data set of SAAR to the</span>
<span class="cm">%  location of the seawater sample.</span>
<span class="cm">%</span>
<span class="cm">%  This function uses version 3.0 of the SAAR look up table (15th May 2011).</span>
<span class="cm">%</span>
<span class="cm">%  The Absolute Salinity Anomaly Ratio in the Baltic Sea is evaluated</span>
<span class="cm">%  separately, since it is a function of Practical Salinity, not of space.</span>
<span class="cm">%  The present function returns a SAAR of zero for data in the Baltic Sea.</span>
<span class="cm">%  The correct way of calculating Absolute Salinity in the Baltic Sea is by</span>
<span class="cm">%  calling gsw_SA_from_SP.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%          ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon  =  Longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                      or [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  Latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SAAR      =  Absolute Salinity Anomaly Ratio                [ unitless ]</span>
<span class="cm">%  in_ocean  =  0, if long and lat are a long way from the ocean</span>
<span class="cm">%            =  1, if long and lat are in or near the ocean</span>
<span class="cm">%  Note. This flag is only set when the observation is well and truly on</span>
<span class="cm">%    dry land; often the warning flag is not set until one is several</span>
<span class="cm">%    hundred kilometres inland from the coast.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett                                       [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% MODIFIED:</span>
<span class="cm">%  Paul Barker and Trevor McDougall</span>
<span class="cm">%  Acknowledgment. Matlab programming assisance from Sunke Schmidtko.</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  See also gsw_SA_from_SP, gsw_deltaSA_atlas</span>
<span class="cm">%</span>
<span class="cm">%  Reference page in Help browser</span>
<span class="cm">%       &lt;a href=&quot;matlab:doc gsw_SAAR&quot;&gt;doc gsw_SAAR&lt;/a&gt;</span>
<span class="cm">%  Note that this reference page includes the code contained in gsw_SAAR.</span>
<span class="cm">%  We have opted to encode this programme as it is a global standard and</span>
<span class="cm">%  such we cannot allow anyone to change it.</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_saar</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_nx</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_ny</span><span class="p">,</span><span class="w"> </span><span class="n">nz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_nz</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">indx0</span><span class="p">,</span><span class="w"> </span><span class="n">indy0</span><span class="p">,</span><span class="w"> </span><span class="n">indz0</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">ndepth_index</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">saar</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">saar_old</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa_upper</span><span class="p">,</span><span class="w"> </span><span class="n">sa_lower</span><span class="p">,</span><span class="w"> </span><span class="n">dlong</span><span class="p">,</span><span class="w"> </span><span class="n">dlat</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r1</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">ndepth_max</span><span class="p">,</span><span class="w"> </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isnan</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isnan</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">return_value</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">-86.0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">90.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">return_value</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">lon</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">360.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">dlong</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">dlat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">indx0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">nx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">lon</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">      </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">nx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)));</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">indx0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">indy0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ny</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">      </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">ny</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)));</span>

<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">indy0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">indy0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ny</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">ndepth_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ndepth_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indy0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">delj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">deli</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ny</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_ndepth_ref</span><span class="p">(</span><span class="n">ndepth_index</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">      </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_ndepth_ref</span><span class="p">(</span><span class="n">ndepth_index</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e90</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="n">ndepth_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_max_d</span><span class="p">(</span><span class="n">ndepth_max</span><span class="p">,</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_ndepth_ref</span><span class="p">(</span><span class="n">ndepth_index</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ndepth_max</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">-1.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">ndepth_max</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">ndepth_max</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">indz0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_indxPref</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lon</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="p">));</span>

<span class="w">  </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="p">));</span>

<span class="w">  </span><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">indz0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">indz0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">indz0</span><span class="p">));</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">kpos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indz0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nz</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">indy0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">delj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">deli</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ny</span><span class="p">);</span>
<span class="w">    </span><span class="n">saar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_saar_ref</span><span class="p">(</span><span class="n">kpos</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">memmove</span><span class="p">(</span><span class="n">saar_old</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="w">    </span><span class="n">gsw_add_barrier</span><span class="p">(</span><span class="n">saar_old</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="p">),</span>
<span class="w">                                                         </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="p">),</span><span class="w"> </span><span class="n">dlong</span><span class="p">,</span>
<span class="w">      </span><span class="n">dlat</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">gsw_sum</span><span class="p">(</span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">saar</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">)))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">memmove</span><span class="p">(</span><span class="n">saar_old</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="w">    </span><span class="n">gsw_add_mean</span><span class="p">(</span><span class="n">saar_old</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">sa_upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">saar</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">saar</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">kpos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indz0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nz</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">indy0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">delj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">indx0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">deli</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ny</span><span class="p">);</span>
<span class="w">    </span><span class="n">saar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_saar_ref</span><span class="p">(</span><span class="n">kpos</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">memmove</span><span class="p">(</span><span class="n">saar_old</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="w">    </span><span class="n">gsw_add_barrier</span><span class="p">(</span><span class="n">saar_old</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_longs_ref</span><span class="p">(</span><span class="n">indx0</span><span class="p">),</span>
<span class="w">                                                         </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_lats_ref</span><span class="p">(</span><span class="n">indy0</span><span class="p">),</span><span class="w"> </span><span class="n">dlong</span><span class="p">,</span>
<span class="w">      </span><span class="n">dlat</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">gsw_sum</span><span class="p">(</span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">saar</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">)))</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">memmove</span><span class="p">(</span><span class="n">saar_old</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="w">    </span><span class="n">gsw_add_mean</span><span class="p">(</span><span class="n">saar_old</span><span class="p">,</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">sa_lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">saar</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">s1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">saar</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_lower</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sa_lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa_upper</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa_upper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">sa_lower</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_upper</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">return_value</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">return_value</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SP_from_SA                  Practical Salinity from Absolute Salinity</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_SP_from_SA(SA,p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Practical Salinity from Absolute Salinity.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity                                      [ g/kg ]</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%           ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon  =  longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SP        =  Practical Salinity  (PSS-78)                   [ unitless ]</span>
<span class="cm">%  in_ocean  =  0, if long and lat are a long way from the ocean</span>
<span class="cm">%            =  1, if long and lat are in the ocean</span>
<span class="cm">%  Note. This flag is only set when the observation is well and truly on</span>
<span class="cm">%    dry land; often the warning flag is not set until one is several</span>
<span class="cm">%    hundred kilometres inland from the coast.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker    [ help_gsw@csiro.au ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sp_from_sa</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="n">gsw_sp_baltic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sp_from_sa_baltic</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_sp_baltic</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">gsw_sp_baltic</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">saar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_saar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">saar</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="p">(</span><span class="n">sa</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_ups</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SP_from_SA_Baltic    Calculates Practical Salinity for the Baltic Sea</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_SP_from_SA_Baltic(SA,long,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Practical Salinity for the Baltic Sea, from a value computed</span>
<span class="cm">%  analytically from Absolute Salinity.</span>
<span class="cm">%  Note. This programme will only produce Practical Salinty values for the</span>
<span class="cm">%    Baltic Sea.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity in the Baltic Sea                 [ g kg^-1 ]</span>
<span class="cm">%  long  =  Longitude in decimal degress east                [ 0 ... +360 ]</span>
<span class="cm">%  lat   =  Latitude in decimal degress north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SP_baltic  =  Practical Salinity                            [ unitless ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall &amp; Paul Barker       [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Feistel, R., S. Weinreben, H. Wolf, S. Seitz, P. Spitzer, B. Adel,</span>
<span class="cm">%   G. Nausch, B. Schneider and D. G. Wright, 2010c: Density and Absolute</span>
<span class="cm">%   Salinity of the Baltic Sea 2006-2009.  Ocean Science, 6, 3-24.</span>
<span class="cm">%   http://www.ocean-sci.net/6/3/2010/os-6-3-2010.pdf</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sp_from_sa_baltic</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xx_left</span><span class="p">,</span><span class="w"> </span><span class="n">xx_right</span><span class="p">,</span><span class="w"> </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NAN</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gbalt</span><span class="p">.</span><span class="n">xb_left</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">gbalt</span><span class="p">.</span><span class="n">xb_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">    </span><span class="n">gbalt</span><span class="p">.</span><span class="n">yb_left</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">gbalt</span><span class="p">.</span><span class="n">yb_left</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">xx_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_xinterp1</span><span class="p">(</span><span class="n">gbalt</span><span class="p">.</span><span class="n">yb_left</span><span class="p">,</span><span class="w"> </span><span class="n">gbalt</span><span class="p">.</span><span class="n">xb_left</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>
<span class="w">    </span><span class="n">xx_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_xinterp1</span><span class="p">(</span><span class="n">gbalt</span><span class="p">.</span><span class="n">yb_right</span><span class="p">,</span><span class="w"> </span><span class="n">gbalt</span><span class="p">.</span><span class="n">xb_right</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xx_left</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">xx_right</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">35.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.087</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">sa</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.087</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">return_value</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SP_from_C                        Practical Salinity from conductivity</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_SP_from_C(C,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Practical Salinity, SP, from conductivity, C, primarily using</span>
<span class="cm">%  the PSS-78 algorithm.  Note that the PSS-78 algorithm for Practical</span>
<span class="cm">%  Salinity is only valid in the range 2 &lt; SP &lt; 42.  If the PSS-78</span>
<span class="cm">%  algorithm produces a Practical Salinity that is less than 2 then the</span>
<span class="cm">%  Practical Salinity is recalculated with a modified form of the Hill et</span>
<span class="cm">%  al. (1986) formula.  The modification of the Hill et al. (1986)</span>
<span class="cm">%  expression is to ensure that it is exactly consistent with PSS-78</span>
<span class="cm">%  at SP = 2.  Note that the input values of conductivity need to be in</span>
<span class="cm">%  units of mS/cm (not S/m).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  C  =  conductivity                                             [ mS/cm ]</span>
<span class="cm">%  t  =  in-situ temperature (ITS-90)                             [ deg C ]</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%        ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SP  =  Practical Salinity on the PSS-78 scale               [ unitless ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker, Trevor McDougall and Rich Pawlowicz    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Culkin and Smith, 1980:  Determination of the Concentration of Potassium</span>
<span class="cm">%   Chloride Solution Having the Same Electrical Conductivity, at 15C and</span>
<span class="cm">%   Infinite Frequency, as Standard Seawater of Salinity 35.0000</span>
<span class="cm">%   (Chlorinity 19.37394), IEEE J. Oceanic Eng, 5, 22-23.</span>
<span class="cm">%</span>
<span class="cm">%  Hill, K.D., T.M. Dauphinee &amp; D.J. Woods, 1986: The extension of the</span>
<span class="cm">%   Practical Salinity Scale 1978 to low salinities. IEEE J. Oceanic Eng.,</span>
<span class="cm">%   11, 109 - 112.</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix E of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Unesco, 1983: Algorithms for computation of fundamental properties of</span>
<span class="cm">%   seawater. Unesco Technical Papers in Marine Science, 44, 53 pp.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>

<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sp_from_c</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="n">t68</span><span class="p">,</span><span class="w"> </span><span class="n">ft68</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">rt_lc</span><span class="p">,</span><span class="w"> </span><span class="n">rp</span><span class="p">,</span><span class="w"> </span><span class="n">rt</span><span class="p">,</span><span class="w"> </span><span class="n">rtx</span><span class="p">,</span>
<span class="w">    </span><span class="n">hill_ratio</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sqrty</span><span class="p">,</span><span class="w"> </span><span class="n">part1</span><span class="p">,</span><span class="w"> </span><span class="n">part2</span><span class="p">,</span>
<span class="w">    </span><span class="n">sp_hill_raw</span><span class="p">;</span>
<span class="w">  </span><span class="n">t68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024e0</span><span class="p">;</span>
<span class="w">  </span><span class="n">ft68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15e0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15e0</span><span class="p">));</span>
<span class="w">  </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_c3515</span><span class="p">;</span>
<span class="w">  </span><span class="n">rt_lc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">c0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">c4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">;</span>
<span class="w">  </span><span class="n">rp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">e1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">e2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">d1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">d2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">d3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">d4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r</span><span class="p">);</span>
<span class="w">  </span><span class="n">rt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">rp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rt_lc</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">rt</span><span class="p">);</span>
<span class="w">  </span><span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">hill_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_hill_ratio_at_sp2</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">400e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rt</span><span class="p">;</span>
<span class="w">    </span><span class="n">sqrty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rtx</span><span class="p">;</span>
<span class="w">    </span><span class="n">part1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">part2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="p">));</span>
<span class="w">    </span><span class="n">sp_hill_raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ft68</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part2</span><span class="p">;</span>
<span class="w">    </span><span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hill_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sp_hill_raw</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">sp</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol                            specific volume (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_specvol(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific volume from Absolute Salinity, Conservative</span>
<span class="cm">%  Temperature and pressure, using the computationally-efficient 75-term</span>
<span class="cm">%  polynomial expression for specific volume (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol  =  specific volume                                   [ m^3/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Fabien Roquet, Gurvan Madec, Trevor McDougall &amp; Paul Barker</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmos. Ocean. Tech., 20,</span>
<span class="cm">%   730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gsvco_v</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_t_exact                                       specific volume</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_specvol_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the specific volume of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_t_exact  =  specific volume                           [ m^3/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett and Paul Barker                       [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.7 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>

<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_SSO_0                         specific volume at (SSO,CT=0,p)</span>
<span class="cm">%                                                        (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%  This function calculates specifc volume at the Standard Ocean Salinity,</span>
<span class="cm">%  SSO, and at a Conservative Temperature of zero degrees C, as a function</span>
<span class="cm">%  of pressure, p, in dbar, using a streamlined version of the 75-term CT</span>
<span class="cm">%  version of specific volume, that is, a streamlined version of the code</span>
<span class="cm">%  &quot;gsw_specvol(SA,CT,p)&quot;.</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_sso_0</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0e-4</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">9.726613854843870e-04</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-4.505913211160929e-05</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">7.130728965927127e-06</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-6.657179479768312e-07</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2.994054447232880e-08</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v005</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v006</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Sstar_from_SA               Preformed Salinity from Absolute Salinity</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_Sstar_from_SA(SA,p,long,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Converts Preformed Salinity from Absolute Salinity.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity                                      [ g/kg ]</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%           ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  long  =  longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Sstar     =  Preformed Salinity                                 [ g/kg ]</span>
<span class="cm">%  in_ocean  =  0, if long and lat are a long way from the ocean</span>
<span class="cm">%            =  1, if long and lat are in the ocean</span>
<span class="cm">%  Note. This flag is only set when the observation is well and truly on</span>
<span class="cm">%    dry land; often the warning flag is not set until one is several</span>
<span class="cm">%    hundred kilometres inland from the coast.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sstar_from_sa</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">saar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_saar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">saar</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.35e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">saar</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Sstar_from_SP              Preformed Salinity from Practical Salinity</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_Sstar_from_SP(SP,p,long,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Preformed Salinity from Absolute Salinity.</span>
<span class="cm">%  Since SP is non-negative by definition, this function changes any</span>
<span class="cm">%  negative input values of SP to be zero.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP   =  Practical  Salinity  (PSS-78)                       [ unitless ]</span>
<span class="cm">%  p    =  sea pressure                                            [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  long =  longitude in decimal degrees                      [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat  =  latitude in decimal degrees north                [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Sstar     =  Preformed Salinity                                 [ g/kg ]</span>
<span class="cm">%  in_ocean  =  0, if long and lat are a long way from the ocean</span>
<span class="cm">%            =  1, if long and lat are in the ocean</span>
<span class="cm">%  Note. This flag is only set when the observation is well and truly on</span>
<span class="cm">%    dry land; often the warning flag is not set until one is several</span>
<span class="cm">%    hundred kilometres inland from the coast.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall &amp; Paul Barker       [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.5 and appendices A.4 and A.5 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, F.J. Millero, R. Pawlowicz and</span>
<span class="cm">%   P.M. Barker, 2012: A global algorithm for estimating Absolute Salinity.</span>
<span class="cm">%   Ocean Science, 8, 1123-1134.</span>
<span class="cm">%   http://www.ocean-sci.net/8/1123/2012/os-8-1123-2012.pdf</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sstar_from_sp</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">saar</span><span class="p">,</span><span class="w"> </span><span class="n">sstar_baltic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sa_from_sp_baltic</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sstar_baltic</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">cppGSW_ERROR_LIMIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">sstar_baltic</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">saar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_saar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">saar</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cppGSW_INVALID_VALUE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">saar</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_ups</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.35e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">saar</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_t_deriv_chem_potential_water_t_exact       the temperature derivative</span>
<span class="cm">%                                of chemical potential of water in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_t_deriv_chem_potential_water_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the temperature derivative of the chemical potential of water</span>
<span class="cm">%  in seawater so that it is valid at exactly SA = 0.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  chem_potential_water_dt  =  temperature derivative of the chemical</span>
<span class="cm">%                           potential of water in seawater  [ J g^-1 K^-1 ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_t_deriv_chem_potential_water_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03_t</span><span class="p">,</span><span class="w"> </span><span class="n">g08_sa_t</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">g08_t</span><span class="p">,</span><span class="w"> </span><span class="n">kg2g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-3</span><span class="p">;</span>
<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="p">;</span>
<span class="w">  </span><span class="n">g03_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.90578347909402</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-270.983805184062</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">776.153611613101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-196.51255088122</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">28.9796526294175</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.13290083518327</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-24715.571866078</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2910.0729080936</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1513.116771538718</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">546.959324647056</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-111.1208127634436</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.68841343834394</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2210.2236124548363</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2017.52334943521</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1498.081172457456</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-718.6359919632359</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">146.4037555781616</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4.9892131862671505</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-592.743745734632</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1591.873781627888</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1207.261522487504</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">608.785486935364</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">105.4993508931208</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">290.12956292128547</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-973.091553087975</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">602.603274510125</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-276.361526170076</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">32.40953340386105</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-113.90630790850321</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">21.35571525415769</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">67.41756835751434</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">381.06836198507096</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-133.7383902842754</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.023632509086724</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))));</span>

<span class="w">  </span><span class="n">g08_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">168.072408311545</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-493.407510141682</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">543.835333000098</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-196.028306689776</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">36.7571622995805</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-137.1145018408982</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">148.10030845687618</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">12.4848504784754</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.6683558512829</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-175.292041186547</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">83.1923927801819</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">29.483064349429</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-86.1329351956084</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">766.116132004952</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.3834525034224</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">51.2796974779828</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1380.9597954037708</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.50240264723578</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">938.26075044542</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">g08_sa_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-980.14153344888</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-548.4580073635929</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">592.4012338275047</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2361238716608</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-258.3988055868252</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2298.348396014856</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-325.1503575102672</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">153.8390924339484</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-90.2046337756875</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4142.8793862113125</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">10.50720794170734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2814.78225133626</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">kg2g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="n">g03_t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08_t</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g08_sa_t</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_t_freezing              in-situ temperature at which seawater freezes</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_t_freezing(SA,p,saturation_fraction)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the in-situ temperature at which seawater freezes. The</span>
<span class="cm">%  in-situ temperature freezing point is calculated from the exact</span>
<span class="cm">%  in-situ freezing temperature which is found by a modified Newton-Raphson</span>
<span class="cm">%  iteration (McDougall and Wotherspoon, 2013) of the equality of the</span>
<span class="cm">%  chemical potentials of water in seawater and in ice.</span>
<span class="cm">%</span>
<span class="cm">%  An alternative GSW function, gsw_t_freezing_poly, it is based on a</span>
<span class="cm">%  computationally-efficient polynomial, and is accurate to within -5e-4 K</span>
<span class="cm">%  and 6e-4 K, when compared with this function.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OPTIONAL:</span>
<span class="cm">%  saturation_fraction = the saturation fraction of dissolved air in</span>
<span class="cm">%                        seawater</span>
<span class="cm">%  (i.e., saturation_fraction must be between 0 and 1, and the default</span>
<span class="cm">%    is 0, air free)</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  t_freezing = in-situ temperature at which seawater freezes.    [ deg C ]</span>
<span class="cm">%               (ITS-90)</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall, Paul Barker and Rainer Feistal    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See sections 3.33 and 3.34 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T.J., and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton&#39;s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_t_freezing</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">saturation_fraction</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa_r</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p_r</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">df_dt</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">,</span><span class="w"> </span><span class="n">tfm</span><span class="p">,</span><span class="w"> </span><span class="n">tf_old</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>

<span class="w">  </span><span class="n">sa_r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">sa_r</span><span class="p">);</span>
<span class="w">  </span><span class="n">p_r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">;</span>
<span class="w">  </span><span class="n">tf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t9</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t15</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t21</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_r</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t17</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t19</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_r</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t11</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t18</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gfpc</span><span class="p">.</span><span class="n">t16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_r</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gfpc</span><span class="p">.</span><span class="n">t22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_r</span><span class="p">)));</span>

<span class="w">  </span><span class="n">tf</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">saturation_fraction</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="p">));</span>
<span class="w">  </span><span class="n">df_dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_t_deriv_chem_potential_water_t_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">gsw_gibbs_ice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">tf_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tf</span><span class="p">;</span>
<span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_chem_potential_water_t_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">tf_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">gsw_gibbs_ice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">tf_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">tf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tf_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df_dt</span><span class="p">;</span>
<span class="w">  </span><span class="n">tfm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">tf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tf_old</span><span class="p">);</span>
<span class="w">  </span><span class="n">df_dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_t_deriv_chem_potential_water_t_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">tfm</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">gsw_gibbs_ice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">tfm</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">tf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tf_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df_dt</span><span class="p">;</span>
<span class="w">  </span><span class="n">tf_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tf</span><span class="p">;</span>
<span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_chem_potential_water_t_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">tf_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">gsw_gibbs_ice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">tf_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">tf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tf_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df_dt</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">tf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">saturation_fraction</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_t_from_ct           in-situ temperature from Conservative Temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_t_from_ct(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates in-situ temperature from the Conservative Temperature of</span>
<span class="cm">%  seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  t  =  in-situ temperature (ITS-90)                             [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%  This function is unchanged from version 2.0 (24th September, 2010).</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See sections 3.1 and 3.3 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">p0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">gsw_pt_from_t</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">p0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">% gsw_z_from_p                                         height from pressure</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_z_from_p(p,lat,geo_strf_dyn_height, sea_surface_geopotental)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates height from sea pressure using the computationally-efficient</span>
<span class="cm">%  75-term expression for specific volume in terms of SA, CT and p</span>
<span class="cm">%  (Roquet et al., 2015).  Dynamic height anomaly, geo_strf_dyn_height, if</span>
<span class="cm">%  provided, must be computed with its p_ref = 0 (the surface).  Also if</span>
<span class="cm">%  provided, sea_surface_geopotental is the geopotential at zero sea</span>
<span class="cm">%  pressure. This function solves Eqn.(3.32.3) of IOC et al. (2010).</span>
<span class="cm">%</span>
<span class="cm">%  Note. Height z is NEGATIVE in the ocean. i.e. Depth is -z.</span>
<span class="cm">%   Depth is not used in the GSW computer software library.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  p    =  sea pressure                                            [ dbar ]</span>
<span class="cm">%          ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lat  =  latitude in decimal degrees north                [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OPTIONAL:</span>
<span class="cm">%  geo_strf_dyn_height = dynamic height anomaly                 [ m^2/s^2 ]</span>
<span class="cm">%    Note that the refernce pressure, p_ref, of geo_strf_dyn_height must be</span>
<span class="cm">%    zero (0) dbar.</span>
<span class="cm">%  sea_surface_geopotental = geopotential at zero sea pressure  [ m^2/s^2 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  z  =  height                                                       [ m ]</span>
<span class="cm">%  Note. At sea level z = 0, and since z (HEIGHT) is defined to be</span>
<span class="cm">%    positive upwards, it follows that while z is positive in the</span>
<span class="cm">%    atmosphere, it is NEGATIVE in the ocean.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall, Claire Roberts-Thomson &amp; Paul Barker.</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Moritz, H., 2000: Geodetic reference system 1980. J. Geodesy, 74,</span>
<span class="cm">%   pp. 128-133.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_z_from_p</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">geo_strf_dyn_height</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sea_surface_geopotential</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sin2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>

<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">deg2rad</span><span class="p">);</span>
<span class="w">  </span><span class="n">sin2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9.780327</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">5.2792e-3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">2.32e-5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin2</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin2</span><span class="p">);</span>
<span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_enthalpy_sso_0</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">geo_strf_dyn_height</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">sea_surface_geopotential</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="mf">-2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/*************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_linear_interp_sa_ct_for_dh(*sa,*ct,*p,nz,*p_i,n_i,*sa_i,*ct_i)</span>
<span class="cm">=======</span>
<span class="cm">    Linearly interpolate to the grid made by define_grid_for_dh.</span>
<span class="cm">    We take advantage of what we know about the grids: they match</span>
<span class="cm">    at the end points, and both are monotonic.</span>
<span class="cm">**************************************************************************/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_linear_interp_sa_ct_for_dh</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">nz</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">p_i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n_i</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">sa_i</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct_i</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pfac</span><span class="p">;</span>

<span class="w">  </span><span class="n">sa_i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">  </span><span class="n">sa_i</span><span class="p">[</span><span class="n">n_i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">nz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">  </span><span class="n">ct_i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">  </span><span class="n">ct_i</span><span class="p">[</span><span class="n">n_i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">nz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">p_i</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nz</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">pfac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p_i</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="n">sa_i</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="n">ct_i</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_anom               specific volume anomaly (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_anom(SA,CT,p,SA_ref,CT_ref)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific volume anomaly from Absolute Salinity, Conservative</span>
<span class="cm">%  Temperature and pressure. It uses the computationally-efficient</span>
<span class="cm">%  expression for specific volume as a function of SA, CT and p (Roquet</span>
<span class="cm">%  et al., 2015).  If the Absolute Salinity and Conservative Temperature</span>
<span class="cm">%  reference value (SA_ref and CT_ref) are not defined then a default</span>
<span class="cm">%  reference value of Absolute Salinity is SSO and the reference value of</span>
<span class="cm">%  Conservative Temperature is equal to 0 degress C.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one|s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA     =  Absolute Salinity                                     [ g/kg ]</span>
<span class="cm">%  CT     =  Conservative Temperature (ITS-90)                    [ deg C ]</span>
<span class="cm">%  p      =  sea pressure                                          [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">% Optional:</span>
<span class="cm">%  SA_ref =  reference Absolute Salinity                           [ g/kg ]</span>
<span class="cm">%  CT_ref =  reference Conservative Temperature (ITS-90)          [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_anom  =  specific volume anomaly                      [ m^3/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (3.7.3) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_anom</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">SA_ref</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">CT_ref</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v010</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.5649734675e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v011</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.8505765429e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.1736386731e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v013</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.6527006553e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v014</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.1454099902e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v020</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.7762106484e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v021</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.1716606853e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v022</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.1305028740e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v023</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.8695905159e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v030</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.6521159259e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v031</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.9279656173e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v032</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.6132540037e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v040</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.9111322702e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v041</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.4102187482e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v042</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.3352916514e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v050</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-8.0539615540e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v051</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0736766814e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v060</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0543094268e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v100</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.1038981976e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v101</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.4262468747e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v102</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.8484432984e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v103</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.6310188515e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v104</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.1147125423e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v110</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.5009599764e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v111</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.5677088156e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v112</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.5699154557e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v113</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.7295696237e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v120</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.7435842344e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v121</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.3678308361e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v122</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.9137387080e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v130</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.4141479483e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v131</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.4558773655e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v132</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.7618888092e-9</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v140</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-8.7595873154e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v141</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.2956717783e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v150</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.3052758900e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v200</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.6928067038e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v201</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.4792460974e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v202</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.8122251597e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v203</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.6746303780e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v210</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.3592678561e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v211</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1100834765e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v212</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.4620748834e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v220</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.5907822760e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v221</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.9283346295e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v222</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.5731104067e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v230</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.4353633048e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v231</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.1655306078e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v240</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.3703680598e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v300</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-8.5047933937e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v301</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.7470777305e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v302</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.9263106998e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v310</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.4532461828e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v311</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.8447117844e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v312</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.3544185627e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v320</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.8698584187e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v321</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.8826139200e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v330</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.2863324556e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v400</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.8086069943e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v401</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.7322218612e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v402</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.7811974727e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v410</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.1959409788e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v411</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.5909225260e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v420</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.8595339244e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v500</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.1092370507e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v501</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.0927427253e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v510</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.3864594581e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v600</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.1932457305e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x2_ref</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_4_diff</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_0</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_1</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_2</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">,</span><span class="w"> </span><span class="n">ys_ref</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_0_ref</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_1_ref</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_2_ref</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_3_ref</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="p">;</span>

<span class="w">  </span><span class="n">x2_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SA_ref</span><span class="p">;</span>
<span class="w">  </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2_ref</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CT_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>

<span class="w">  </span><span class="n">xy_part_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v100</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v300</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v500</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">v600</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v010</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v210</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v310</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v410</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v510</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v020</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v120</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v220</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v320</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v420</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v030</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v230</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v330</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v040</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v140</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v240</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v050</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">v150</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v060</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">xy_part_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v401</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v501</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v111</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v311</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">v411</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v021</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v221</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">v321</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v231</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v041</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v141</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v051</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))));</span>

<span class="w">  </span><span class="n">xy_part_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v302</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v402</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v012</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v212</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v312</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v222</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v032</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">v132</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v042</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)));</span>

<span class="w">  </span><span class="n">xy_part_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v203</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v013</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v113</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v023</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">);</span>

<span class="w">  </span><span class="n">xy_part_0_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v300</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v500</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v600</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v010</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v210</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v310</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v410</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v510</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v020</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v120</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v220</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v320</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v420</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v030</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v230</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v330</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v040</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v140</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v240</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v050</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v150</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v060</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys_ref</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">xy_part_1_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v301</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v401</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v501</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v011</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v111</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v211</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v311</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v411</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v021</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v121</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v221</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v321</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v231</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v041</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v141</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v051</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys_ref</span><span class="p">))));</span>

<span class="w">  </span><span class="n">xy_part_2_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v302</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">v402</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v012</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v112</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v212</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v312</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v022</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v222</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v032</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">v132</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v042</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys_ref</span><span class="p">)));</span>

<span class="w">  </span><span class="n">xy_part_3_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v203</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys_ref</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">v013</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v113</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs_ref</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v023</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys_ref</span><span class="p">);</span>

<span class="w">  </span><span class="n">xy_part_4_diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v104</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">xs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xs_ref</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v014</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ys_ref</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">xy_part_0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xy_part_0_ref</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">xy_part_1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xy_part_1_ref</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">xy_part_2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xy_part_2_ref</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">xy_part_3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xy_part_3_ref</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">xy_part_4_diff</span><span class="p">))));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_z_from_depth                                    height, z, from depth</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_z_from_depth(depth)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates height, z, from depth.  Note that in general height is</span>
<span class="cm">%  negative in the ocean.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  depth  =  depth                                                    [ m ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  z  =  height                                                       [ m ]</span>
<span class="cm">%</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_z_from_depth</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">depth</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">depth</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_internal_energy_CT_exact         specific internal energy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_internal_energy_CT_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the specific internal energy of seawater from Absolute</span>
<span class="cm">%  Salinity, Conservative Temperature and pressure.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_internal_energy(SA,CT,p) which uses the computationally</span>
<span class="cm">%  efficient 75 term expression for specific volume in terms of SA, CT</span>
<span class="cm">%  and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  internal_energy_CT_exact  =  specific internal energy (u)       [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall                                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.11.1) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_internal_energy_CT_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_internal_energy_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_kappa_CT_exact                             isentropic compressibility</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_kappa_CT_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the isentropic compressibility of seawater.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely gsw_kappa(SA,CT,p),</span>
<span class="cm">%  which uses the computationally efficient 75-term expression for density</span>
<span class="cm">%  in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  kappa_CT_exact  =  isentropic compressibility                   [ 1/Pa ]</span>
<span class="cm">%   Note. The output units are 1/Pa not 1/dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqns. (2.16.1) and the row for kappa in Table P.1 of appendix P</span>
<span class="cm">%    of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_kappa_CT_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g_tt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g001</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g002</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">g_tp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_tp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">g_tt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g002</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">g001</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_tt</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_CT_exact                                      specific volume</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_CT_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific volume from Absolute Salinity, Conservative</span>
<span class="cm">%  Temperature and pressure.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely gsw_specvol(SA,CT,p),</span>
<span class="cm">%  which uses the computationally efficient 75-term expression for specific</span>
<span class="cm">%  volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature                                [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_CT_exact  =  specific volume                          [ m^3/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.7.2) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_CT_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_specvol_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_t90_from_t48              ITS-90 temperature from IPTS-48 temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_t90_from_t48(t48)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates IPTS-48 temperature to International Temperature Scale 1990</span>
<span class="cm">%  (ITS-90) temperature.  This conversion should be applied to all in-situ</span>
<span class="cm">%  data collected prior to 31/12/1967.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  t48  =  in-situ temperature  (IPTS-48)                         [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  t90  =  in-situ temperature  (ITS-90)                          [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  International Temperature Scales of 1948, 1968 and 1990, an ICES</span>
<span class="cm">%   note, available from http://www.ices.dk/ocean/procedures/its.htm</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_t90_from_t48</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">t48</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">t48</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4.4E-6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t48</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">100.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t48</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_dynamic_enthalpy_t_exact                  dyamic enthalpy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_dynamic_enthalpy_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the dynamic enthalpy of seawater from Absolute Salinity,</span>
<span class="cm">%  in situ temperature and pressure.  Dynamic enthalpy was defined by</span>
<span class="cm">%  Young (2010) as the difference between enthalpy and potential enthalpy.</span>
<span class="cm">%  Note that this function uses the full TEOS-10 Gibbs function (i.e. the</span>
<span class="cm">%  sum of the IAPWS-09 and IAPWS-08 Gibbs functions, see the TEOS-10</span>
<span class="cm">%  Manual, IOC et al. (2010)).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  dynamic_enthalpy_t_exact  =  dynamic enthalpy                   [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Young, W.R., 2010: Dynamic enthalpy, Conservative Temperature, and the</span>
<span class="cm">%   seawater Boussinesq approximation. Journal of Physical Oceanography,</span>
<span class="cm">%   40, 394-400.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_dynamic_enthalpy_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_ct_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_enthalpy_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">CT</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_pot_enthalpy_from_pt    potential enthalpy from potential temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_pot_enthalpy_from_pt(SA,pt)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the potential enthalpy of seawater from potential</span>
<span class="cm">%  temperature (whose reference sea pressure is zero dbar).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  pt  =  potential temperature (ITS-90)                          [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  pot_enthalpy  =  potential enthalpy                             [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.2 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pot_enthalpy_from_pt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pot_enthalpy</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span><span class="w">                                 </span><span class="c1">// normalize for F03 and F08</span>

<span class="w">  </span><span class="n">pot_enthalpy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">61.01362420681071</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">168776.46138048015</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2735.2785605119625</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2574.2164453821433</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1536.6644434977543</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">545.7340497931629</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-50.91091728474331</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">18.30489878927802</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">268.5520265845071</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-12019.028203559312</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3734.858026725145</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2046.7671145057618</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">465.28655623826234</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">-0.6370820302376359</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="mf">10.650848542359153</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">937.2099110620707</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">588.1802812170108</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">248.39476522971285</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">-3.871557904936333</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="mf">2.6268019854268356</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1687.914374187449</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">246.9598888781377</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">123.59576582457964</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">48.5891069025409</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">936.3206544460336</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-942.7827304544439</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">369.4389437509002</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-33.83664947895248</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">9.987880382780322</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))))));</span>

<span class="c1">//--------------------------------------------------------------------------</span>
<span class="c1">// The above polynomial for pot_enthalpy is the full expression for</span>
<span class="c1">// potential entahlpy in terms of SA and pt, obtained from the Gibbs</span>
<span class="c1">// function as below.  The above polynomial has simply collected like powers</span>
<span class="c1">// of x and y so that it is computationally faster than calling the Gibbs</span>
<span class="c1">// function twice as is done in the commented code below.  When this code</span>
<span class="c1">// below is run, the results are identical to the present function</span>
<span class="c1">// gsw_pot_enthalpy_from_pt, to machine precision.</span>
<span class="c1">//</span>
<span class="c1">//  pr0 = zeros(size(SA));</span>
<span class="c1">//  pot_enthalpy = gsw_gibbs(0,0,0,SA,pt,pr0) -</span>
<span class="c1">//                       (gsw_T0 + pt) *gsw_gibbs(0,1,0,SA,pt,pr0);</span>
<span class="c1">//</span>
<span class="c1">//-----------------This is the end of the alternative code------------------</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">pot_enthalpy</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_N2Osol_SP_pt                            solubility of N2O in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_N2Osol_SP_pt(SP,pt)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the nitrous oxide, N2O, concentration expected at equilibrium</span>
<span class="cm">%  with air at an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar)</span>
<span class="cm">%  including saturated water vapor  This function uses the solubility</span>
<span class="cm">%  coefficients as listed in Weiss and Price (1980).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP  =  Practical Salinity  (PSS-78)                         [ unitless ]</span>
<span class="cm">%  pt  =  potential temperature (ITS-90) referenced               [ deg C ]</span>
<span class="cm">%         to one standard atmosphere (0 dbar).</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  N2Osol = solubility of nitrous oxide                           [ mol/L ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Rich Pawlowicz, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Weiss, R.F., and B.A. Price, 1980: Nitrous oxide solubility in water and</span>
<span class="cm">%   seawater. Mar. Chem., 8, 347-359.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_N2Osol_SP_pt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">N2Osol_tmp</span><span class="p">,</span><span class="w"> </span><span class="n">pt68</span><span class="p">,</span><span class="w"> </span><span class="n">y_100</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_100</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.01</span><span class="p">;</span>
<span class="w">  </span><span class="n">N2Osol_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">y_100</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">((((</span><span class="mf">22287.43</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-165.8806</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="mf">92.0792</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N2Osol_tmp</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-1.48425</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y_100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                      </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y_100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-0.0048472</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.031619</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-0.056235</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="w">         </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">exp</span><span class="p">(((</span><span class="mf">24.4543</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">6745.09</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">))</span><span class="w"> </span><span class="o">-</span>
<span class="w">         </span><span class="mf">4.8489</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N2Osol_tmp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.000544</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SP</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_t_maxdensity_exact                     in-situ temperature of maximum</span>
<span class="cm">%                                                       density of seawater</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_t_maxdensity_exact(SA,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the in-situ temperature of maximum density of seawater.</span>
<span class="cm">%  This function returns the in-situ temperature at which the density</span>
<span class="cm">%  of seawater is a maximum, at given Absolute Salinity, SA, and sea</span>
<span class="cm">%  pressure, p (in dbar).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  t_maxdensity_exact  =  in-situ temperature at which            [ deg C ]</span>
<span class="cm">%                         the density of seawater is a maximum for</span>
<span class="cm">%                         given Absolute Salinity and pressure.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall &amp; Paul Barker                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.42 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton|s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_t_maxdensity_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t_old</span><span class="p">,</span><span class="w"> </span><span class="n">gibbs_PT</span><span class="p">,</span><span class="w"> </span><span class="n">t_mean</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.001</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.978</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mf">0.22072</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SA</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">gibbs_PTT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1e-8</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">itnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">itnum</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">itnum</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">t_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">    </span><span class="n">gibbs_PT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gibbs_PT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gibbs_PTT</span><span class="p">;</span>
<span class="w">    </span><span class="n">t_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t_old</span><span class="p">);</span>

<span class="w">    </span><span class="n">gibbs_PTT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t_mean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="n">gibbs_PTT</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t_mean</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="n">gibbs_PTT</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="p">;</span>

<span class="w">    </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gibbs_PT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gibbs_PTT</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Nsquared_lowerlimit             specified profile of minimum buoyancy</span>
<span class="cm">%                                                         frequency squared</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_Nsquared_lowerlimit(p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the minimum Nsquared such that a cast is stable.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon =  longitude in decimal degrees                      [ 0 +360 ]</span>
<span class="cm">%                                                     or  [ -180 +180 ]</span>
<span class="cm">%  lat  =  latitude in decimal degrees north                [ -90 +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Nsquared_lowerlimit = Minimum Brunt-Vaisala Frequency squared  [ 1/s^2 ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Barker, P.M., and T.J. McDougall, 2017: Stabilizing hydrographic</span>
<span class="cm">%   profiles with minimal change to the water masses. J. Atmosph. Ocean.</span>
<span class="cm">%   Tech., pp. 1935 - 1945, http://dx.doi.org/10.1175/JTECH-D-16-0111.1</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.18.3) of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Nsquared_lowerlimit</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">b_long</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">-1.5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtNaN</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mf">0.75</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.25</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0E-7</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Krsol_SP_pt                              solubility of Kr in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_Krsol_SP_pt(SP,pt)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the krypton, Kr, concentration expected at equilibrium with</span>
<span class="cm">%  air at an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar)</span>
<span class="cm">%  including saturated water vapor.  This function uses the solubility</span>
<span class="cm">%  coefficients derived from the data of Weiss (1971).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP  =  Practical Salinity  (PSS-78)                         [ unitless ]</span>
<span class="cm">%  pt  =  potential temperature (ITS-90) referenced               [ deg C ]</span>
<span class="cm">%         to one standard atmosphere (0 dbar).</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Krsol = solubility of krypton in micro-moles per kg          [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Weiss, R.F. and T.K. Kyser, 1978: Solubility of Krypton in Water and</span>
<span class="cm">%   Seawater. J. Chem. Thermodynamics, 23, 69-72.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Krsol_SP_pt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt68</span><span class="p">,</span><span class="w"> </span><span class="n">y_100</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_100</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.01</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">((((</span><span class="mf">15358.170000000002</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-112.684</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="mf">74.469</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">y_100</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-10.0189</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span>
<span class="w">           </span><span class="p">(</span><span class="n">y_100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0011201</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-0.001844</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="mf">-0.011213</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">44.7405273118549</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_osmotic_pressure_t_exact                             osmotic pressure</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_osmotic_pressure_t_exact(SA,t,pw)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the osmotic pressure of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  pw  =  sea pressure of the pure water side                      [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  osmotic_pressure_t_exact  =  osmotic pressure of seawater       [ dbar ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.41 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T.J. and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton|s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_osmotic_pressure_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pw</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p_mean</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">p_old</span><span class="p">,</span><span class="w"> </span><span class="n">rec_g2kg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e3</span><span class="p">,</span><span class="w"> </span><span class="n">df_dp</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">gibbs_pure_water</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">gibbs_pure_water</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">pw</span><span class="p">);</span>

<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">235.4684</span><span class="p">;</span><span class="w">              </span><span class="c1">//% Initial guess of p, in dbar</span>

<span class="w">  </span><span class="n">df_dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">));</span><span class="w">                 </span><span class="c1">//% Inital guess of df/dp</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">p_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gibbs_pure_water</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rec_g2kg</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_chem_potential_water_t_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p_old</span><span class="p">);</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df_dp</span><span class="p">;</span><span class="w">             </span><span class="c1">//% this is half way through the modified N-R method</span>
<span class="w">    </span><span class="n">p_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p_old</span><span class="p">);</span>

<span class="w">    </span><span class="n">df_dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p_mean</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">      </span><span class="n">sa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p_mean</span><span class="p">));</span>

<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">df_dp</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//% After two iterations though the modified Newton-Raphson technique</span>
<span class="w">        </span><span class="c1">//% (McDougall and Wotherspoon, 2013) the maximum error is 6x10^-12 dbar.</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pw</span><span class="p">;</span><span class="w">       </span><span class="c1">//% osmotic pressure of seawater, in dbar.</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_alpha_CT_exact                          thermal expansion coefficient</span>
<span class="cm">%                                  with respect to Conservative Temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_alpha_CT_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the thermal expansion coefficient of seawater with respect to</span>
<span class="cm">%  Conservative Temperature from Absolute Salinity and Conservative</span>
<span class="cm">%  Temperature.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely gsw_alpha(SA,CT,p)</span>
<span class="cm">%  which uses the computationally efficient 75-term expression for specific</span>
<span class="cm">%  volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  alpha_CT_exact  =  thermal expansion coefficient                 [ 1/K ]</span>
<span class="cm">%                     with respect to Conservative Temperature</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.18.3) of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_alpha_CT_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_alpha_wrt_CT_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_second_derivatives_CT_exact             second derivatives of</span>
<span class="cm">%                                                           specific volume</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_second_derivatives_CT_exact(SA,CT,p, *v_SA_SA,</span>
<span class="cm">                                                           *v_SA_CT,</span>
<span class="cm">                                                           *v_CT_CT,</span>
<span class="cm">                                                           *v_SA_P,</span>
<span class="cm">                                                           *v_CT_P)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following five second-order derivatives of specific</span>
<span class="cm">%  volume (v),</span>
<span class="cm">%   (1) v_SA_SA, second-order derivative with respect to Absolute Salinity</span>
<span class="cm">%       at constant CT &amp; p.</span>
<span class="cm">%   (2) v_SA_CT, second-order derivative with respect to SA &amp; CT at</span>
<span class="cm">%       constant p.</span>
<span class="cm">%   (3) v_CT_CT, second-order derivative with respect to CT at constant SA</span>
<span class="cm">%       and p.</span>
<span class="cm">%   (4) v_SA_P, second-order derivative with respect to SA &amp; P at</span>
<span class="cm">%       constant CT.</span>
<span class="cm">%   (5) v_CT_P, second-order derivative with respect to CT &amp; P at</span>
<span class="cm">%       constant SA.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_specvol_second_derivatives(SA,CT,p) which uses the computationally</span>
<span class="cm">%  efficient 75 term expression for specific volume in terms of SA, CT</span>
<span class="cm">%  and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  v_SA_SA  =  The second derivative of specific volume with respect to</span>
<span class="cm">%              Absolute Salinity at constant CT &amp; p.  [ (m^3/kg)(g/kg)^-2 ]</span>
<span class="cm">%  v_SA_CT  =  The second derivative of specific volume with respect to</span>
<span class="cm">%              SA and CT at constant p.           [ (m^3/kg)(g/kg)^-1 K^-1]</span>
<span class="cm">%  v_CT_CT  =  The second derivative of specific volume with respect to</span>
<span class="cm">%              CT at constant SA and p.                  [ (m^3/kg) K^-2) ]</span>
<span class="cm">%  v_SA_P  =  The second derivative of specific volume with respect to</span>
<span class="cm">%              SA and P at constant CT.                  [ (m^3/kg) Pa^-1 ]</span>
<span class="cm">%  v_CT_P  =  The second derivative of specific volume with respect to</span>
<span class="cm">%              CT and P at constant SA.             [ (m^3/kg) K^-1 Pa^-1 ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_second_derivatives_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_SA_SA</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_SA_CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_CT_CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_SA_P</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_CT_P</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rec_gTT_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">rec_gTT2</span><span class="p">,</span><span class="w"> </span><span class="n">rec_gTT</span><span class="p">,</span><span class="w"> </span><span class="n">gamma</span><span class="p">,</span><span class="w"> </span><span class="n">rec_cp0</span><span class="p">,</span><span class="w"> </span><span class="n">cp0_div_abs_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">gTTP</span><span class="p">,</span><span class="w"> </span><span class="n">gTTT</span><span class="p">,</span><span class="w"> </span><span class="n">gSAT</span><span class="p">,</span><span class="w"> </span><span class="n">gSATP</span><span class="p">,</span><span class="w"> </span><span class="n">gSATT</span><span class="p">,</span><span class="w"> </span><span class="n">gSAT_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">gSA_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">gSASA_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">gSASAP</span><span class="p">,</span><span class="w"> </span><span class="n">gSASAT</span><span class="p">,</span><span class="w"> </span><span class="n">gSAPP</span><span class="p">,</span><span class="w"> </span><span class="n">gTPP</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">part_a</span><span class="p">,</span><span class="w"> </span><span class="n">part_b</span><span class="p">,</span><span class="w"> </span><span class="n">part_c</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">rec_cp0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="p">;</span><span class="w">       </span><span class="c1">// from Eqn. 3.3.3 of IOC et al. (2010).</span>
<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">);</span>
<span class="w">  </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">);</span>
<span class="w">  </span><span class="n">cp0_div_abs_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="p">;</span>
<span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_t</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">gamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">rec_gTT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">rec_gTT2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rec_gTT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT</span><span class="p">;</span>
<span class="w">  </span><span class="n">rec_gTT_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>

<span class="w">  </span><span class="n">gTTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gTTT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSATP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSATT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSAT_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSA_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSASA_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSASAP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSASAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSAPP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gTPP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">part_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gTTP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gTTT</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT2</span><span class="p">;</span>
<span class="w">  </span><span class="n">part_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gSATP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSATT</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT</span><span class="p">;</span>
<span class="w">  </span><span class="n">part_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gTPP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gTTP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gTTT</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_CT_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">cp0_div_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cp0_div_abs_pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT_pt0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">part_a</span><span class="p">);</span>

<span class="w">  </span><span class="n">v_SA_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cp0_div_abs_pt0</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSAT_pt0</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="n">rec_gTT_pt0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">part_b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gSAT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part_a</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">gSA_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v_CT_CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_cp0</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_SA_SA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gSASAP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSASAT</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSASA_pt0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gSAT_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSAT_pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT_pt0</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSAT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part_b</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gSAT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSAT</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part_a</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSA_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v_SA_CT</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gSA_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSA_pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">rec_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_cp0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v_CT_CT</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_CT_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">cp0_div_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part_c</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_SA_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gSAPP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSATP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSATT</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">part_c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gSA_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gSAT</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_anom_standard_t_exact                 specific volume anomaly</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_anom_standard_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific volume anomaly from Absolute Salinity, in-situ</span>
<span class="cm">%  temperature and pressure, using the full TEOS-10 Gibbs function.  The</span>
<span class="cm">%  reference value of Absolute Salinity is SSO and the temperature of the</span>
<span class="cm">%  reference value is equal to a Conservative Temperature of 0 degrees C.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_anom_t_exact  =  specific volume anomaly              [ m^3/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (3.7.3) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_anom_standard_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">CT0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pr0</span><span class="p">,</span><span class="w"> </span><span class="n">t_zero</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">t_zero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="p">,</span><span class="w"> </span><span class="n">CT0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">         </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="p">,</span><span class="w"> </span><span class="n">t_zero</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_R_from_SP                                  conductivity ratio from SP</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_R_from_SP(SP,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates conductivity ratio from (SP,t,p) using PSS-78 in the range</span>
<span class="cm">%  2 &lt; SP &lt; 42.  If the input Practical Salinity is less than 2 then a</span>
<span class="cm">%  modified form of the Hill et al. (1986) fomula is used for Practical</span>
<span class="cm">%  Salinity.  The modification of the Hill et al. (1986) expression is to</span>
<span class="cm">%  ensure that it is exactly consistent with PSS-78 at SP = 2.</span>
<span class="cm">%</span>
<span class="cm">%  The conductivity ratio returned by this function is consistent with the</span>
<span class="cm">%  input value of Practical Salinity, SP, to 2x10^-14 psu over the full</span>
<span class="cm">%  range of input parameters (from pure fresh water up to SP = 42 psu).</span>
<span class="cm">%  This error of 2x10^-14 psu is machine precision at typical seawater</span>
<span class="cm">%  salinities.  This accuracy is achieved by having four different</span>
<span class="cm">%  polynomials for the starting value of Rtx (the square root of Rt) in</span>
<span class="cm">%  four different ranges of SP, and by using one and a half iterations of</span>
<span class="cm">%  a computationally efficient modified Newton-Raphson technique</span>
<span class="cm">%  (McDougall and Wotherspoon, 2013) to find the root of the equation.</span>
<span class="cm">%</span>
<span class="cm">%  Note that strictly speaking PSS-78 (Unesco, 1983) defines Practical</span>
<span class="cm">%  Salinity in terms of the conductivity ratio, R, without actually</span>
<span class="cm">%  specifying the value of C(35,15,0) (which we currently take to be</span>
<span class="cm">%  42.9140 mS cm^-1 (Culkin and Smith, 1980)).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP  =  Practical Salinity  (PSS-78)                         [ unitless ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  R  =  conductivity ratio                                    [ unitless ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall, Paul Barker and Rich Pawlowicz    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Culkin and Smith, 1980:  Determination of the Concentration of Potassium</span>
<span class="cm">%   Chloride Solution Having the Same Electrical Conductivity, at 15C and</span>
<span class="cm">%   Infinite Frequency, as Standard Seawater of Salinity 35.0000</span>
<span class="cm">%   (Chlorinity 19.37394), IEEE J. Oceanic Eng, 5, 22-23.</span>
<span class="cm">%</span>
<span class="cm">%  Hill, K.D., T.M. Dauphinee &amp; D.J. Woods, 1986: The extension of the</span>
<span class="cm">%   Practical Salinity Scale 1978 to low salinities. IEEE J. Oceanic Eng.,</span>
<span class="cm">%   11, 109 - 112.</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix E of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T.J., and S.J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton|s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  Unesco, 1983: Algorithms for computation of fundamental properties of</span>
<span class="cm">%   seawater. Unesco Technical Papers in Marine Science, 44, 53 pp.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_R_from_SP</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.577801212923119e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.924049429136640e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.183871685127932e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.292156330457999e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.568129536470258e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.478995271680869e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9.086442524716395e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.949560839540487e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.223058111118377e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.175871639741131e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.522895856600089e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.254458513439107e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.179992190192848e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.005054226996868e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.923745566122602e-9</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.259550611212616e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.631749165091437e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.931857989915256e-9</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.693392029005252e-9</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.571854839274148e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.198786822861038e-12</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.540896868127855e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.015419291097848e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.445310045430192e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.567047628411722e-2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.464756294660119e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.575458304732166e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.071449842454419e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.081985795339206e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.635420818812898e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.249490528450555e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.143810377431888e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.066112484281530e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.482907137737503e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.019321577844724e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.755568141370501e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.120748754429459e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.420274029674485e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.774829347564670e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.279037686797859e-9</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.045829202713288e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">q20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.025109163112005e-12</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.432285006604888e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.672940491817403e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.640304401023995e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.082267090441036e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.296778883666940e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.542775152303671e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.859711038699727e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.659006320303959e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.794661268817618e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.093368602891911e-9</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.001140606840692e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.038712945546608e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.227915160991074e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.798564479737090e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.343623657549961e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.024345179842964e-2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.981135430579384e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.466087528793912e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.960872795577774e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.723159418888634e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.122200786423241e-12</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.180529787390576e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.052097167201052e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.666193708310848e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.112223828976632</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.631366777096209e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.336295318742821e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.576886793288888e+2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.840239113483083e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.624279120240952e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.233529799729501e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.826482800939545e+3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.633903983457674e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.201096427222349e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.187900959754842e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.442010369809705e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-8.542357182595853e+3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.408635241899082</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.660164829963661e-4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.797409608973845e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.345074990451475e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">u20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.285687652694768e-13</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">Rtx_old</span><span class="p">,</span><span class="w"> </span><span class="n">SP_Hill_raw</span><span class="p">,</span><span class="w"> </span><span class="n">SP_est</span><span class="p">,</span><span class="w"> </span><span class="n">Hill_ratio</span><span class="p">,</span><span class="w"> </span><span class="n">part1</span><span class="p">,</span><span class="w"> </span><span class="n">part2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">Ra</span><span class="p">,</span><span class="w"> </span><span class="n">rt_lc</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">,</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">Rt</span><span class="p">,</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">,</span><span class="w"> </span><span class="n">sqrty</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">dSP_dRtx</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">ft68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.0</span><span class="p">));</span>

<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">SP</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">        </span><span class="c1">// Finding the starting value of Rtx, the square root of Rt, using four</span>
<span class="w">        </span><span class="c1">// different polynomials of SP and t68.</span>
<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p11</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p15</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p5</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p17</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p9</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p18</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p19</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">))));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q11</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">q15</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q5</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">q17</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q9</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">q18</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">q14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q19</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">))));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.25</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r11</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r15</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r5</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r17</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r9</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r18</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">r14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r19</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">))));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.003</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u11</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u15</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u5</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u17</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u9</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u18</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">u14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u19</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u20</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">))));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">        </span><span class="c1">// Finding the starting value of dSP_dRtx, the derivative of SP with respect</span>
<span class="w">        </span><span class="c1">// to Rtx.</span>
<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>

<span class="w">  </span><span class="n">dSP_dRtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">400.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">Rtx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">);</span>
<span class="w">    </span><span class="n">sqrty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">;</span>
<span class="w">    </span><span class="n">part1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">part2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="p">));</span>
<span class="w">    </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_hill_ratio_at_sp2</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>

<span class="w">    </span><span class="n">dSP_dRtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dSP_dRtx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">800.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">part1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="p">(</span><span class="mf">10.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">20.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">30.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sqrty</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">part2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part2</span><span class="p">);</span>

<span class="w">    </span><span class="n">dSP_dRtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dSP_dRtx</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">        </span><span class="c1">// One iteration through the modified Newton-Raphson method achieves an</span>
<span class="w">        </span><span class="c1">// error in Practical Salinity of about 10^-12 for all combinations of the</span>
<span class="w">        </span><span class="c1">// inputs.  One and a half iterations of the modified Newton-Raphson method</span>
<span class="w">        </span><span class="c1">// achevies a maximum error in terms of Practical Salinity of better than</span>
<span class="w">        </span><span class="c1">// 2x10^-14 everywhere.</span>
<span class="w">        </span><span class="c1">//</span>
<span class="w">        </span><span class="c1">// We recommend one and a half iterations of the modified Newton-Raphson</span>
<span class="w">        </span><span class="c1">// method.</span>
<span class="w">        </span><span class="c1">//</span>
<span class="w">        </span><span class="c1">// Begin the modified Newton-Raphson method.</span>
<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>

<span class="w">  </span><span class="n">SP_est</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP_est</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">400.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">Rtx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">);</span>
<span class="w">    </span><span class="n">sqrty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">;</span>
<span class="w">    </span><span class="n">part1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">part2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="p">));</span>
<span class="w">    </span><span class="n">SP_Hill_raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SP_est</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ft68</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part2</span><span class="p">;</span>

<span class="w">    </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_hill_ratio_at_sp2</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>

<span class="w">    </span><span class="n">SP_est</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SP_Hill_raw</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Rtx_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rtx</span><span class="p">;</span>
<span class="w">  </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rtx_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">SP_est</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SP</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dSP_dRtx</span><span class="p">;</span>
<span class="w">  </span><span class="n">Rtxm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">Rtx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Rtx_old</span><span class="p">);</span>
<span class="w">   </span><span class="c1">// This mean value of Rtx, Rtxm, is the</span>
<span class="w">        </span><span class="c1">//  value of Rtx at which the derivative dSP_dRtx is evaluated.</span>

<span class="w">  </span><span class="n">dSP_dRtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP_est</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">400</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">Rtxm</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">);</span>
<span class="w">    </span><span class="n">sqrty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="p">;</span>
<span class="w">    </span><span class="n">part1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">part2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="p">));</span>

<span class="w">    </span><span class="n">dSP_dRtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dSP_dRtx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">800.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtxm</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">part1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="p">(</span><span class="mf">10.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">20.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">30.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sqrty</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">part2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part2</span><span class="p">);</span>

<span class="w">    </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_hill_ratio_at_sp2</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>

<span class="w">    </span><span class="n">dSP_dRtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dSP_dRtx</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">        </span><span class="c1">// The line below is where Rtx is updated at the end of the one full</span>
<span class="w">        </span><span class="c1">// iteration of the modified Newton-Raphson technique.</span>
<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">  </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rtx_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">SP_est</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SP</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dSP_dRtx</span><span class="p">;</span>
<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">        </span><span class="c1">// Now we do another half iteration of the modified Newton-Raphson</span>
<span class="w">        </span><span class="c1">// technique, making a total of one and a half modified N-R iterations.</span>
<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">  </span><span class="n">SP_est</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP_est</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">400.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">Rtx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">);</span>
<span class="w">    </span><span class="n">sqrty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">;</span>
<span class="w">    </span><span class="n">part1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">part2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="p">));</span>
<span class="w">    </span><span class="n">SP_Hill_raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SP_est</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ft68</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part2</span><span class="p">;</span>

<span class="w">    </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_hill_ratio_at_sp2</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>

<span class="w">    </span><span class="n">SP_est</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SP_Hill_raw</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rtx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">SP_est</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SP</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dSP_dRtx</span><span class="p">;</span>

<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">        </span><span class="c1">// The following lines of code are commented out, but when activated, return</span>
<span class="w">        </span><span class="c1">// the error, SP_error, in Rtx (in terms of psu).</span>
<span class="w">        </span><span class="c1">// SP_est = a0 + (a1 + (a2 + (a3 + (a4 + a5 *Rtx) *Rtx) *Rtx) *Rtx) *Rtx</span>
<span class="w">        </span><span class="c1">//     + ft68 *(b0 + (b1 + (b2+ (b3 + (b4 + b5 *Rtx) *Rtx) *Rtx) *Rtx) *Rtx);</span>
<span class="w">        </span><span class="c1">// if any(SP_est &lt; 2)</span>
<span class="w">        </span><span class="c1">//     [I2] = find(SP_est &lt; 2);</span>
<span class="w">        </span><span class="c1">//     x = 400 *(Rtx *Rtx);</span>
<span class="w">        </span><span class="c1">//     sqrty = 10 *Rtx;</span>
<span class="w">        </span><span class="c1">//     part1 = 1 + x *(1.5 + x) ;</span>
<span class="w">        </span><span class="c1">//     part2 = 1 + sqrty *(1 + sqrty *(1 + sqrty));</span>
<span class="w">        </span><span class="c1">//     SP_Hill_raw = SP_est - a0 /part1 - b0 *ft68 /part2;</span>
<span class="w">        </span><span class="c1">//     Hill_ratio = gsw_Hill_ratio_at_SP2(t);</span>
<span class="w">        </span><span class="c1">//     SP_est = Hill_ratio *SP_Hill_raw;</span>
<span class="w">        </span><span class="c1">// end</span>
<span class="w">        </span><span class="c1">//</span>
<span class="w">        </span><span class="c1">// SP_error = abs(SP - SP_est);</span>
<span class="w">        </span><span class="c1">//</span>
<span class="w">        </span><span class="c1">//--------------This is the end of the error testing------------------------</span>


<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">        </span><span class="c1">// Now go from Rtx to Rt and then to the conductivity ratio R at pressure p.</span>
<span class="w">        </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">  </span><span class="n">Rt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rtx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">;</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">d3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">d4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">;</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">d1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">d2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">);</span>
<span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">e1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">e2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">));</span>
<span class="w">        </span><span class="c1">// rt_lc (i.e. rt_lower_case) corresponds to rt as defined in</span>
<span class="w">        </span><span class="c1">// the UNESCO 44 (1983) routines.</span>
<span class="w">  </span><span class="n">rt_lc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">c0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c1</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c2</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">c4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">;</span>

<span class="w">  </span><span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rt_lc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rt</span><span class="p">;</span>
<span class="w">  </span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rt_lc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span><span class="p">);</span>
<span class="w">  </span><span class="n">Ra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">((</span><span class="n">D</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">D</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">E</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">D</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Ra</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">A</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_beta_const_ct_t_exact                  saline contraction coefficient</span>
<span class="cm">%                                      at constant Conservative temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_beta_const_CT_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the saline (i.e. haline) contraction coefficient of seawater</span>
<span class="cm">%  at constant Conservative Temperature.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar)</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  beta_const_CT_t_exact  =  saline contraction coefficient        [ kg/g ]</span>
<span class="cm">%                            at constant Conservative Temperature</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.19.3) of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_beta_const_ct_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g_SA_mod</span><span class="p">,</span><span class="w"> </span><span class="n">g_SA_T_mod</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y_pt</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="p">,</span><span class="w"> </span><span class="n">factor</span><span class="p">,</span><span class="w"> </span><span class="n">factora</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt0_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SA</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pt0</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w">       </span><span class="c1">//Note.The input pressure (p) is sea pressure in units of dbar.</span>

<span class="w">  </span><span class="n">g_SA_T_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1458.233059470092</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">249.375342232496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-63.313928772146</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">14.09317606630898</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-980.14153344888</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-548.4580073635929</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">592.4012338275047</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2361238716608</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-258.3988055868252</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">2298.348396014856</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-325.1503575102672</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">153.8390924339484</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-90.2046337756875</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4142.8793862113125</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">10.50720794170734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2814.78225133626</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3520.125411988816</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1351.605895580406</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">731.4083582010072</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-216.60324087531103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">25.56203650166196</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2381.829935897496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">597.809129110048</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">291.8983352012704</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4165.4688847996085</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-1229.337851789418</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">681.370187043564</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">66.7696405958478</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3443.057215135908</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1349.638121077468</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-713.258224830552</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">176.8161433232</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">31.68006188846728</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="n">g_SA_T_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_SA_T_mod</span><span class="p">;</span>

<span class="w">  </span><span class="n">g_SA_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8645.36753595126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.626801985426835</span><span class="w"> </span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-450.535298526802</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">182.8520895502518</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-43.3206481750622</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.26033941694366</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">g_SA_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_SA_mod</span><span class="p">;</span>

<span class="w">  </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">factora</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_SA_T_mod</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">g_SA_mod</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">);</span>

<span class="w">  </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factora</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gp</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_alpha_beta_CT_exact        specific volume, thermal expansion</span>
<span class="cm">%                                          &amp; saline contraction coefficient</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_alpha_beta_CT_exact(SA,CT,p, *specvol_CT_exact,</span>
<span class="cm">                                                   *alpha_CT_exact,</span>
<span class="cm">                                                   *beta_CT_exact)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific volume, the appropiate thermal expansion coefficient</span>
<span class="cm">%  and the appropriate saline contraction coefficient of seawater from</span>
<span class="cm">%  Absolute Salinity and Conservative Temperature.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_specvol_alpha_beta(SA,CT,p), which uses the computationally</span>
<span class="cm">%  efficient 75-term expression for density in terms of SA, CT and p</span>
<span class="cm">%  (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_CT_exact =  specific volume                             [ m/kg ]</span>
<span class="cm">%  alpha_CT_exact   =  thermal expansion coefficient                [ 1/K ]</span>
<span class="cm">%                      with respect to Conservative Temperature</span>
<span class="cm">%  beta_CT_exact    =  saline (i.e. haline) contraction            [ kg/g ]</span>
<span class="cm">%                      coefficient at constant Conservative Temperature</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_alpha_beta_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">specvol_CT_exact</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">alpha_CT_exact</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">beta_CT_exact</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">specvol_CT_exact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_specvol_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">alpha_CT_exact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_alpha_wrt_CT_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">beta_CT_exact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_beta_const_ct_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_alpha_on_beta_CT_exact                                     alpha/beta</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_alpha_on_beta_CT_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates alpha divided by beta, where alpha is the thermal expansion</span>
<span class="cm">%  coefficient and beta is the saline contraction coefficient of seawater</span>
<span class="cm">%  from Absolute Salinity and Conservative Temperature.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely gsw_alpha_on_beta(SA,CT,p),</span>
<span class="cm">%  which uses the computationally efficient 75-term expression for specific</span>
<span class="cm">%  volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  alpha_on_beta_CT_exact  =  thermal expansion coefficient with respect to</span>
<span class="cm">%                             Conservative Temperature divided by the</span>
<span class="cm">%                             saline contraction coefficient at constant</span>
<span class="cm">%                             Conservative Temperature     [ kg g^-1 K^-1 ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_alpha_on_beta_CT_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">dummy</span><span class="p">,</span><span class="w"> </span><span class="n">alpha_CT_exact</span><span class="p">,</span><span class="w"> </span><span class="n">beta_CT_exact</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">gsw_specvol_alpha_beta_CT_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">                                                                                          </span><span class="n">dummy</span><span class="p">,</span>
<span class="w">                                                                                          </span><span class="n">alpha_CT_exact</span><span class="p">,</span>
<span class="w">                                                                                          </span><span class="n">beta_CT_exact</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">alpha_CT_exact</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">beta_CT_exact</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_f                                              Coriolis parameter (f)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_f(lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Coriolis parameter (f) defined by:</span>
<span class="cm">%       f = 2*omega*sin(lat)</span>
<span class="cm">%  where,</span>
<span class="cm">%       omega = 7.292115e-5   (Groten, 2004)                  [ radians/s ]</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  lat  =  latitude in decimal degrees North                [ -90 +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  f    =  Coriolis parameter                                 [ radians/s ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  20th April 1993. Phil Morgan                        [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% MODIFIED:</span>
<span class="cm">%  28th July, 2010 by Paul Barker</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCE:</span>
<span class="cm">%  Groten, E., 2004: Fundamental Parameters and Current (2004) Best</span>
<span class="cm">%   Estimates of the Parameters of Common Relevance to Astronomy, Geodesy,</span>
<span class="cm">%   and Geodynamics. Journal of Geodesy, 77, pp. 724-797.</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_f</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">0.0001458423</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.017453292519943295</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_rho_alpha_beta_indexed    in-situ density, thermal expansion &amp; saline</span>
<span class="cm">%                                contraction coefficient (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_rho_alpha_beta_indexed(SA,CT,p,double &amp;rho,</span>
<span class="cm">                                double &amp;alpha, double &amp;beta)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates in-situ density, the appropiate thermal expansion coefficient</span>
<span class="cm">%  and the appropriate saline contraction coefficient of seawater from</span>
<span class="cm">%  Absolute Salinity and Conservative Temperature.  This function uses the</span>
<span class="cm">%  computationally-efficient expression for specific volume in terms of</span>
<span class="cm">%  SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that potential density (pot_rho) with respect to reference pressure</span>
<span class="cm">%  p_ref is obtained by calling this function with the pressure argument</span>
<span class="cm">%  being p_ref as in [pot_rho, ~, ~] = gsw_rho_alpha_beta(SA,CT,p_ref).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one&#39;s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  rho    =  in-situ density                                       [ kg/m ]</span>
<span class="cm">%  alpha  =  thermal expansion coefficient                          [ 1/K ]</span>
<span class="cm">%            with respect to Conservative Temperature</span>
<span class="cm">%  beta   =  saline (i.e. haline) contraction                      [ kg/g ]</span>
<span class="cm">%            coefficient at constant Conservative Temperature</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rho_alpha_beta_indexed</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">beta</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v_SA_part</span><span class="p">,</span><span class="w"> </span><span class="n">v_CT</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/* gsvco */</span>
<span class="w">  </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v300</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v500</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v600</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v010</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v210</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v310</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v410</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v510</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v020</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v120</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v220</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v320</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v420</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v030</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v230</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v330</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v040</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v140</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v240</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v050</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v150</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v060</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v001</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v101</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v401</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v501</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v111</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v311</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v411</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v021</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v221</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v321</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v231</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v041</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v141</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v051</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v002</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v302</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v402</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v012</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v212</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v312</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v122</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v222</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v032</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v132</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v042</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v103</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v203</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v013</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v113</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v023</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v004</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v104</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v014</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v005</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v006</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">rho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a300</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a500</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a010</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a210</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a310</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a410</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a020</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a120</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a220</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a320</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a030</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a230</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a040</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a140</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a050</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a001</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a401</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a111</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a311</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a021</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a221</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a131</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a041</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a002</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a302</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a012</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a212</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a122</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a103</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a013</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a004</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)));</span>

<span class="w">  </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v_CT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v</span><span class="p">);</span>

<span class="w">  </span><span class="n">v_SA_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b300</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b500</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b010</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b110</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b210</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b310</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b410</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b020</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b120</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b220</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b320</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b030</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b230</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b040</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b140</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b050</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b001</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b401</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b111</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b311</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b021</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b221</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b131</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b041</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b002</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b302</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b012</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b212</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b122</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b103</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b013</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b004</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)));</span>

<span class="w">  </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">v_SA_part</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_rho_first_derivatives_CT_exact       SA, CT and p partial derivatives</span>
<span class="cm">%                                                                of density</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_rho_first_derivatives_CT_exact(SA,CT,p,</span>
<span class="cm">                                             *rho_SA,</span>
<span class="cm">                                             *rho_CT,</span>
<span class="cm">                                             *rho_P)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the three (3) partial derivatives of in-situ density with</span>
<span class="cm">%  respect to Absolute Salinity, Conservative Temperature and pressure.</span>
<span class="cm">%  Note that the pressure derivative is done with respect to pressure in</span>
<span class="cm">%  Pa, not dbar.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_rho_first_derivatives(SA,CT,p), which uses the computationally</span>
<span class="cm">%  efficient 75-term expression for specific volume in terms of SA, CT and</span>
<span class="cm">%  p (Roquet et al., 2015)</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  rho_SA  =  partial derivative of density           [ (kg/m^3)(g/kg)^-1 ]</span>
<span class="cm">%                 with respect to Absolute Salinity</span>
<span class="cm">%  rho_CT  =  partial derivative of density                  [ kg/(m^3 K) ]</span>
<span class="cm">%                 with respect to Conservative Temperature</span>
<span class="cm">%  rho_P   =  partial derivative of density                 [ kg/(m^3 Pa) ]</span>
<span class="cm">%                 with respect to pressure in Pa</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rho_first_derivatives_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rho_SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rho_CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rho_P</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g_SA_mod_part</span><span class="p">,</span><span class="w"> </span><span class="n">g_SA_T_mod</span><span class="p">,</span><span class="w"> </span><span class="n">g_SA_T_mod_part</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y_pt</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">factor</span><span class="p">,</span><span class="w"> </span><span class="n">factora</span><span class="p">,</span><span class="w"> </span><span class="n">g_tp</span><span class="p">,</span><span class="w"> </span><span class="n">g_psq_g_tt</span><span class="p">,</span><span class="w"> </span><span class="n">g_p</span><span class="p">,</span><span class="w"> </span><span class="n">g_SA_mod</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt0_from_t</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pt0</span><span class="p">;</span>

<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w">  </span><span class="c1">//Note.The input pressure (p) is sea pressure in units of dbar.</span>

<span class="w">  </span><span class="n">g_SA_T_mod_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1458.233059470092</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">249.375342232496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-63.313928772146</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">14.09317606630898</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-980.14153344888</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-548.4580073635929</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">592.4012338275047</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2361238716608</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-258.3988055868252</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">2298.348396014856</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-325.1503575102672</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">153.8390924339484</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-90.2046337756875</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4142.8793862113125</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">10.50720794170734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2814.78225133626</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3520.125411988816</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1351.605895580406</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">731.4083582010072</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-216.60324087531103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">25.56203650166196</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2381.829935897496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">597.809129110048</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">291.8983352012704</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4165.4688847996085</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-1229.337851789418</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">681.370187043564</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">66.7696405958478</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3443.057215135908</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1349.638121077468</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-713.258224830552</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">176.8161433232</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">31.68006188846728</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="n">g_SA_T_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_SA_T_mod_part</span><span class="p">;</span>

<span class="w">  </span><span class="n">g_SA_mod_part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8645.36753595126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.626801985426835</span><span class="w"> </span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-450.535298526802</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">182.8520895502518</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-43.3206481750622</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.26033941694366</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">g_SA_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_SA_mod_part</span><span class="p">;</span>

<span class="w">  </span><span class="n">g_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">g_psq_g_tt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">g_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">factora</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_SA_T_mod</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">g_SA_mod</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">);</span>

<span class="w">  </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factora</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_psq_g_tt</span><span class="p">;</span>

<span class="w">  </span><span class="n">rho_SA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_tp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">g_p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_p</span><span class="p">);</span>

<span class="w">  </span><span class="n">rho_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_tp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_psq_g_tt</span><span class="p">);</span>

<span class="w">  </span><span class="n">rho_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">g_tp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_tp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_psq_g_tt</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Helmholtz_energy_t_exact                 Helmholtz energy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_Helmholtz_energy_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Helmholtz energy of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Helmholtz_energy_t_exact  =  Helmholtz energy                   [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall                                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.13 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Helmholtz_energy_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">         </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_p0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_anom_standard_CT_exact                specific volume anomaly</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_anom_standard_CT_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific volume anomaly from Absolute Salinity, Conservative</span>
<span class="cm">%  Temperature and pressure.  The reference value of Absolute Salinity is</span>
<span class="cm">%  SSO and the reference value of Conservative Temperature is equal to</span>
<span class="cm">%  0 degress C.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_specvol_anom_standard(SA,CT,p), which uses the computationally</span>
<span class="cm">%  efficient 75-term expression for specific volume in terms of SA, CT and</span>
<span class="cm">%  p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_anom_CT_exact  =  specific volume anomaly             [ m^3/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (3.7.3) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_anom_standard_CT_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_specvol_anom_standard_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_N2sol_SP_pt                              solubility of N2 in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  N2sol = gsw_N2sol_SP_pt(SP,pt)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the nitrogen, N2, concentration expected at equilibrium with</span>
<span class="cm">%  air at an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar)</span>
<span class="cm">%  including saturated water vapor.  This function uses the solubility</span>
<span class="cm">%  coefficients as listed in Hamme and Emerson (2004).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP  =  Practical Salinity  (PSS-78)                         [ unitless ]</span>
<span class="cm">%  pt  =  potential temperature (ITS-90) referenced               [ deg C ]</span>
<span class="cm">%         to one standard atmosphere (0 dbar).</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  N2sol = solubility of nitrogen in micro-moles per kg         [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Hamme, R., and S. Emerson, 2004: The solubility of neon, nitrogen and</span>
<span class="cm">%   argon in distilled water and seawater. Deep-Sea Research, 51,</span>
<span class="cm">%   1517-1528.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_N2sol_SP_pt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">298.15</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">((</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4.69149</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.32531</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.92704</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">6.42931</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                  </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-0.0146775</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-0.00802566</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-0.00744129</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_chem_potential_salt_t_exact                chemical potential of salt</span>
<span class="cm">%                                                               in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_chem_potential_salt_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the chemical potential of salt in seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  chem_potential_salt_t_exact  =  chemical potential of salt in seawater</span>
<span class="cm">%                                                                   [ J/g ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_chem_potential_salt_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_chem_potential_relative_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">gsw_chem_potential_water_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_kappa_const_t_exact                        isothermal compressibility</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_kappa_const_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates isothermal compressibility of seawater.</span>
<span class="cm">%  Note. This is the compressibility of seawater AT CONSTANT IN-SITU</span>
<span class="cm">%    TEMPERATURE</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  kappa_const_t_exact  =  isothermal compressibility              [ 1/Pa ]</span>
<span class="cm">%   Note. The output units are 1/Pa not 1/dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%   See Eqn. (2.15.1) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_kappa_const_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_from_pot_enthalpy_ice_poly               specific volume from</span>
<span class="cm">%                                          potential enthalpy of ice (poly)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_from_pot_enthalpy_ice_poly(pot_enthalpy_ice,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the specific volume of ice from the potential enthalpy</span>
<span class="cm">%  of ice.  The reference sea pressure of the potential enthalpy is zero</span>
<span class="cm">%  dbar.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this is a comptationally efficient polynomial fit of the</span>
<span class="cm">%  programme gsw_specvol_from_pot_enthalpy_ice(pot_enthalpy_ice,p).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  pot_enthalpy_ice  =  potential enthalpy of ice                  [ J/kg ]</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_ice  =  specific volume                               [ m^3/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="cm">%   Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="cm">%   Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_from_pot_enthalpy_ice_poly</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.090843882189585e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.993503247981132e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.187697844100046e-15</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.597339965467078e-21</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v04</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.092035946035247e-26</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v05</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.164174131511919e-33</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v06</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.874852704079762e-39</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v07</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.558856898604863e-09</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.323880019968672e-15</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v09</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.685780994854041e-21</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.212785565052150e-27</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.797551830947803e-33</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.953039321948178e-15</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.403547886994993e-21</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.461069600352674e-20</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">v00</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v01</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v02</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v04</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v05</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v06</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v07</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v08</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v09</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v11</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="p">(</span><span class="n">v12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v13</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v14</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_chem_potential_relative_t_exact           relative chemical potential</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_chem_potential_relative_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the relative chemical potential of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  chem_potential_relative_t_exact  =  relative chemical potential  [ J/g ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_chem_potential_relative_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_rho_first_derivatives_wrt_enthalpy_CT_exact     second derivatives of</span>
<span class="cm">%                                  specific volume with respect to enthalpy</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_rho_first_derivatives_wrt_enthalpy_CT_exact(SA,CT,p, *rho_SA,</span>
<span class="cm">                                                         *rho_h)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following two first-order derivatives of rho with respect</span>
<span class="cm">%  to enthalpy h,</span>
<span class="cm">%   (1) rho_SA, first-order derivative with respect to Absolute Salinity</span>
<span class="cm">%       at constant h &amp; p.</span>
<span class="cm">%   (2) rho_h, first-order derivative with respect to h at</span>
<span class="cm">%       constant SA and p.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_rho_first_derivatives_wrt_enthalpy(SA,CT,p) which uses the</span>
<span class="cm">%  computationally efficient 75-term expression for specific volume in</span>
<span class="cm">%  terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  rho_SA  =  The second derivative of rho with respect to</span>
<span class="cm">%             Absolute Salinity at constant h &amp; p.      [ J/(kg (g/kg)^2) ]</span>
<span class="cm">%  rho_h   =  The second derivative of rho with respect to</span>
<span class="cm">%             h at constant SA and p.                        [ J/(kg K^2) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rho_first_derivatives_wrt_enthalpy_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rho_SA</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rho_h</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rec_v</span><span class="p">,</span><span class="w"> </span><span class="n">rec_v2</span><span class="p">,</span><span class="w"> </span><span class="n">v_SA</span><span class="p">,</span><span class="w"> </span><span class="n">v_h</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">rec_v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_specvol_CT_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">gsw_specvol_first_derivatives_wrt_enthalpy_CT_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">v_SA</span><span class="p">,</span><span class="w"> </span><span class="n">v_h</span><span class="p">);</span>

<span class="w">  </span><span class="n">rec_v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rec_v</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v</span><span class="p">;</span>

<span class="w">  </span><span class="n">rho_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">v_h</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v2</span><span class="p">;</span>

<span class="w">  </span><span class="n">rho_SA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">v_SA</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_first_derivatives_CT_exact            first order derivatives</span>
<span class="cm">%                                                        of specific volume</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_first_derivatives_CT_exact(SA,CT,p, *v_SA,</span>
<span class="cm">%                                                         *v_CT,</span>
<span class="cm">%                                                         *v_P)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following three first-order derivatives of specific</span>
<span class="cm">%  volume (v),</span>
<span class="cm">%   (1) v_SA, first-order derivative with respect to Absolute Salinity</span>
<span class="cm">%       at constant CT &amp; p.</span>
<span class="cm">%   (2) v_CT, first-order derivative with respect to SA &amp; CT at</span>
<span class="cm">%       constant p.</span>
<span class="cm">%   (3) v_P, first-order derivative with respect to CT at constant SA</span>
<span class="cm">%       and p.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_specvol_first_derivatives(SA,CT,p) which uses the computationally</span>
<span class="cm">%  efficient 75 term expression for density in terms of SA, CT and p</span>
<span class="cm">%  (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  v_SA  =  The first derivative of specific volume with respect to</span>
<span class="cm">%           Absolute Salinity at constant CT &amp; p.     [ (m^3/kg)(g/kg)^-1 ]</span>
<span class="cm">%  v_CT  =  The first derivative of specific volume with respect to</span>
<span class="cm">%           CT at constant SA and p.                         [ m^3/(K kg) ]</span>
<span class="cm">%  v_P   =  The first derivative of specific volume with respect to</span>
<span class="cm">%           P at constant SA and CT.                        [ m^3/(Pa kg) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_first_derivatives_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_SA</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_P</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rec_gTT</span><span class="p">,</span><span class="w"> </span><span class="n">gSAP</span><span class="p">,</span><span class="w"> </span><span class="n">gTP</span><span class="p">,</span><span class="w"> </span><span class="n">gSAT</span><span class="p">,</span><span class="w"> </span><span class="n">gSA_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">gPP</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">);</span>
<span class="w">  </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">);</span>
<span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_t</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">rec_gTT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">gSAP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gSA_pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">pr0</span><span class="p">);</span>
<span class="w">  </span><span class="n">gPP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">v_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gTP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_SA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gSAP</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gTP</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gSAT</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rec_abs_pt0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gSA_pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gPP</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gTP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gTP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_gTT</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_anom_CT_exact                         specific volume anomaly</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_anom_CT_exact(SA,CT,p,SA_ref,CT_ref)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates specific volume anomaly from Absolute Salinity, Conservative</span>
<span class="cm">%  Temperature and pressure.  If the Absolute Salinity and Conservative</span>
<span class="cm">%  Temperature reference value (SA_ref and CT_ref) are not defined then a</span>
<span class="cm">%  default reference value of Absolute Salinity is SSO and the reference</span>
<span class="cm">%  value of Conservative Temperature is equal to 0 degress C.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_specvol_anom(SA,CT,p,SA_ref,CT_ref), which uses the computationally</span>
<span class="cm">%  efficient 75-term expression for specific volume in terms of SA, CT and</span>
<span class="cm">%  p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">% Optional:</span>
<span class="cm">%  SA_ref =  reference Absolute Salinity                           [ g/kg ]</span>
<span class="cm">%  CT_ref =  reference Conservative Temperature (ITS-90)          [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_anom_CT_exact  =  specific volume anomaly             [ m^3/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (3.7.3) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_anom_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA_ref</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT_ref</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">specvol_anom_CT_exact</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA_ref</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">CT_ref</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">specvol_anom_CT_exact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_specvol_anom_standard_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">t_ref_array</span><span class="p">,</span><span class="w"> </span><span class="n">SA_ref_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">CT_ref_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">    </span><span class="n">t_ref_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA_ref_array</span><span class="p">,</span><span class="w"> </span><span class="n">CT_ref_array</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">    </span><span class="n">specvol_anom_CT_exact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">      </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA_ref_array</span><span class="p">,</span><span class="w"> </span><span class="n">t_ref_array</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">specvol_anom_CT_exact</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_t_from_pt0                         in-situ temperature from potential</span>
<span class="cm">%                                         temperature with a p_ref = 0 dbar</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_t_from_pt0(SA,pt0,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates in-situ temperature from potential temperature with a</span>
<span class="cm">%  reference pressure of 0 dbar.</span>
<span class="cm">%</span>
<span class="cm">%  It is also possible to calculate in-situ temperature from potential</span>
<span class="cm">%  temparature using the function gsw_pt_from_t.  In this case it would be</span>
<span class="cm">%  called with Absolute Salinity, SA, potential temperature referenced to</span>
<span class="cm">%  0 dbar, pt0, and the in-situ pressure (i.e. gsw_pt_from_t(SA,pt0,0,p) ).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  pt0 =  potential temperature with reference pressure = 0 dbar  [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.1 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall T. J. and S. J. Wotherspoon, 2013: A simple modification of</span>
<span class="cm">%   Newton|s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_t_from_pt0</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_pt_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*****************************************</span>
<span class="cm">   this is called from</span>
<span class="cm">   gsw_pot_enthalpy_from_specvol_ice_poly</span>
<span class="cm">   as a subfunction</span>
<span class="cm">*****************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_from_pot_enthalpy_ice_first_derivatives_poly</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.993503247981132e-10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.187697844100046e-15</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.597339965467078e-21</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v04</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.092035946035247e-26</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v05</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.164174131511919e-33</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v06</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.874852704079762e-39</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.323880019968672e-15</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v09</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.685780994854041e-21</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.212785565052150e-27</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.797551830947803e-33</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.403547886994993e-21</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">v01</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v02</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v03</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v04</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v05</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="mf">6.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v06</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v08</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v09</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v11</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v13</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_pot_enthalpy_from_specvol_ice_poly            potential enthalpy from</span>
<span class="cm">%                                             specific volume of ice (poly)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_pot_enthalpy_from_specvol_ice_poly(specvol_ice,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the potential enthalpy of ice from the specific volume</span>
<span class="cm">%  of ice.  The reference sea pressure of the potential enthalpy is zero</span>
<span class="cm">%  dbar.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this is a comptationally efficient polynomial version of</span>
<span class="cm">%  specfic volume from potential enthalpy ice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  specvol_ice =  specific volume                                [ m^3/kg ]</span>
<span class="cm">%  p           =  sea pressure                                     [ dbar ]</span>
<span class="cm">%              ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  pot_enthalpy_ice =  potential enthalpy of ice                   [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., P.M. Barker, R. Feistel and B.K. Galton-Fenzi, 2014:</span>
<span class="cm">%   Melting of Ice and Sea Ice into Seawater and Frazil Ice Formation.</span>
<span class="cm">%   Journal of Physical Oceanography, 44, 1751-1775.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., and S.J. Wotherspoon, 2014: A simple modification of</span>
<span class="cm">%   Newton|s method to achieve convergence of order 1 + sqrt(2).  Applied</span>
<span class="cm">%   Mathematics Letters, 29, 20-25.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pot_enthalpy_from_specvol_ice_poly</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">specvol_ice</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.333548730778702e5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.158533659785955e14</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.088110638980851e17</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.574635299523583e20</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h04</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.315779173662935e23</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h05</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.790387951606607e26</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h06</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-8.296646858006085e28</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h07</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.315408333461980e5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.021450585146860e8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h09</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.705978545141118e10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.048693790458912e14</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.769028853661338e17</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.307016488735996e-2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.135637957175861e1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">h14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.593828063620491e-9</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pot_enthalpy_ice_old</span><span class="p">,</span><span class="w"> </span><span class="n">delta_v_ice</span><span class="p">,</span><span class="w"> </span><span class="n">pot_enthalpy_ice_mean</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h00</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h01</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h02</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h03</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h04</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h05</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">h06</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">specvol_ice</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h07</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h08</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h09</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">h11</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">specvol_ice</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">h12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">h13</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">specvol_ice</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">h14</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">));</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v_h_Ih</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_specvol_from_pot_enthalpy_ice_first_derivatives_poly</span><span class="p">(</span><span class="n">pot_enthalpy_ice</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">   </span><span class="c1">// initial estimate of v_h_Ih, the pot_enthalpy_ice derivative of specvol_ice</span>

<span class="w">   </span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">   </span><span class="c1">// Begin the modified Newton-Raphson iterative procedure</span>
<span class="w">   </span><span class="c1">//--------------------------------------------------------------------------</span>

<span class="w">  </span><span class="n">pot_enthalpy_ice_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">;</span>
<span class="w">  </span><span class="n">delta_v_ice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_specvol_from_pot_enthalpy_ice_poly</span><span class="p">(</span><span class="n">pot_enthalpy_ice_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">specvol_ice</span><span class="p">;</span>
<span class="w">  </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pot_enthalpy_ice_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">delta_v_ice</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v_h_Ih</span><span class="p">;</span>
<span class="w">   </span><span class="c1">// this is half way through the modified N-R method (McDougall and Wotherspoon, 2012)</span>
<span class="w">  </span><span class="n">pot_enthalpy_ice_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pot_enthalpy_ice_old</span><span class="p">);</span>
<span class="w">  </span><span class="n">v_h_Ih</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_specvol_from_pot_enthalpy_ice_first_derivatives_poly</span><span class="p">(</span><span class="n">pot_enthalpy_ice_mean</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pot_enthalpy_ice_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">delta_v_ice</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v_h_Ih</span><span class="p">;</span>
<span class="w">   </span><span class="c1">// this is the end of one loop.</span>

<span class="w">  </span><span class="n">pot_enthalpy_ice_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">;</span>
<span class="w">  </span><span class="n">delta_v_ice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_specvol_from_pot_enthalpy_ice_poly</span><span class="p">(</span><span class="n">pot_enthalpy_ice_old</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">specvol_ice</span><span class="p">;</span>
<span class="w">  </span><span class="n">pot_enthalpy_ice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pot_enthalpy_ice_old</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">delta_v_ice</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">v_h_Ih</span><span class="p">;</span>
<span class="w">   </span><span class="c1">// this is half way through the modified N-R method (McDougall and Wotherspoon, 2012)</span>

<span class="w">   </span><span class="c1">// After 1.5 loops trhough the modified Newton-Raphson procedure the error</span>
<span class="w">   </span><span class="c1">// in pot_enthalpy_ice is 8 x 10^-9 J/kg which is machine precission for</span>
<span class="w">   </span><span class="c1">// this calculation.</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">pot_enthalpy_ice</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_anom_standard_t_exact                 specific volume anomaly</span>
<span class="cm">%==========================================================================</span>
<span class="cm">% This function has changed name to gsw_specvol_anom_standard_t_exact</span>
<span class="cm">% Note that this is the last version of GSW (Version 3.05) that will</span>
<span class="cm">% contain the function &quot;gsw_specvol_anom_t_exact&quot;.  Change your code to use</span>
<span class="cm">% &quot;gsw_specvol_anom_standard_t_exact&quot;.</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_anom_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t_zero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">         </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sso</span><span class="p">,</span><span class="w"> </span><span class="n">t_zero</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_dynamic_enthalpy_CT_exact                 dyamic enthalpy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_dynamic_enthalpy_CT_exact(SA,CT,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the dynamic enthalpy of seawater from Absolute Salinity and</span>
<span class="cm">%  Conservative Temperature and pressure.  Dynamic enthalpy is defined</span>
<span class="cm">%  as enthalpy minus potential enthalpy (Young, 2010).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_dynamic_enthalpy(SA,CT,p), which uses the computationally</span>
<span class="cm">%  efficient 75-term expression for specific volume in terms of SA, CT</span>
<span class="cm">%  and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  dynamic_enthalpy_CT_exact  =  dynamic enthalpy                  [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See apendix A.30 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%    See Eqns. (18) and (22)</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  Young, W.R., 2010: Dynamic enthalpy, Conservative Temperature, and the</span>
<span class="cm">%   seawater Boussinesq approximation. Journal of Physical Oceanography,</span>
<span class="cm">%   40, 394-400.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_dynamic_enthalpy_CT_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_enthalpy_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">CT</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_atomic_weight                 mole-weighted atomic weight of sea salt</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_atomic_weight</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  This function returns the mole-weighted atomic weight of sea salt of</span>
<span class="cm">%  Reference Composition, which is 31.4038218 g/mol.  This has been</span>
<span class="cm">%  defined as part of the Reference-Composition Salinity Scale of 2008</span>
<span class="cm">%  (Millero et al., 2008).</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  atomic_weight = mole-weighted atomic weight of sea salt of Reference</span>
<span class="cm">%                  Composition                                    [ g/mol ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Table D.4 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Millero, F.J., R. Feistel, D.G. Wright, and T.J. McDougall, 2008:</span>
<span class="cm">%   The composition of Standard Seawater and the definition of the</span>
<span class="cm">%   Reference-Composition Salinity Scale, Deep-Sea Res. I, 55, 50-72.</span>
<span class="cm">%     See Eqn. (5.3) of this paper.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_atomic_weight</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">31.4038218</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_alpha_wrt_pt_t_exact                    thermal expansion coefficient</span>
<span class="cm">%                                     with respect to potential temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_alpha_wrt_pt_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the thermal expansion coefficient of seawater with respect to</span>
<span class="cm">%  potential temperature, with a reference pressure of zero.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  alpha_wrt_pt_t_exact  =  thermal expansion coefficient           [ 1/K ]</span>
<span class="cm">%                           with respect to potential temperature,</span>
<span class="cm">%                           with a reference pressure of zero dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.18.2) of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_alpha_wrt_pt_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt0_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_alpha_wrt_CT_t_exact                    thermal expansion coefficient</span>
<span class="cm">%                                  with respect to Conservative Temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_alpha_wrt_CT_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the thermal expansion coefficient of seawater with respect to</span>
<span class="cm">%  Conservative Temperature.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  alpha_wrt_CT_t_exact  =  thermal expansion coefficient           [ 1/K ]</span>
<span class="cm">%                           with respect to Conservative Temperature</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  David Jackett, Trevor McDougall and Paul Barker     [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.18.3) of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_alpha_wrt_CT_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt0_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_cp0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_first_derivatives_wrt_enthalpy_CT_exact     first derivatives</span>
<span class="cm">%                               of specific volume with respect to enthalpy</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_first_derivatives_wrt_enthalpy_CT_exact(SA,CT,p,</span>
<span class="cm">                                                               *v_SA,</span>
<span class="cm">                                                               *v_h)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following two first-order derivatives of specific</span>
<span class="cm">%  volume (v),</span>
<span class="cm">%   (1) v_SA, first-order derivative with respect to Absolute Salinity</span>
<span class="cm">%       at constant h &amp; p.</span>
<span class="cm">%   (2) v_h, first-order derivative with respect to h at constant SA &amp; p.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_specvol_first_derivatives_wrt_enthalpy(SA,CT,p) which uses the</span>
<span class="cm">%  computationally efficient 75 term expression for specific volume in</span>
<span class="cm">%  terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  v_SA =  The first derivative of specific volume with respect to</span>
<span class="cm">%          Absolute Salinity at constant h &amp; p.         [ J/(kg (g/kg)^2) ]</span>
<span class="cm">%  v_h  =  The first derivative of specific volume with respect to</span>
<span class="cm">%          h at constant SA &amp; p.                         [ J/(kg K(g/kg)) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker.                   [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_first_derivatives_wrt_enthalpy_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_SA</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">v_h</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rec_h_CT</span><span class="p">,</span><span class="w"> </span><span class="n">vCT_SA</span><span class="p">,</span><span class="w"> </span><span class="n">vCT_CT</span><span class="p">,</span><span class="w"> </span><span class="n">dummy</span><span class="p">,</span><span class="w"> </span><span class="n">h_SA</span><span class="p">,</span><span class="w"> </span><span class="n">h_CT</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">gsw_specvol_first_derivatives_CT_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">vCT_SA</span><span class="p">,</span><span class="w"> </span><span class="n">vCT_CT</span><span class="p">,</span><span class="w"> </span><span class="n">dummy</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsw_enthalpy_first_derivatives_ct_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">h_SA</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">h_CT</span><span class="p">);</span>

<span class="w">  </span><span class="n">rec_h_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">h_CT</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_SA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vCT_SA</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">vCT_CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">h_SA</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_h_CT</span><span class="p">;</span>

<span class="w">  </span><span class="n">v_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vCT_CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_h_CT</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SR_from_SP                 Reference Salinity from Practical Salinity</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_SR_from_SP(SP)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Reference Salinity from Practical Salinity.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP  =  Practical Salinity  (PSS-78)                         [ unitless ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SR  =  Reference Salinity                                       [ g/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sr_from_sp</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sp</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">sp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_ups</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_p_from_Abs_Pressure                                      sea pressure</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_p_from_Abs_Pressure(Absolute_Pressure)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates sea pressure from Absolute Pressure.  Note that Absolute</span>
<span class="cm">%  Pressure is in Pa NOT dbar.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  Absolute_Pressure  =  Absolute Pressure                           [ Pa ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See Eqn. (2.2.1) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_p_from_Abs_Pressure</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">Absolute_Pressure</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">Absolute_Pressure</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_p0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.0001</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_SP_from_R                  Practical Salinity from conductivity ratio</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_SP_from_R(R,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Practical Salinity, SP, from the conductivity ratio, R,</span>
<span class="cm">%  primarily using the PSS-78 algorithm.  Note that the PSS-78 algorithm</span>
<span class="cm">%  for Practical Salinity is only valid in the range 2 &lt; SP &lt; 42.  If the</span>
<span class="cm">%  PSS-78 algorithm produces a Practical Salinity that is less than 2 then</span>
<span class="cm">%  the Practical Salinity is recalculated with a modified form of the</span>
<span class="cm">%  Hill et al. (1986) formula.  The modification of the Hill et al. (1986)</span>
<span class="cm">%  expression are to ensure that it is exactly consistent with PSS-78</span>
<span class="cm">%  at SP = 2.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  R  =  conductivity ratio                                    [ unitless ]</span>
<span class="cm">%  t  =  in-situ temperature (ITS-90)                             [ deg C ]</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%        ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  SP  =   Practical Salinity on the PSS-78 scale              [ unitless ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker, Trevor McDougall and Rich Pawlowicz    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  Hill, K.D., T.M. Dauphinee &amp; D.J. Woods, 1986: The extension of the</span>
<span class="cm">%   Practical Salinity Scale 1978 to low salinities. IEEE J. Oceanic Eng.,</span>
<span class="cm">%   OE-11, 1, 109 - 112.</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix E of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Unesco, 1983: Algorithms for computation of fundamental properties of</span>
<span class="cm">%   seawater. Unesco Technical Papers in Marine Science, 44, 53 pp.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_SP_from_R</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SP</span><span class="p">,</span><span class="w"> </span><span class="n">Rtx</span><span class="p">,</span><span class="w"> </span><span class="n">Rt</span><span class="p">,</span><span class="w"> </span><span class="n">Rp</span><span class="p">,</span><span class="w"> </span><span class="n">rt_lc</span><span class="p">,</span><span class="w"> </span><span class="n">ft68</span><span class="p">,</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>

<span class="w">  </span><span class="n">ft68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">t68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.0</span><span class="p">));</span>

<span class="w">        </span><span class="c1">//rt_lc corresponds to rt as defined in the UNESCO 44 (1983) routines.</span>
<span class="w">  </span><span class="n">rt_lc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">c0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c2</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">c3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">c4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">;</span>

<span class="w">  </span><span class="n">Rp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">e1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">e2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">e3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">d1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">d2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">d3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">d4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span><span class="p">);</span>

<span class="w">  </span><span class="n">Rt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">Rp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rt_lc</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Rt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">Rt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NAN</span><span class="p">;}</span>

<span class="w">  </span><span class="n">Rtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">Rt</span><span class="p">);</span>

<span class="w">  </span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gspc</span><span class="p">.</span><span class="n">a5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ft68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b3</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="n">gspc</span><span class="p">.</span><span class="n">b4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">Hill_ratio</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sqrty</span><span class="p">,</span><span class="w"> </span><span class="n">part1</span><span class="p">,</span><span class="w"> </span><span class="n">part2</span><span class="p">,</span><span class="w"> </span><span class="n">SP_Hill_raw</span><span class="p">;</span>

<span class="w">    </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_hill_ratio_at_sp2</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">400.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rt</span><span class="p">;</span>
<span class="w">    </span><span class="n">sqrty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Rtx</span><span class="p">;</span>
<span class="w">    </span><span class="n">part1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="w">    </span><span class="n">part2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrty</span><span class="p">));</span>
<span class="w">    </span><span class="n">SP_Hill_raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">a0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gspc</span><span class="p">.</span><span class="n">b0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ft68</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">part2</span><span class="p">;</span>
<span class="w">    </span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hill_ratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SP_Hill_raw</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//This line ensures that SP is non-negative.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SP</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">SP</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_isochoric_heat_cap_t_exact        isochoric heat capacity of seawater</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_isochoric_heat_cap_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the isochoric heat capacity of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  isochoric_heat_cap_t_exact  =  isochoric heat capacity      [ J/(kg K) ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall                                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.21 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_isochoric_heat_cap_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g_tt</span><span class="p">,</span><span class="w"> </span><span class="n">g_tp</span><span class="p">,</span><span class="w"> </span><span class="n">g_pp</span><span class="p">;</span>
<span class="w">  </span><span class="n">g_tt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">g_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">g_pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">g_tt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">g_tp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_tp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">g_pp</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_beta_const_pt_t_exact                  saline contraction coefficient</span>
<span class="cm">%                                         at constant potential temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_beta_const_pt_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the saline (i.e. haline) contraction coefficient of seawater</span>
<span class="cm">%  at constant potential temperature with a reference pressure of 0 dbar.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  beta_const_pt_t_exact  =  saline contraction coefficient        [ kg/g ]</span>
<span class="cm">%                            at constant potential temperature</span>
<span class="cm">%                            and with a reference pressure of 0 dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.19.2) of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_beta_const_pt_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">factor</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="p">,</span><span class="w"> </span><span class="n">g_SA_pt_mod</span><span class="p">,</span><span class="w"> </span><span class="n">g_SA_T_mod</span><span class="p">,</span><span class="w"> </span><span class="n">pt0</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y_pt</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt0_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SA</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pt0</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w">       </span><span class="c1">//Note.The input pressure (p) is sea pressure in units of dbar.</span>

<span class="w">  </span><span class="n">g_SA_T_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1458.233059470092</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">249.375342232496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-63.313928772146</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">14.09317606630898</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-980.14153344888</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-548.4580073635929</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">592.4012338275047</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2361238716608</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-258.3988055868252</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">2298.348396014856</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-325.1503575102672</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">153.8390924339484</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-90.2046337756875</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4142.8793862113125</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">10.50720794170734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2814.78225133626</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3520.125411988816</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1351.605895580406</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">731.4083582010072</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-216.60324087531103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">25.56203650166196</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2381.829935897496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">597.809129110048</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">291.8983352012704</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4165.4688847996085</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-1229.337851789418</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">681.370187043564</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">66.7696405958478</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3443.057215135908</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1349.638121077468</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-713.258224830552</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">176.8161433232</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">31.68006188846728</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="n">g_SA_T_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_SA_T_mod</span><span class="p">;</span>

<span class="w">  </span><span class="n">g_SA_pt_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-980.14153344888</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-548.4580073635929</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">592.4012338275047</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2361238716608</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-258.3988055868252</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-90.2046337756875</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">10.50720794170734</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3520.125411988816</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1351.605895580406</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">731.4083582010072</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-216.60324087531103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">25.56203650166196</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_pt</span><span class="p">))));</span>

<span class="w">  </span><span class="n">g_SA_pt_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_SA_pt_mod</span><span class="p">;</span>

<span class="w">  </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="n">factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">g_SA_T_mod</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">g_SA_pt_mod</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">factor</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gp</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************</span>
<span class="cm">   returns true or false depending on</span>
<span class="cm">   equality or not of rtIsNaNF with val</span>
<span class="cm">***************************************/</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rtIsNaNF</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rtNanF</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************</span>
<span class="cm">   The function &quot;gsw_adiabatic_lapse_rate_t_exact&quot;</span>
<span class="cm">   has changed to &quot;gsw_adiabatic_lapse_rate_from_t&quot;</span>
<span class="cm">****************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_adiabatic_lapse_rate_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_adiabatic_lapse_rate_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_adiabatic_lapse_rate_from_t                      adiabatic lapse rate</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_adiabatic_lapse_rate_from_t(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the adiabatic lapse rate of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  adiabatic_lapse_rate  =  adiabatic lapse rate                   [ K/Pa ]</span>
<span class="cm">%    Note.  The output is in unit of degress Celsius per Pa,</span>
<span class="cm">%      (or equivilently K/Pa) not in units of K/dbar.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See Eqn. (2.22.1) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_adiabatic_lapse_rate_from_t</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_osmotic_coefficient_t_exact                       osmotic coefficient</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_osmotic_coefficient_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the osmotic coefficient of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  osmotic_coefficient_t_exact  =  osmotic coefficient of seawater</span>
<span class="cm">%                                                              [ unitless ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_osmotic_coefficient_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.777007343340624e-3</span><span class="p">;</span><span class="w">  </span><span class="c1">// k = M_S/R</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">part</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">tl</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.231916621570606e1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.059039593127674e1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.025914794694813e1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc04</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.040733670521486e1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc05</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.074543321119333e1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc06</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.864215613820487e1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc07</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.022566485046178</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.138647522851840</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc09</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.353207379758663e1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.316560781114737</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.829232499785750</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.358042980767074e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.705887283375562</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.246962174707332e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.228376913546017</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.089364009088042e-2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.264828939262248e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.213127679460041e-2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.481543497315280</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.363368964861909</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.640491627443773e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.344724779893754</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.180866793244492</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc24</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.765753255963401</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc25</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.726993916772165</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc26</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.918303792060746</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc27</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.506082399183509e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc28</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.015695507663942e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc29</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.035024326471108</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.742173543702397e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc31</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.465642650849419e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.508472135244717e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc33</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.668086444057845e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.189939162107803e-1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">oc35</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.245629194309487e-2</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="cm">/******************************************************</span>
<span class="cm">   M_S = 0.0314038218;</span>

<span class="cm">   mole-weighted average atomic weight of the elements</span>
<span class="cm">   of Reference-Composition sea salt, in units of</span>
<span class="cm">   kg mol^-1.  Strictly speaking, the formula below</span>
<span class="cm">   applies only to seawater of Reference Composition.</span>

<span class="cm">   If molality and the osmotic coefficienit is</span>
<span class="cm">   required to an accuracy of better than 0.1% we</span>
<span class="cm">   suggest you contact the authors for further</span>
<span class="cm">   guidance.</span>
<span class="cm">*******************************************************/</span>

<span class="w">  </span><span class="n">part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1000.00</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="p">);</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="p">;</span><span class="w">  </span><span class="c1">//Note that the input pressure (p) is sea pressure in units of dbar.</span>

<span class="w">  </span><span class="n">tl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oc01</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc02</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc04</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc05</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc06</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc07</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc08</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc09</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc11</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc13</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc15</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc17</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc18</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc19</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc20</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc21</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc22</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc23</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc24</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc25</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc26</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc27</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc28</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc29</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc30</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc31</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc32</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">oc33</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc34</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oc35</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">tl</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">part</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Arsol_SP_pt                              solubility of Ar in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_Arsol_SP_pt(SP,pt)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the argon, Ar, concentration expected at equilibrium with air</span>
<span class="cm">%  at an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar) including</span>
<span class="cm">%  saturated water vapor  This function uses the solubility coefficients</span>
<span class="cm">%  as listed in Hamme and Emerson (2004).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP  =  Practical Salinity  (PSS-78)                         [ unitless ]</span>
<span class="cm">%  pt  =  potential temperature (ITS-90) referenced               [ deg C ]</span>
<span class="cm">%         to one standard atmosphere (0 dbar).</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Arsol = solubility of argon                                  [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Hamme, R., and S. Emerson, 2004: The solubility of neon, nitrogen and</span>
<span class="cm">%   argon in distilled water and seawater. Deep-Sea Research, 51,</span>
<span class="cm">%   1517-1528.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Arsol_SP_pt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">298.15</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">((</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4.90379</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.13116</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3.17609</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.7915</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                  </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-0.0116888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-0.0076667</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-0.00696233</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_depth_from_z                                     depth from height, z</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_depth_from_z(z)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates depth from height, z.  Note that in general height is</span>
<span class="cm">%  negative in the ocean.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  z  =  height                                                       [ m ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  depth  =  depth                                                    [ m ]</span>
<span class="cm">%</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_depth_from_z</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_molality_from_SA                                 molality of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_molality_from_SA(SA)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the molality of seawater from Absolute Salinity.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  molality  =  molality of seawater                             [ mol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_molality_from_SA</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0314038218</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1000.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unnamed_idx_0</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Abs_Pressure_from_p                                 Absolute Pressure</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_Abs_Pressure_from_p(p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates Absolute Pressure from sea pressure.  Note that Absolute</span>
<span class="cm">%  Pressure is in Pa NOT dbar.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Absolute_Pressure  =  Absolute Pressure                           [ Pa ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%    See Eqn. (2.2.1) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Abs_Pressure_from_p</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_CT_maxdensity_exact               Conservative Temperature of maximum</span>
<span class="cm">%                                                       density of seawater</span>
<span class="cm">% =========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_CT_maxdensity_exact(SA,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Conservative Temperature of maximum density of seawater.</span>
<span class="cm">%  This function returns the Conservative temperature at which the density</span>
<span class="cm">%  of seawater is a maximum, at given Absolute Salinity, SA, and sea</span>
<span class="cm">%  pressure, p (in dbar).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely gsw_CT_maxdensity(SA,p),</span>
<span class="cm">%  which uses the computationally efficient 75-term expression for specific</span>
<span class="cm">%  volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA =  Absolute Salinity                                         [ g/kg ]</span>
<span class="cm">%  p  =  sea pressure                                              [ dbar ]</span>
<span class="cm">%        ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  CT_maxdensity_exact  =  Conservative Temperature at which      [ deg C ]</span>
<span class="cm">%                          the density of seawater is a maximum for</span>
<span class="cm">%                          given Absolute Salinity and pressure.</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall &amp; Paul Barker                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 3.42 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_CT_maxdensity_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t_maxdensity_exact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_maxdensity_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_ct_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t_maxdensity_exact</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_internal_energy_t_exact          specific internal energy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_internal_energy_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the specific internal energy of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  internal_energy_t_exact  =  specific internal energy (u)        [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall                                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (2.11.1) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_internal_energy_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">         </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">         </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">db2pa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_p0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">         </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Hesol_SP_pt                              solubility of He in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_Hesol_SP_pt(SP,pt)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the helium concentration expected at equilibrium with air at</span>
<span class="cm">%  an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar) including</span>
<span class="cm">%  saturated water vapor.  This function uses the solubility coefficients</span>
<span class="cm">%  as listed in Weiss (1971).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SP  =  Practical Salinity  (PSS-78)                         [ unitless ]</span>
<span class="cm">%  pt  =  potential temperature (ITS-90) referenced               [ deg C ]</span>
<span class="cm">%         to one standard atmosphere (0 dbar).</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Hesol = solubility of helium in micro-moles per kg           [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Dymond and Smith, 1980: The virial coefficients of pure gases and</span>
<span class="cm">%   mixtures. Clarendon Press, Oxford.</span>
<span class="cm">%</span>
<span class="cm">%  Weiss, R.F., 1971: Solubility of Helium and Neon in Water and Seawater.</span>
<span class="cm">%   J. Chem. and Engineer. Data, 16, 235-241.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Hesol_SP_pt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SP</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">pt68</span><span class="p">,</span><span class="w"> </span><span class="n">y_100</span><span class="p">;</span>

<span class="w">  </span><span class="n">pt68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_100</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.01</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">((((</span><span class="mf">21634.42</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-167.2178</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="mf">139.2032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">y_100</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">-22.6202</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                      </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y_100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-0.0034266</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.023541</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="mf">-0.044781</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">44.558176715055367</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_p_parts                        specific volume pressure terms</span>
<span class="cm">%                                                        (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_p_parts(SA,CT, *vp0,  *vp1, *vp2,  *vp3,  *vp4,  *vp5,</span>
<span class="cm">                                                  *vp6)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates each of the pressure terms in specific volume from Absolute</span>
<span class="cm">%  Salinity and Conservative Temperature, using the computationally</span>
<span class="cm">%  efficient 75-term polynomial expression for specific volume (Roquet et</span>
<span class="cm">%  al., 2015).</span>
<span class="cm">%</span>
<span class="cm">%  Note that the 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is available to be used if one wants to test if</span>
<span class="cm">%  some of one|s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  vp0 = Absolute Salinity and Conservative Temperature terms for pressure</span>
<span class="cm">%         to the 0</span>
<span class="cm">%  vp1 = Absolute Salinity and Conservative Temperature terms for pressure</span>
<span class="cm">%         to the 1</span>
<span class="cm">%  vp2 = Absolute Salinity and Conservative Temperature terms for pressure</span>
<span class="cm">%         to the 2</span>
<span class="cm">%  vp3 = Absolute Salinity and Conservative Temperature terms for pressure</span>
<span class="cm">%         to the 3</span>
<span class="cm">%  vp4 = Absolute Salinity and Conservative Temperature terms for pressure</span>
<span class="cm">%         to the 4</span>
<span class="cm">%  vp5 = Absolute Salinity and Conservative Temperature terms for pressure</span>
<span class="cm">%         to the 5</span>
<span class="cm">%  vp6 = Absolute Salinity and Conservative Temperature terms for pressure</span>
<span class="cm">%         to the 6</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Fabien Roquet, Gurvan Madec, Trevor McDougall &amp; Paul Barker</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmos. Ocean. Tech., 20,</span>
<span class="cm">%   730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling, 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  This software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">% ==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_p_parts</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vp0</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vp1</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vp2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vp3</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vp4</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vp5</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vp6</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>

<span class="w">  </span><span class="n">vp0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v300</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v500</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v600</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v010</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v210</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v310</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v410</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v510</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v020</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v120</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v220</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v320</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v420</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v030</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v230</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v330</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v040</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v140</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v240</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v050</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v150</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v060</span><span class="p">)))));</span>

<span class="w">  </span><span class="n">vp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v001</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v201</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v401</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v501</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v111</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v211</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v311</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v411</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v021</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v221</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v321</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v231</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v041</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v141</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v051</span><span class="p">))));</span>

<span class="w">  </span><span class="n">vp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v002</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v302</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v402</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v012</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v212</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v312</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v222</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v032</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v132</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v042</span><span class="p">)));</span>

<span class="w">  </span><span class="n">vp3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v203</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v013</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v113</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v023</span><span class="p">);</span>

<span class="w">  </span><span class="n">vp4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v004</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v104</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v014</span><span class="p">;</span>

<span class="w">  </span><span class="n">vp5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v005</span><span class="p">;</span>

<span class="w">  </span><span class="n">vp6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v006</span><span class="p">;</span>

<span class="c1">// Note that,</span>
<span class="c1">// specvol = vp0 + z.*(vp1 + z.*(vp2 + z.*(vp3</span>
<span class="c1">//               + z.*(vp4 + z.*(vp5 + z.*vp6)))));</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_t90_from_t68              ITS-90 temperature from IPTS-68 temperature</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_t90_from_t68(t68)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Converts IPTS-68 temperature to International Temperature Scale 1990</span>
<span class="cm">%  (ITS-90) temperature.  This conversion should be applied to all in-situ</span>
<span class="cm">%  data collected between 1/1/1968 and 31/12/1989.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  t68  =  in-situ temperature  (IPTS-68)                         [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  t90  =  in-situ temperature  (ITS-90)                          [ deg C ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  International Temperature Scales of 1948, 1968 and 1990, an ICES</span>
<span class="cm">%   note, available from http://www.ices.dk/ocean/procedures/its.htm</span>
<span class="cm">%</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.1 and appendix A.1 of this TEOS-10 manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_t90_from_t68</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">t68</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">t68</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.999760057586179</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_weighted_nanmean                      weighted mean of non-NaN values</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_weighted_nanmean(data,weights, *weighted_mean, *weighted_weights)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  This function returns the weighted mean of the data, where the weights</span>
<span class="cm">%  are given by weights and a coresponding weighted weight for the weighted</span>
<span class="cm">%  mean.  If the weights are not supplied then the weights are considerd to</span>
<span class="cm">%  be all equal. This programme treats NaN|s as missing values.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  data    = data values</span>
<span class="cm">%</span>
<span class="cm">% Optional</span>
<span class="cm">%  weights = weights of the data</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  weighted_mean     =  weighted mean of the data</span>
<span class="cm">%  weighted_weights  =  weighted weights of the weights</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall, based on nanmean from Matlab.</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_weighted_nanmean</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">weights</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">weighted_mean</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">weighted_weights</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">unnamed_idx_0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">weighted_data</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">nz</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">Inan</span><span class="p">;</span>

<span class="w">  </span><span class="n">weighted_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weights</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="w">  </span><span class="n">Inan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_rtIsNaN</span><span class="p">(</span><span class="n">weighted_data</span><span class="p">);</span>
<span class="w">  </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weights</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Inan</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">weighted_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">    </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtNaN</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">weighted_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weighted_data</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">unnamed_idx_0</span><span class="p">;</span>
<span class="w">  </span><span class="n">nz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">Inan</span><span class="p">;</span>
<span class="w">  </span><span class="n">weighted_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nz</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nz</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">weighted_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtNaN</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">weighted_weights</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unnamed_idx_0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">weighted_data</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_rho_second_derivatives_CT_exact              SA and CT partial second</span>
<span class="cm">%                                              order derivatives of density</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_rho_second_derivatives_CT_exact(SA,CT,p, *rho_SA_SA,</span>
<span class="cm">                                                      *rho_SA_CT,</span>
<span class="cm">                                                      *rho_CT_CT,</span>
<span class="cm">                                                      *rho_SA_P,</span>
<span class="cm">                                                      *rho_CT_P)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the following five second-order derivatives of rho,</span>
<span class="cm">%   (1) rho_SA_SA, second-order derivative with respect to Absolute</span>
<span class="cm">%       Salinity at constant CT &amp; p.</span>
<span class="cm">%   (2) rho_SA_CT, second-order derivative with respect to SA &amp; CT at</span>
<span class="cm">%       constant p.</span>
<span class="cm">%   (3) rho_CT_CT, second-order derivative with respect to CT at</span>
<span class="cm">%       constant SA &amp; p.</span>
<span class="cm">%   (4) rho_SA_P, second-order derivative with respect to SA &amp; P at</span>
<span class="cm">%       constant CT.</span>
<span class="cm">%   (5) rho_CT_P, second-order derivative with respect to CT &amp; P at</span>
<span class="cm">%       constant SA.</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely</span>
<span class="cm">%  gsw_rho_second_derivatives(SA,CT,p), which uses the computationally</span>
<span class="cm">%  efficient polynomial for specific volume in terms of SA, CT and p</span>
<span class="cm">%  (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  CT  =  Conservative Temperature (ITS-90)                       [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  rho_SA_SA = The second-order derivative of rho with respect to</span>
<span class="cm">%              Absolute Salinity at constant CT &amp; p.  [ (kg/m^3)(g/kg)^-2 ]</span>
<span class="cm">%  rho_SA_CT = The second-order derivative of rho with respect to</span>
<span class="cm">%              SA and CT at constant p.          [ (kg/m^3)(g/kg)^-1 K^-1 ]</span>
<span class="cm">%  rho_CT_CT = The second-order derivative of rho with respect to CT at</span>
<span class="cm">%              constant SA &amp; p                            [ (kg/m^3) K^-2 ]</span>
<span class="cm">%  rho_SA_P  = The second-order derivative with respect to SA &amp; P at</span>
<span class="cm">%              constant CT.                    [ (kg/m^3) (g/kg)^-1 Pa^-1 ]</span>
<span class="cm">%  rho_CT_P  = The second-order derivative with respect to CT &amp; P at</span>
<span class="cm">%              constant SA.                         [ (kg/m^3) K^-1 Pa^-1 ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See appendix A.20 and appendix K of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rho_second_derivatives_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">rho_SA_SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">rho_SA_CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">rho_CT_CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">rho_SA_P</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">rho_CT_P</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA_SA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_CT_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_CT_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rec_v</span><span class="p">,</span><span class="w"> </span><span class="n">rec_v2</span><span class="p">,</span><span class="w"> </span><span class="n">rec_v3</span><span class="p">,</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">rec_v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gsw_specvol_CT_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsw_specvol_first_derivatives_CT_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_CT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_P</span><span class="p">);</span>
<span class="w">  </span><span class="n">gsw_specvol_second_derivatives_CT_exact</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA_SA</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA_CT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_CT_CT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA_P</span><span class="p">,</span>
<span class="w">    </span><span class="o">*</span><span class="n">v_CT_P</span><span class="p">);</span>

<span class="w">  </span><span class="n">rec_v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rec_v</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v</span><span class="p">;</span>
<span class="w">  </span><span class="n">rec_v3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rec_v2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v</span><span class="p">;</span>

<span class="w">  </span><span class="o">*</span><span class="n">rho_CT_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-*</span><span class="n">v_CT_CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">v_CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">v_CT</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v3</span><span class="p">;</span>

<span class="w">  </span><span class="o">*</span><span class="n">rho_SA_CT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-*</span><span class="n">v_SA_CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">v_CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v3</span><span class="p">;</span>

<span class="w">  </span><span class="o">*</span><span class="n">rho_SA_SA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-*</span><span class="n">v_SA_SA</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">v_SA</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v3</span><span class="p">;</span>

<span class="w">  </span><span class="o">*</span><span class="n">rho_SA_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-*</span><span class="n">v_SA_P</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">v_SA</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">v_P</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v3</span><span class="p">;</span>

<span class="w">  </span><span class="o">*</span><span class="n">rho_CT_P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-*</span><span class="n">v_CT_P</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">v_CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">v_P</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rec_v3</span><span class="p">;</span>

<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">v_SA_SA</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">v_SA_CT</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">v_CT_CT</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">v_SA_P</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">v_CT_P</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">v_SA</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">v_CT</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">v_P</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_specvol_diff         specific volume difference between two pressures</span>
<span class="cm">%                                                        (75-term equation)</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE: gsw_specvol_diff(SA,CT,p_shallow,p_deep)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the difference of the specific volume of seawater between</span>
<span class="cm">%  two different pressures, p_deep (the deeper pressure) and p_shallow</span>
<span class="cm">%  (the shallower pressure), at the same values of SA and CT.  This</span>
<span class="cm">%  function uses the computationally-efficient expression for specific</span>
<span class="cm">%  volume in terms of SA, CT and p (Roquet et al., 2015).  The output</span>
<span class="cm">%  (specvol_diff) is the specific volume evaluated at (SA,CT,p_deep)</span>
<span class="cm">%  minus the specific volume at (SA,CT,p_shallow).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this 75-term equation has been fitted in a restricted range of</span>
<span class="cm">%  parameter space, and is most accurate inside the &quot;oceanographic funnel&quot;</span>
<span class="cm">%  described in McDougall et al. (2003).  The GSW library function</span>
<span class="cm">%  &quot;gsw_infunnel(SA,CT,p)&quot; is avaialble to be used if one wants to test if</span>
<span class="cm">%  some of one|s data lies outside this &quot;funnel&quot;.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA     =  Absolute Salinity                                     [ g/kg ]</span>
<span class="cm">%  CT     =  Conservative Temperature (ITS-90)                    [ deg C ]</span>
<span class="cm">%  p_shallow  =  upper sea pressure                                [ dbar ]</span>
<span class="cm">%                ( i.e. shallower absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  p_deep     =  lower sea pressure                                [ dbar ]</span>
<span class="cm">%                ( i.e. deeper absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  specvol_diff  =  difference of specific volume                [ m^3/kg ]</span>
<span class="cm">%                       (deep minus shallow)</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqn. (3.7.3) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., D.R. Jackett, D.G. Wright and R. Feistel, 2003:</span>
<span class="cm">%   Accurate and computationally efficient algorithms for potential</span>
<span class="cm">%   temperature and density of seawater.  J. Atmosph. Ocean. Tech., 20,</span>
<span class="cm">%   pp. 730-741.</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">% The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_specvol_diff</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p_shallow</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p_deep</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v011</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.8505765429e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.1736386731e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v013</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.6527006553e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v014</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.1454099902e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v021</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.1716606853e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v022</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.1305028740e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v023</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.8695905159e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v031</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.9279656173e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v032</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.6132540037e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v041</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.4102187482e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v042</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.3352916514e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v051</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0736766814e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v101</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.4262468747e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v102</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5.8484432984e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v103</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.6310188515e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v104</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.1147125423e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v121</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-2.3678308361e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v122</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.9137387080e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v131</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.4558773655e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v132</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.7618888092e-9</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v141</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.2956717783e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v201</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-3.4792460974e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v202</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.8122251597e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v203</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.6746303780e-8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v211</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.1100834765e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v212</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.4620748834e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v231</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.1655306078e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v301</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.7470777305e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v302</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.9263106998e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v311</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-9.8447117844e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v312</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.3544185627e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v321</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-4.8826139200e-7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v401</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.7322218612e-5</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v402</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.7811974727e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v411</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.5909225260e-6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">v501</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.0927427253e-6</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">dz</span><span class="p">,</span><span class="w"> </span><span class="n">z_part_2</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z_shallow</span><span class="p">,</span><span class="w"> </span><span class="n">z_shallow2</span><span class="p">,</span><span class="w"> </span><span class="n">z_shallow3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">z_deep</span><span class="p">,</span><span class="w"> </span><span class="n">z_deep2</span><span class="p">,</span><span class="w"> </span><span class="n">z_deep_times_z_shallow</span><span class="p">,</span><span class="w"> </span><span class="n">z_deep2_plus_z_shallow2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xy_part_1</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_2</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_3</span><span class="p">,</span><span class="w"> </span><span class="n">xy_part_4</span><span class="p">,</span><span class="w"> </span><span class="n">z_part_3</span><span class="p">,</span><span class="w"> </span><span class="n">z_part_4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">z_part_5</span><span class="p">,</span><span class="w"> </span><span class="n">z_part_6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">sa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SA</span><span class="p">;}</span>

<span class="w">  </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">;</span>
<span class="w">  </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">offset</span><span class="p">);</span>
<span class="w">  </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="w">  </span><span class="n">z_shallow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_shallow</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="p">;</span>
<span class="w">  </span><span class="n">z_deep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_deep</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">rec_db2pa</span><span class="p">;</span>

<span class="w">  </span><span class="n">xy_part_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v001</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v401</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v501</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v111</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v311</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v411</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v021</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v221</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v321</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v231</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v041</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v141</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v051</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))));</span>

<span class="w">  </span><span class="n">xy_part_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v002</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v302</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v402</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v012</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v212</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v312</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v122</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v222</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v032</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v132</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v042</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)));</span>

<span class="w">  </span><span class="n">xy_part_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v203</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">v013</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v113</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v023</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">);</span>

<span class="w">  </span><span class="n">xy_part_4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v004</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v104</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v014</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">;</span>

<span class="w">  </span><span class="n">dz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_deep</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">z_shallow</span><span class="p">;</span>

<span class="w">  </span><span class="n">z_part_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_deep</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z_shallow</span><span class="p">;</span>

<span class="w">  </span><span class="n">z_deep2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_deep</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_deep</span><span class="p">;</span>
<span class="w">  </span><span class="n">z_shallow2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_shallow</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_shallow</span><span class="p">;</span>
<span class="w">  </span><span class="n">z_deep_times_z_shallow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_deep</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_shallow</span><span class="p">;</span>
<span class="w">  </span><span class="n">z_deep2_plus_z_shallow2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_deep2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z_shallow2</span><span class="p">;</span>

<span class="w">  </span><span class="n">z_part_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_deep2_plus_z_shallow2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z_deep_times_z_shallow</span><span class="p">;</span>

<span class="w">  </span><span class="n">z_part_4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_part_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_deep2_plus_z_shallow2</span><span class="p">;</span>

<span class="w">  </span><span class="n">z_shallow3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_shallow</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_shallow2</span><span class="p">;</span>

<span class="w">  </span><span class="n">z_part_5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_deep2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_part_3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z_shallow3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_part_2</span><span class="p">;</span>

<span class="w">  </span><span class="n">z_part_6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_part_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_part_3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">z_deep2_plus_z_shallow2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">z_deep_times_z_shallow</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">dz</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">xy_part_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z_part_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xy_part_2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z_part_3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xy_part_3</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z_part_4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xy_part_4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z_part_5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v005</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z_part_6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v006</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_N2sol                                    solubility of N2 in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  N2sol = gsw_N2sol(SA,CT,p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the nitrogen, N2, concentration expected at equilibrium with</span>
<span class="cm">%  air at an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar)</span>
<span class="cm">%  including saturated water vapor.  This function uses the solubility</span>
<span class="cm">%  coefficients as listed in Hamme and Emerson (2004).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity                                      [ g/kg ]</span>
<span class="cm">%  CT    =  Conservative Temperature (ITS-90)                     [ deg C ]</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%           ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon  =  longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  N2sol = solubility of nitrogen in micro-moles per kg         [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Hamme, R., and S. Emerson, 2004: The solubility of neon, nitrogen and</span>
<span class="cm">%   argon in distilled water and seawater. Deep-Sea Research, 51,</span>
<span class="cm">%   1517-1528.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_N2sol</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="c1">// The coefficents below are from Table 4 of Hamme and Emerson (2004)</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.42931</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.92704</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.32531</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.69149</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.44129e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-8.02566e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.46775e-2</span><span class="p">;</span>

<span class="w">   </span><span class="c1">// Note that salinity argument is Practical Salinity, this is</span>
<span class="w">   </span><span class="c1">// beacuse the major ionic components of seawater related to Cl</span>
<span class="w">   </span><span class="c1">// are what affect the solubility of non-electrolytes in seawater.</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">N2sol</span><span class="p">,</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sp_from_sa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">);</span><span class="w"> </span><span class="c1">// pt is potential temperature referenced to the sea surface.</span>

<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">298.15</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt</span><span class="p">));</span><span class="w">   </span><span class="c1">// pt is the temperature in degress C</span>
<span class="w">                                                </span><span class="c1">// on the 1990 International Temperature Scale ITS-90.</span>

<span class="w">  </span><span class="n">N2sol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">N2sol</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_N2Osol                                  solubility of N2O in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  N2Osol = gsw_N2Osol(SA,CT,p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the nitrous oxide, N2O, concentration expected at equilibrium</span>
<span class="cm">%  with air at an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar)</span>
<span class="cm">%  including saturated water vapor.  This function uses the solubility</span>
<span class="cm">%  coefficients as listed in Weiss and Price (1980).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity                                      [ g/kg ]</span>
<span class="cm">%  CT    =  Conservative Temperature (ITS-90)                     [ deg C ]</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%           ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon  =  longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  N2Osol = solubility of nitrous oxide                           [ mol/L ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Rich Pawlowicz, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Weiss, R.F., and B.A. Price, 1980: Nitrous oxide solubility in water and</span>
<span class="cm">%   seawater. Mar. Chem., 8, 347-359.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_N2Osol</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">ph2odP</span><span class="p">,</span><span class="w"> </span><span class="n">y_100</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pt68</span><span class="p">,</span><span class="w"> </span><span class="n">N2Osol</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sp_from_sa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">   </span><span class="c1">// The coefficents below are from Table 2 of Weiss and Price (1980)</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-165.8806</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">222.8743</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">92.0792</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.48425</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.056235</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.031619</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.0048472</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">m0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">24.4543</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">67.4509</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">m2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.8489</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.000544</span><span class="p">;</span>

<span class="w">   </span><span class="c1">// Note that salinity argument is Practical Salinity, this is</span>
<span class="w">   </span><span class="c1">// beacuse the major ionic components of seawater related to Cl</span>
<span class="w">   </span><span class="c1">// are what affect the solubility of non-electrolytes in seawater.</span>

<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">);</span><span class="w"> </span><span class="c1">// pt is potential temperature referenced to the sea surface.</span>

<span class="w">  </span><span class="n">pt68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span><span class="w">  </span><span class="c1">// pt68 is the potential temperature in degress C on</span>
<span class="w">                        </span><span class="c1">// the 1968 International Practical Temperature Scale IPTS-68.</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_100</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span>

<span class="w">  </span><span class="n">ph2odP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">m0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">y_100</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SP</span><span class="p">);</span><span class="w">  </span><span class="c1">// Moist air correction at 1 atm.</span>

<span class="w">  </span><span class="n">N2Osol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">y_100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y_100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                 </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="p">))))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ph2odP</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">N2Osol</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Gibbs_energy_t_exact                         Gibbs energy of seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  Gibbs_energy_t_exact = gsw_Gibbs_energy_t_exact(SA,t,p)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the Gibbs energy of seawater.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA  =  Absolute Salinity                                        [ g/kg ]</span>
<span class="cm">%  t   =  in-situ temperature (ITS-90)                            [ deg C ]</span>
<span class="cm">%  p   =  sea pressure                                             [ dbar ]</span>
<span class="cm">%         ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Gibbs_energy_t_exact = Gibbs energy                             [ J/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Paul Barker and Trevor McDougall                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See section 2.13 of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Gibbs_energy_t_exact</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gibbs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Hesol                                    solubility of He in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  Hesol = gsw_Hesol(SA,CT,p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the helium concentration expected at equilibrium with air at</span>
<span class="cm">%  an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar) including</span>
<span class="cm">%  saturated water vapor.  This function uses the solubility coefficients</span>
<span class="cm">%  as listed in Weiss (1971).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity                                      [ g/kg ]</span>
<span class="cm">%  CT    =  Conservative Temperature (ITS-90)                     [ deg C ]</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%           ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon  =  longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Hesol = solubility of helium in micro-moles per kg           [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Dymond and Smith, 1980: The virial coefficients of pure gases and</span>
<span class="cm">%   mixtures. Clarendon Press, Oxford.</span>
<span class="cm">%</span>
<span class="cm">%  Weiss, R.F., 1971: Solubility of Helium and Neon in Water and Seawater.</span>
<span class="cm">%   J. Chem. and Engineer. Data, 16, 235-241.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Hesol</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">He_ml2umol</span><span class="p">,</span><span class="w"> </span><span class="n">Hesol</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y_100</span><span class="p">,</span><span class="w"> </span><span class="n">pt68</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sp_from_sa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">   </span><span class="c1">// Note that salinity argument is Practical Salinity, this is</span>
<span class="w">   </span><span class="c1">// beacuse the major ionic components of seawater related to Cl</span>
<span class="w">   </span><span class="c1">// are what affect the solubility of non-electrolytes in seawater.</span>

<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">);</span><span class="c1">// pt is potential temperature referenced to</span>
<span class="w">                              </span><span class="c1">// the sea surface.</span>

<span class="w">  </span><span class="n">pt68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span><span class="w">  </span><span class="c1">// pt68 is the potential temperature in degress C on</span>
<span class="w">                        </span><span class="c1">// the 1968 International Practical Temperature Scale IPTS-68.</span>

<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_100</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span>

<span class="w">   </span><span class="c1">// The coefficents below are from Table 3 of Weiss (1971)</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-167.2178</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">216.3442</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">139.2032</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-22.6202</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.044781</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.023541</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.0034266</span><span class="p">;</span>

<span class="w">  </span><span class="n">Hesol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">y_100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="p">)));</span>

<span class="w">  </span><span class="n">He_ml2umol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.455817671505537e1</span><span class="p">;</span><span class="w"> </span><span class="c1">// mL/kg to umol/kg for He (1/22.44257e-3)</span>
<span class="w">                                    </span><span class="c1">// Molar volume at STP (Dymond and Smith, 1980).</span>
<span class="w">  </span><span class="n">Hesol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hesol</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">He_ml2umol</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Hesol</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Krsol                                    solubility of Kr in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_Krsol(SA,CT,p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the krypton, Kr, concentration expected at equilibrium with</span>
<span class="cm">%  air at an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar)</span>
<span class="cm">%  including saturated water vapor.  This function uses the solubility</span>
<span class="cm">%  coefficients derived from the data of Weiss and Kyser (1978).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity                                      [ g/kg ]</span>
<span class="cm">%  CT    =  Conservative Temperature (ITS-90)                     [ deg C ]</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%           ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon  =  longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Krsol = solubility of krypton in micro-moles per kg          [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Weiss, R.F., and T.K. Kyser, 1978: Solubility of Krypton in Water and</span>
<span class="cm">%   Seawater. J. Chem. Thermodynamics, 23, 69-72.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Krsol</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">Kr_ml2umol</span><span class="p">,</span><span class="w"> </span><span class="n">Krsol</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">pt68</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y_100</span><span class="p">,</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sp_from_sa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">   </span><span class="c1">// Note that salinity argument is Practical Salinity, this is</span>
<span class="w">   </span><span class="c1">// beacuse the major ionic components of seawater related to Cl</span>
<span class="w">   </span><span class="c1">// are what affect the solubility of non-electrolytes in seawater.</span>

<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">);</span><span class="c1">// pt is potential temperature referenced to</span>
<span class="w">                              </span><span class="c1">// the sea surface.</span>

<span class="w">  </span><span class="n">pt68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.00024</span><span class="p">;</span><span class="w">  </span><span class="c1">// pt68 is the potential temperature in degress C on</span>
<span class="w">                        </span><span class="c1">// the 1968 International Practical Temperature Scale IPTS-68.</span>

<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pt68</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_t0</span><span class="p">;</span>
<span class="w">  </span><span class="n">y_100</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">;</span>

<span class="w">   </span><span class="c1">// Table 2 (Weiss and Kyser, 1978)</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-112.6840</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">153.5817</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">74.4690</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-10.0189</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.011213</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.001844</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0011201</span><span class="p">;</span>

<span class="w">  </span><span class="n">Krsol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">y_100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y_100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y_100</span><span class="p">)));</span>

<span class="w">  </span><span class="n">Kr_ml2umol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.474052731185490e1</span><span class="p">;</span><span class="w">    </span><span class="c1">// mL/kg to umol/kg for Kr (1/22.3511e-3)</span>
<span class="w">                                       </span><span class="c1">// Molar volume at STP (Dymond and Smith, 1980).</span>

<span class="w">  </span><span class="n">Krsol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Krsol</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Kr_ml2umol</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Krsol</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_enthalpy_diff_CT_exact        difference of enthalpy at two pressures</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_enthalpy_diff_CT_exact(SA,CT,p_shallow,p_deep)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the difference of the specific enthalpy of seawater between</span>
<span class="cm">%  two different pressures, p_deep (the deeper pressure) and p_shallow</span>
<span class="cm">%  (the shallower pressure), at the same values of SA and CT.  The output</span>
<span class="cm">%  (enthalpy_diff_CT_exact) is the specific enthalpy evaluated at</span>
<span class="cm">%  (SA,CT,p_deep) minus the specific enthalpy at (SA,CT,p_shallow).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this function uses the full Gibbs function.  There is an</span>
<span class="cm">%  alternative to calling this function, namely gsw_enthalpy_diff(SA,CT,p),</span>
<span class="cm">%  which uses the computationally efficient 75-term expression for specific</span>
<span class="cm">%  volume in terms of SA, CT and p (Roquet et al., 2015).</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA        =  Absolute Salinity                                  [ g/kg ]</span>
<span class="cm">%  CT        =  Conservative Temperature (ITS-90)                 [ deg C ]</span>
<span class="cm">%  p_shallow =  upper sea pressure                                 [ dbar ]</span>
<span class="cm">%               ( i.e. shallower absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  p_deep    =  lower sea pressure                                 [ dbar ]</span>
<span class="cm">%               ( i.e. deeper absolute pressure - 10.1325 dbar )</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  enthalpy_diff_CT_exact = difference of specific enthalpy        [ J/kg ]</span>
<span class="cm">%                           (deep minus shallow)</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:</span>
<span class="cm">%  Trevor McDougall and Paul Barker                    [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%    See Eqns. (3.32.2) of this TEOS-10 Manual.</span>
<span class="cm">%</span>
<span class="cm">%  McDougall, T.J., 2003: Potential enthalpy: A conservative oceanic</span>
<span class="cm">%   variable for evaluating heat content and heat fluxes. Journal of</span>
<span class="cm">%   Physical Oceanography, 33, 945-963.</span>
<span class="cm">%    See Eqns. (18) and (22)</span>
<span class="cm">%</span>
<span class="cm">%  Roquet, F., G. Madec, T.J. McDougall, P.M. Barker, 2015: Accurate</span>
<span class="cm">%   polynomial expressions for the density and specifc volume of seawater</span>
<span class="cm">%   using the TEOS-10 standard. Ocean Modelling., 90, pp. 29-43.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_enthalpy_diff_CT_exact</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p_shallow</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">p_deep</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t_shallow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p_shallow</span><span class="p">);</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">t_deep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_t_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="n">p_deep</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_enthalpy_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t_deep</span><span class="p">,</span><span class="w"> </span><span class="n">p_deep</span><span class="p">)</span><span class="w"> </span><span class="o">-</span>
<span class="w">         </span><span class="n">gsw_enthalpy_t_exact</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">t_shallow</span><span class="p">,</span><span class="w"> </span><span class="n">p_shallow</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">% gsw_Arsol                                    solubility of Ar in seawater</span>
<span class="cm">%==========================================================================</span>
<span class="cm">%</span>
<span class="cm">% USAGE:</span>
<span class="cm">%  gsw_Arsol(SA,CT,p,lon,lat)</span>
<span class="cm">%</span>
<span class="cm">% DESCRIPTION:</span>
<span class="cm">%  Calculates the argon, Ar, concentration expected at equilibrium with air</span>
<span class="cm">%  at an Absolute Pressure of 101325 Pa (sea pressure of 0 dbar) including</span>
<span class="cm">%  saturated water vapor.  This function uses the solubility coefficients</span>
<span class="cm">%  as listed in Hamme and Emerson (2004).</span>
<span class="cm">%</span>
<span class="cm">%  Note that this algorithm has not been approved by IOC and is not work</span>
<span class="cm">%  from SCOR/IAPSO Working Group 127. It is included in the GSW</span>
<span class="cm">%  Oceanographic Toolbox as it seems to be oceanographic best practice.</span>
<span class="cm">%</span>
<span class="cm">% INPUT:</span>
<span class="cm">%  SA    =  Absolute Salinity                                      [ g/kg ]</span>
<span class="cm">%  CT    =  Conservative Temperature (ITS-90)                     [ deg C ]</span>
<span class="cm">%  p     =  sea pressure                                           [ dbar ]</span>
<span class="cm">%           ( i.e. absolute pressure - 10.1325 dbar )</span>
<span class="cm">%  lon  =  longitude in decimal degrees                     [ 0 ... +360 ]</span>
<span class="cm">%                                                     or  [ -180 ... +180 ]</span>
<span class="cm">%  lat   =  latitude in decimal degrees north               [ -90 ... +90 ]</span>
<span class="cm">%</span>
<span class="cm">% OUTPUT:</span>
<span class="cm">%  Arsol = solubility of argon                                  [ umol/kg ]</span>
<span class="cm">%</span>
<span class="cm">% AUTHOR:  Roberta Hamme, Paul Barker and Trevor McDougall</span>
<span class="cm">%                                                      [ help@teos-10.org ]</span>
<span class="cm">%</span>
<span class="cm">% VERSION NUMBER: 3.06.12 (25th May, 2020)</span>
<span class="cm">%</span>
<span class="cm">% REFERENCES:</span>
<span class="cm">%  IOC, SCOR and IAPSO, 2010: The international thermodynamic equation of</span>
<span class="cm">%   seawater - 2010: Calculation and use of thermodynamic properties.</span>
<span class="cm">%   Intergovernmental Oceanographic Commission, Manuals and Guides No. 56,</span>
<span class="cm">%   UNESCO (English), 196 pp.  Available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%  Hamme, R., and S. Emerson, 2004: The solubility of neon, nitrogen and</span>
<span class="cm">%   argon in distilled water and seawater. Deep-Sea Research, 51,</span>
<span class="cm">%   1517-1528.</span>
<span class="cm">%</span>
<span class="cm">%  The software is available from http://www.TEOS-10.org</span>
<span class="cm">%</span>
<span class="cm">%==========================================================================</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_Arsol</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">CT</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sp_from_sa</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>

<span class="w">  </span><span class="n">pt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pt_from_ct</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span><span class="w"> </span><span class="n">CT</span><span class="p">);</span>
<span class="w">   </span><span class="c1">//pt is potential temperature referenced to the sea surface.</span>

<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">((</span><span class="mf">298.15</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pt</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">273.15</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pt</span><span class="p">));</span>
<span class="w">   </span><span class="c1">// pt is the temperature in degress C on the 1990 International Temperature Scale ITS-90.</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.79150</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.17609</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.13116</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.90379</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6.96233e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-7.66670e-3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.16888e-2</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">a0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)));</span>
<span class="p">}</span>

<span class="cm">/**************************************</span>
<span class="cm">   ======</span>
<span class="cm">   method: gsw_rtIsNaN</span>
<span class="cm">   ======</span>
<span class="cm">   returns true or false depending on</span>
<span class="cm">   equality or not of rtNaN with val</span>
<span class="cm">**************************************/</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rtIsNaN</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rtNaN</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*************************************************************************************************</span>
<span class="cm">    Functions for pchip interpolation</span>
<span class="cm">    (Piecewise Cubic Hermite Interpolating Polynomial)</span>
<span class="cm">    based on</span>
<span class="cm">    https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.PchipInterpolator.html#</span>
<span class="cm">    scipy.interpolate.PchipInterpolator</span>
<span class="cm">    See references therein.</span>
<span class="cm">    This is a shape-preserving algorithm, in the sense that it does not</span>
<span class="cm">    overshoot the original points; extrema of the interpolated curve match</span>
<span class="cm">    the extrema of the original points.</span>
<span class="cm">***************************************************************************************************/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sgn</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="p">((</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(((</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_pchip_derivs(*x,*y,n,*d)</span>
<span class="cm">=======</span>
<span class="cm">    Calculation of the derivatives is the key to the shape-preservation.</span>
<span class="cm">    There are other algorithms that could be used, but this appears to be</span>
<span class="cm">    the simplest, and adequate for our purposes.</span>
<span class="cm">    At minimal computational cost, we include here a check for increasing x.</span>
<span class="cm">    Returns 0 on success, 1 if x is not strictly increasing.</span>
<span class="cm">****************************************************************************/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pchip_derivs</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">hm</span><span class="p">,</span><span class="w"> </span><span class="n">hp</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">smm</span><span class="p">,</span><span class="w"> </span><span class="n">smp</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">w1</span><span class="p">,</span><span class="w"> </span><span class="n">w2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">hm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">  </span><span class="n">hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="w">  </span><span class="n">mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">hm</span><span class="p">;</span>
<span class="w">  </span><span class="n">mp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">hp</span><span class="p">;</span>
<span class="w">  </span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pchip_edge_case</span><span class="p">(</span><span class="n">hm</span><span class="p">,</span><span class="w"> </span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">);</span>
<span class="w">  </span><span class="n">smm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sgn</span><span class="p">(</span><span class="n">mm</span><span class="p">);</span>
<span class="w">  </span><span class="n">smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sgn</span><span class="p">(</span><span class="n">mp</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hm</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">smm</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">smp</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mm</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">w1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hm</span><span class="p">;</span>
<span class="w">      </span><span class="n">w2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hm</span><span class="p">;</span>
<span class="w">      </span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">w1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">w1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">mm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">mp</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">hm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hp</span><span class="p">;</span>
<span class="w">      </span><span class="n">hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">      </span><span class="n">mm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="p">;</span>
<span class="w">      </span><span class="n">mp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">hp</span><span class="p">;</span>
<span class="w">      </span><span class="n">smm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp</span><span class="p">;</span>
<span class="w">      </span><span class="n">smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sgn</span><span class="p">(</span><span class="n">mp</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_pchip_edge_case</span><span class="p">(</span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="n">hm</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_pchip_edge_case(h0,h1,m0,m1)</span>
<span class="cm">=======</span>
<span class="cm">****************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_pchip_edge_case</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">h0</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">h1</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">m0</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">mask</span><span class="p">,</span><span class="w"> </span><span class="n">mask2</span><span class="p">;</span>
<span class="w">  </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">h0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">h1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">h0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">h1</span><span class="p">);</span>
<span class="w">  </span><span class="n">mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_sgn</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">gsw_sgn</span><span class="p">(</span><span class="n">m0</span><span class="p">);</span>
<span class="w">  </span><span class="n">mask2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">gsw_sgn</span><span class="p">(</span><span class="n">m0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">gsw_sgn</span><span class="p">(</span><span class="n">m1</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">m0</span><span class="p">));</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">mask</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">mask2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*************************************************************************</span>
<span class="cm">==========================================================================</span>
<span class="cm">method: gsw_add_barrier(input_data,lon,lat,long_grid,lat_grid,dlong_grid,</span>
<span class="cm">                        dlat_grid,output_data)</span>
<span class="cm">==========================================================================</span>
<span class="cm">  Adds a barrier through Central America (Panama) and then averages</span>
<span class="cm">  over the appropriate side of the barrier</span>
<span class="cm">  data_in      :  data                                         [unitless]</span>
<span class="cm">  lon          :  Longitudes of data degrees east              [0 ... +360]</span>
<span class="cm">  lat          :  Latitudes of data degrees north              [-90 ... +90]</span>
<span class="cm">  longs_grid   :  Longitudes of regular grid degrees east      [0 ... +360]</span>
<span class="cm">  lats_grid    :  Latitudes of regular grid degrees north      [-90 ... +90]</span>
<span class="cm">  dlongs_grid  :  Longitude difference of regular grid degrees [deg longitude]</span>
<span class="cm">  dlats_grid   :  Latitude difference of regular grid degrees  [deg latitude]</span>
<span class="cm">  output_data  : average of data depending on which side of the</span>
<span class="cm">                 Panama canal it is on                         [unitless]</span>
<span class="cm">**************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_add_barrier</span><span class="p">(</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">input_data</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">long_grid</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lat_grid</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">dlong_grid</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">dlat_grid</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">output_data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">above_line</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nmean</span><span class="p">,</span><span class="w"> </span><span class="n">above_line0</span><span class="p">,</span><span class="w"> </span><span class="n">kk</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">lats_line</span><span class="p">,</span><span class="w"> </span><span class="n">data_mean</span><span class="p">;</span>

<span class="w">  </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_indx</span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">,</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">);</span>
<span class="w">  </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lon</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
<span class="w">  </span><span class="n">lats_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
<span class="w">  </span><span class="n">above_line0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lats_line</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat</span><span class="p">);</span>
<span class="w">  </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_indx</span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">,</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">npan</span><span class="p">,</span><span class="w"> </span><span class="n">long_grid</span><span class="p">);</span>
<span class="w">  </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">long_grid</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
<span class="w">  </span><span class="n">lats_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
<span class="w">  </span><span class="n">above_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lats_line</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat_grid</span><span class="p">);</span>
<span class="w">  </span><span class="n">above_line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lats_line</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat_grid</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dlat_grid</span><span class="p">);</span>
<span class="w">  </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_indx</span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">long_grid</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dlong_grid</span><span class="p">);</span>
<span class="w">  </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">long_grid</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dlong_grid</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">/</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">longs_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
<span class="w">  </span><span class="n">lats_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gsaar</span><span class="p">.</span><span class="n">lats_pan</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
<span class="w">  </span><span class="n">above_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lats_line</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat_grid</span><span class="p">);</span>
<span class="w">  </span><span class="n">above_line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lats_line</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lat_grid</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dlat_grid</span><span class="p">);</span>
<span class="w">  </span><span class="n">nmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">data_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">fabs</span><span class="p">(</span><span class="n">input_data</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">100.0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">above_line0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">above_line</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">nmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nmean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">data_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_mean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">input_data</span><span class="p">[</span><span class="n">kk</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nmean</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">data_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">data_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_mean</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">nmean</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">fabs</span><span class="p">(</span><span class="n">input_data</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1.0e10</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">above_line0</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">above_line</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">output_data</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_mean</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">output_data</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_data</span><span class="p">[</span><span class="n">kk</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*************************************************************************</span>
<span class="cm">==========================================================================</span>
<span class="cm">method: gsw_add_mean(data_in,data_out)</span>
<span class="cm">==========================================================================</span>
<span class="cm"> Replaces NaNs with non-nan mean of the 4 adjacent neighbours</span>
<span class="cm"> data_in   : data set of the 4 adjacent neighbours[double]</span>
<span class="cm"> data_out : non-nan mean of the 4 adjacent neighbours     [unitless]</span>
<span class="cm">*************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_add_mean</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">data_in</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">data_out</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">data_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">data_in</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">100.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">nmean</span><span class="o">++</span><span class="p">;</span>
<span class="w">      </span><span class="n">data_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_mean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">data_in</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nmean</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">data_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">data_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_mean</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">nmean</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">data_in</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">100.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">data_out</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_mean</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">data_out</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_in</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">   =======</span>
<span class="cm">   method: gsw_rr68_interp_section (sectnum, ip_sect, ip_isect, sa_i, ct_i)</span>
<span class="cm">   =======</span>
<span class="cm">****************************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_rr68_interp_section</span><span class="p">(</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">sectnum</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nsect</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ip_sect</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ip_isect</span><span class="p">,</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">p_i</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">sa_i</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct_i</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w">     </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">ip_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">ip_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">ip_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">ip_4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ct_12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">ct_13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">ct_23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">ct_34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="o">*</span><span class="n">ct_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">sa_12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">sa_13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">sa_23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="o">*</span><span class="n">sa_34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">sa_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p_ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">ctp1</span><span class="p">,</span><span class="w"> </span><span class="n">ctp2</span><span class="p">,</span><span class="w"> </span><span class="n">ctref_denom</span><span class="p">,</span><span class="w"> </span><span class="n">ct_ref_minus_ctp1</span><span class="p">,</span><span class="w"> </span><span class="n">ct_ref_minus_ctp2</span><span class="p">,</span>
<span class="w">    </span><span class="n">ctref_num</span><span class="p">,</span><span class="w"> </span><span class="n">gamma1_23</span><span class="p">,</span><span class="w"> </span><span class="n">gamma1_24</span><span class="p">,</span><span class="w"> </span><span class="n">gamma2_31</span><span class="p">,</span><span class="w"> </span><span class="n">gamma2_34</span><span class="p">,</span><span class="w"> </span><span class="n">saref_num</span><span class="p">,</span>
<span class="w">    </span><span class="n">gamma2_41</span><span class="p">,</span><span class="w"> </span><span class="n">gamma3_12</span><span class="p">,</span><span class="w"> </span><span class="n">gamma3_42</span><span class="p">,</span><span class="w"> </span><span class="n">gamma4_12</span><span class="p">,</span><span class="w"> </span><span class="n">gamma4_23</span><span class="p">,</span>
<span class="w">    </span><span class="n">sap1</span><span class="p">,</span><span class="w"> </span><span class="n">sap2</span><span class="p">,</span><span class="w"> </span><span class="n">saref_denom</span><span class="p">,</span><span class="w"> </span><span class="n">sa_ref_minus_sap1</span><span class="p">,</span><span class="w"> </span><span class="n">sa_ref_minus_sap2</span><span class="p">;</span>


<span class="w">  </span><span class="n">ip_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">];</span>
<span class="w">  </span><span class="n">ip_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">ip_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">ip_4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>

<span class="w">  </span><span class="n">ct_12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="p">[</span><span class="mi">12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">];</span>
<span class="w">  </span><span class="n">sa_12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">sa_13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">sa_23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">sa_34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">sa_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">ct_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>
<span class="w">  </span><span class="n">p_ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sectnum</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="n">ip_sect</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">      </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="n">ip_sect</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sectnum</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="n">ip_sect</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">      </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="n">ip_sect</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sectnum</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="n">ip_sect</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">      </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="n">ip_sect</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_i</span><span class="p">[</span><span class="n">ip_isect</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">sa</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>
<span class="w">    </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">ct</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.7</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sectnum</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">gsw_linear_interp_sa_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="n">p_ii</span><span class="p">,</span><span class="w"> </span><span class="n">nsect</span><span class="p">,</span><span class="w"> </span><span class="n">sa_23</span><span class="p">,</span><span class="w"> </span><span class="n">ct_23</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">sa</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">ct</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">saref_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">      </span><span class="n">ctref_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">      </span><span class="n">saref_denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>

<span class="w">      </span><span class="n">ctref_denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">saref_denom</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">;</span>
<span class="w">        </span><span class="n">saref_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">        </span><span class="n">saref_denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ctref_denom</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">;</span>

<span class="w">        </span><span class="n">ctref_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">        </span><span class="n">ctref_denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="n">sa_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">saref_num</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">saref_denom</span><span class="p">));</span>
<span class="w">      </span><span class="n">ct_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ctref_num</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">ctref_denom</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">gsw_linear_interp_sa_ct</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="n">p_ii</span><span class="p">,</span><span class="w"> </span><span class="n">nsect</span><span class="p">,</span><span class="w"> </span><span class="n">sa_12</span><span class="p">,</span><span class="w"> </span><span class="n">ct_12</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sa_13</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">sa</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">ct_13</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">ct</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">sa</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">ct</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span>
<span class="w">        </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">saref_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_13</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">      </span><span class="n">ctref_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_13</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">      </span><span class="n">saref_denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_13</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>

<span class="w">      </span><span class="n">ctref_denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_13</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">saref_denom</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">;</span>

<span class="w">        </span><span class="n">saref_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_13</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">        </span><span class="n">saref_denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sa_13</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ctref_denom</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">;</span>

<span class="w">        </span><span class="n">ctref_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_34</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_13</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">        </span><span class="n">ctref_denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_23</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="n">pow</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ct_13</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="n">sa_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">sa_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">saref_num</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">saref_denom</span><span class="p">));</span>
<span class="w">      </span><span class="n">ct_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ct_12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ctref_num</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">ctref_denom</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nsect</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">gamma1_23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">      </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">    </span><span class="n">gamma2_31</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">      </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">    </span><span class="n">gamma3_12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">      </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sectnum</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">gamma2_34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">        </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">gamma3_42</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">        </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">gamma4_23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">        </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">gamma1_24</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">        </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">gamma2_41</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">        </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>

<span class="w">      </span><span class="n">gamma4_12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p_ii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span><span class="w"> </span><span class="o">/</span>
<span class="w">        </span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">sap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gamma1_23</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma2_31</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gamma3_12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>

<span class="w">    </span><span class="n">ctp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gamma1_23</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma2_31</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">gamma3_12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sectnum</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gamma2_34</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma3_42</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">gamma4_23</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>

<span class="w">      </span><span class="n">ctp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gamma2_34</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma3_42</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_3</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">gamma4_23</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gamma1_24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma2_41</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">gamma4_12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sa</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>

<span class="w">      </span><span class="n">ctp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gamma1_24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gamma2_41</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="n">gamma4_12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ct</span><span class="p">[</span><span class="n">ip_4</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">sa_ref_minus_sap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sap1</span><span class="p">);</span>
<span class="w">    </span><span class="n">sa_ref_minus_sap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sap2</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sa_ref_minus_sap1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">sa_ref_minus_sap2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">sa_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sa_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">;</span>
<span class="w">      </span><span class="n">sa_ref_minus_sap1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sap1</span><span class="p">);</span>
<span class="w">      </span><span class="n">sa_ref_minus_sap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">sa_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sap2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">ct_ref_minus_ctp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ctp1</span><span class="p">);</span>
<span class="w">    </span><span class="n">ct_ref_minus_ctp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ctp2</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ct_ref_minus_ctp1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ct_ref_minus_ctp2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ct_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ct_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0e-6</span><span class="p">;</span>
<span class="w">      </span><span class="n">ct_ref_minus_ctp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ctp1</span><span class="p">);</span>
<span class="w">      </span><span class="n">ct_ref_minus_ctp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">ct_ref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ctp2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">sa_i</span><span class="p">[</span><span class="n">ip_isect</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sa_ref_minus_sap1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sap2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_ref_minus_sap2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sap1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span>
<span class="w">      </span><span class="p">(</span><span class="n">sa_ref_minus_sap1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sa_ref_minus_sap2</span><span class="p">);</span>

<span class="w">    </span><span class="n">ct_i</span><span class="p">[</span><span class="n">ip_isect</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ct_ref_minus_ctp1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ctp2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ct_ref_minus_ctp2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ctp1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span>
<span class="w">      </span><span class="p">(</span><span class="n">ct_ref_minus_ctp1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ct_ref_minus_ctp2</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ct_12</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">ct_12</span><span class="p">;}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ip_1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">ip_1</span><span class="p">;}</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">==========================================================================</span>
<span class="cm">method: gsw_sum(*x,n)</span>
<span class="cm">==========================================================================</span>
<span class="cm">*************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_sum</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w">     </span><span class="n">i</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w">  </span><span class="n">val</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">val</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">==========================================================================</span>
<span class="cm">method: gsw_util_indx(x,n,z,k)</span>
<span class="cm">==========================================================================</span>
<span class="cm">  Finds the index of the value in a monotonically increasing array</span>
<span class="cm">  x  :  array of monotonically increasing values</span>
<span class="cm">  n     :  length of the array</span>
<span class="cm">  z     :  value to be indexed</span>
<span class="cm">  K      : index K - if X(K) &lt;= Z &lt; X(K+1), or</span>
<span class="cm">  N-1                       - if Z = X(N)</span>
<span class="cm">*************************************************************************/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_util_indx</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">ku</span><span class="p">,</span><span class="w"> </span><span class="n">kl</span><span class="p">,</span><span class="w"> </span><span class="n">km</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">kl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">ku</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kl</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ku</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kl</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">km</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">kl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">km</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">km</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kl</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">k</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">k</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***********************************************************</span>
<span class="cm">   =======</span>
<span class="cm">   method: gsw_util_sort_dbl</span>
<span class="cm">   =======</span>

<span class="cm">   The default value for parameter &quot;ASC&quot; is &quot;false&quot;</span>
<span class="cm">   (see TeosBase.h) which means that &quot;orderBySmallToLarge&quot;</span>
<span class="cm">   is called by &quot;sort&quot; (dArray[0] set to smallest value).</span>
<span class="cm">   When parameter &quot;ASC&quot; is &quot;true&quot; &quot;orderByLargeToSmall&quot; is</span>
<span class="cm">   called by &quot;sort&quot; (dArray[0] set to largest value).</span>
<span class="cm">   -------------</span>
<span class="cm">   The exercise is to place the &quot;dArray&quot; and &quot;iArray&quot;</span>
<span class="cm">   into a list of &quot;struct DI&quot; (see TeosBase.h) objects.</span>
<span class="cm">   That list is then ordered by the values in the dArray</span>
<span class="cm">   according to the sequence setting (&quot;ASC&quot;). The sequence</span>
<span class="cm">   begins at dArray[0] and proceeds to the final value.</span>
<span class="cm">************************************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_util_sort_dbl</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">dArray</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nx</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">iArray</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">ASC</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">list</span><span class="o">&lt;</span><span class="n">DI</span><span class="o">&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">pDI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">list</span><span class="o">&lt;</span><span class="n">DI</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nx</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DI</span><span class="w"> </span><span class="n">di</span><span class="p">;</span>
<span class="w">    </span><span class="n">di</span><span class="p">.</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iArray</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="n">di</span><span class="p">.</span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dArray</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="n">pDI</span><span class="o">-&gt;</span><span class="n">push_back</span><span class="p">(</span><span class="n">di</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ASC</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pDI</span><span class="o">-&gt;</span><span class="n">sort</span><span class="p">(</span><span class="n">orderByLargeToSmall</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pDI</span><span class="o">-&gt;</span><span class="n">sort</span><span class="p">(</span><span class="n">orderBySmallToLarge</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">list</span><span class="o">&lt;</span><span class="n">DI</span><span class="o">&gt;::</span><span class="n">const_iterator</span><span class="w"> </span><span class="n">itr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pDI</span><span class="o">-&gt;</span><span class="n">begin</span><span class="p">();</span>
<span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="n">itr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">pDI</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">iArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itr</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="n">dArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itr</span><span class="o">-&gt;</span><span class="n">d</span><span class="p">;</span>
<span class="w">    </span><span class="o">++</span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="o">++</span><span class="n">itr</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pDI</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pDI</span><span class="o">-&gt;</span><span class="n">empty</span><span class="p">();</span>
<span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">pDI</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">==========================================================================</span>
<span class="cm">method: gsw_util_xinterp1(x,y,n,x0)</span>
<span class="cm">==========================================================================</span>
<span class="cm"> Linearly interpolate a real array</span>
<span class="cm"> x      : y array (Must be monotonic)</span>
<span class="cm"> y      : y array</span>
<span class="cm"> n      : length of X and Y arrays</span>
<span class="cm"> x0     : value to be interpolated</span>
<span class="cm"> gsw_xinterp1 : Linearly interpolated value</span>
<span class="cm">*************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_util_xinterp1</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>

<span class="w">  </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsw_util_indx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">x0</span><span class="p">);</span>
<span class="w">  </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">==========================================================================</span>
<span class="cm">method: gsw_util_indxPref(n,z)</span>
<span class="cm">==========================================================================</span>
<span class="cm">  calculates k in simulated array</span>
<span class="cm">  n     :  length of the array</span>
<span class="cm">  z     :  value to be indexed</span>
<span class="cm">  K      : index K - if X(K) &lt;= Z &lt; X(K+1), or</span>
<span class="cm">  N-1                       - if Z = X(N)</span>
<span class="cm">*************************************************************************/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_util_indxPref</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">ku</span><span class="p">,</span><span class="w"> </span><span class="n">kl</span><span class="p">,</span><span class="w"> </span><span class="n">km</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">kl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">ku</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kl</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ku</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kl</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">km</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">kl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">km</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ku</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">km</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kl</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">k</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">pSaarData</span><span class="o">-&gt;</span><span class="n">get_p_ref</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">k</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gsvco_a(xs,ys,z)</span>
<span class="cm">=======</span>
<span class="cm">The code in this method was repeated</span>
<span class="cm">in various places in the C code.</span>
<span class="cm">In the C++ code it is replaced with</span>
<span class="cm">a call to this method.</span>
<span class="cm">**************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gsvco_a</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a000</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a300</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a500</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a010</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a210</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a310</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a410</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a020</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a120</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a220</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a320</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a030</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a230</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span>
<span class="w">    </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a040</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a140</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a050</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a001</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a401</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a111</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a311</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a021</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a221</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a131</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a041</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a002</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a302</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a012</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a212</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a122</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">a003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a103</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a013</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">a004</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">rval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gsvco_b(xs,ys,z)</span>
<span class="cm">=======</span>
<span class="cm">The code in this method was repeated</span>
<span class="cm">in various places in the C code.</span>
<span class="cm">In the C++ code it is replaced with</span>
<span class="cm">a call to this method.</span>
<span class="cm">**************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gsvco_b</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b000</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b300</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b500</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b010</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b210</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b310</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b410</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b020</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b120</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b220</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b320</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b030</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b230</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b040</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b140</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b050</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b001</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b301</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b401</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b111</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b311</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b021</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b221</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b031</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b131</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b041</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b002</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b302</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b012</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b212</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b122</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">b003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b103</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b013</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">b004</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">rval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gsvco_c(xs,ys,z)</span>
<span class="cm">=======</span>
<span class="cm">The code in this method was repeated</span>
<span class="cm">in various places in the C code.</span>
<span class="cm">In the C++ code it is replaced with</span>
<span class="cm">a call to this method.</span>
<span class="cm">**************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gsvco_c</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c000</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c300</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c500</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c010</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c210</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c310</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c410</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c020</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c120</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c220</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c320</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c030</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c230</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c040</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c140</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c050</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c001</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c301</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c401</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c111</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c311</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c021</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c121</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c221</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c031</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c131</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c041</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c002</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c202</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c012</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c112</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c022</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c003</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c103</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c013</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">c004</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">c005</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">rval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gsvco_v(xs,ys,z)</span>
<span class="cm">=======</span>
<span class="cm">The code in this method was repeated</span>
<span class="cm">in various places in the C code.</span>
<span class="cm">In the C++ code it is replaced with</span>
<span class="cm">a call to this method.</span>
<span class="cm">**************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gsvco_v</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v000</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v010</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v020</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v030</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v040</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v050</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v060</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v110</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v120</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v140</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v150</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v210</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v220</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v230</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v240</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v300</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v310</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v320</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v330</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v400</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v410</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v420</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v500</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v510</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v600</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v001</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v021</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v041</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v051</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v111</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v121</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v141</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v201</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v221</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v231</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v311</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v321</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v401</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v411</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v501</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v002</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v012</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v022</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v032</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v042</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v102</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v132</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v212</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v222</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v302</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v312</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v402</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v013</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v023</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v103</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v113</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v203</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v004</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v014</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v104</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">v005</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">v006</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">rval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/********************************************</span>
<span class="cm">    method: gsw_max_d (double, double)</span>
<span class="cm">    previously an inline function</span>
<span class="cm">*********************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_max_d</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">_max</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">_max</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/********************************************</span>
<span class="cm">    method: gsw_min_d (double, double)</span>
<span class="cm">    previously an inline function</span>
<span class="cm">*********************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_min_d</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">_min</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">_min</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************</span>
<span class="cm">    method: gsw_max_u (unsigned, unsigned)</span>
<span class="cm">    previously an inline function</span>
<span class="cm">***************************************************/</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_max_u</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">_max</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">_max</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************</span>
<span class="cm">    method: gsw_min_u (unsigned, unsigned)</span>
<span class="cm">    previously an inline function</span>
<span class="cm">***************************************************/</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_min_u</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">_min</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">_min</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/************************************</span>
<span class="cm">    method: gsw_max_i (int, int)</span>
<span class="cm">    previously an inline function</span>
<span class="cm">************************************/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_max_i</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_max</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">_max</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***********************************</span>
<span class="cm">    method: gsw_min_i (int, int)</span>
<span class="cm">    previously an inline function</span>
<span class="cm">************************************/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_min_i</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_min</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">_min</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_get_v_ct_part(xs,ys,z)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements gsw_alpha ()</span>
<span class="cm">**************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_get_v_ct_part</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">gsw_gsvco_a</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_get_pot_ent(x2,x,y)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements gsw_ct_from_pt(double sa, double pt)</span>
<span class="cm">************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_get_pot_ent</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">61.01362420681071e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">168776.46138048015e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2735.2785605119625e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2574.2164453821433e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1536.6644434977543e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">545.7340497931629e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-50.91091728474331e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">18.30489878927802e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">268.5520265845071e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-12019.028203559312e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3734.858026725145e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2046.7671145057618e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">465.28655623826234e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-0.6370820302376359e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10.650848542359153e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">937.2099110620707e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">588.1802812170108e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">248.39476522971285e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-3.871557904936333e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.6268019854268356e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1687.914374187449e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">246.9598888781377e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">123.59576582457964e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">48.5891069025409e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">936.3206544460336e0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-942.7827304544439e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">369.4389437509002e0</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-33.83664947895248e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">9.987880382780322e0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">))))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">rval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_get_dyn_enth_prt(xs,ys,z)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_dynamic_enthalpy(sa,ct,p)</span>
<span class="cm">************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_get_dyn_enth_prt</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ys</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">rval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h001</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h201</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h301</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h401</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h501</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h601</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h011</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h111</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h211</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h311</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h411</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h511</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h021</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h121</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h221</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h321</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h421</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h031</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h131</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h231</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h331</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h041</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h141</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h241</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h051</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h151</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h061</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h002</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h102</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h302</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h402</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h502</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h012</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h212</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h312</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h412</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h022</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h122</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h222</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h322</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h032</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h132</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h232</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h042</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h142</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h052</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h003</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h103</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h203</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h303</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h403</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h013</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h113</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h213</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h313</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h023</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h123</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h223</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h033</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h133</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h043</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h004</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">xs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h104</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h204</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h014</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h114</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h005</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h105</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h015</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">gsvco</span><span class="p">.</span><span class="n">h006</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gsvco</span><span class="p">.</span><span class="n">h007</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">rval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***********************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_get_g03plusg08(z,y,x2,x)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements gsw_entropy_part(sa,t,p)</span>
<span class="cm">************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_get_g03plusg08</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-270.983805184062</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">776.153611613101</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-196.51255088122</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">28.9796526294175</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.13290083518327</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-24715.571866078</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2910.0729080936</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1513.116771538718</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">546.959324647056</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-111.1208127634436</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.68841343834394</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2210.2236124548363</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2017.52334943521</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1498.081172457456</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-718.6359919632359</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">146.4037555781616</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4.9892131862671505</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-592.743745734632</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1591.873781627888</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1207.261522487504</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">608.785486935364</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">105.4993508931208</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">290.12956292128547</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-973.091553087975</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">602.603274510125</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-276.361526170076</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">32.40953340386105</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-113.90630790850321</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">21.35571525415769</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">67.41756835751434</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">381.06836198507096</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-133.7383902842754</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.023632509086724</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))));</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">729.116529735046</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-343.956902961561</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">124.687671116248</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-31.656964386073</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">7.04658803315449</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-137.1145018408982</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">148.10030845687618</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">12.4848504784754</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.6683558512829</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-175.292041186547</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">83.1923927801819</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">29.483064349429</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-86.1329351956084</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">766.116132004952</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.3834525034224</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">51.2796974779828</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1380.9597954037708</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.50240264723578</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">938.26075044542</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-675.802947790203</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">365.7041791005036</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.30162043765552</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">12.78101825083098</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1190.914967948748</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">298.904564555024</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">145.9491676006352</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2082.7344423998043</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-614.668925894709</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">340.685093521782</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">33.3848202979239</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1721.528607567954</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">674.819060538734</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-356.629112415276</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">88.4080716616</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.84003094423364</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>

<span class="w">  </span><span class="k">return</span><span class="w">  </span><span class="o">-</span><span class="p">(</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_g08_d(x2,z,y,x)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements gsw_dilution_coefficient_t_exact</span>
<span class="cm">***************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_g08_d</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">1.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.25</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">180.142097805543</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-219.1676534131548</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">-16.32775915649044</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">120.7020447884644</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g08_a</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">598.378809221703</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-156.8822727844005</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">204.1334828179377</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10.23755797323846</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1149.174198007428</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-162.5751787551336</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">76.9195462169742</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1380.9597954037708</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.626801985426835</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">703.695562834065</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="mf">11625.62913253464</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1702.453469893412</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_get_g03plusg08_h(z,y,x2,x)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_chem_potential_water_t_exact (sa, t, p)</span>
<span class="cm">*************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_get_g03plusg08_h</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03_g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">101.342743139674</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">100015.695367145</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2544.5765420363</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">284.517778446287</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-33.3146754253611</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">4.20263108803084</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.546428511471039</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">5.90578347909402</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-270.983805184062</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">776.153611613101</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-196.51255088122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">28.9796526294175</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.13290083518327</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-12357.785933039</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1455.0364540468</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-756.558385769359</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">273.479662323528</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-55.5604063817218</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.34420671917197</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">736.741204151612</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-672.50778314507</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">499.360390819152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-239.545330654412</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">48.8012518593872</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.66307106208905</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-148.185936433658</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">397.968445406972</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-301.815380621876</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">152.196371733841</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">26.3748377232802</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">58.0259125842571</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-194.618310617595</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">120.520654902025</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-55.2723052340152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">6.48190668077221</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-18.9843846514172</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.05081646487967</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">9.63108119393062</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">63.5113936641785</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-22.2897317140459</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.17060541818112</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))))));</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08_g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1416.27648484197</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2432.14662381794</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2025.80115603697</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">543.835333000098</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5572509204491</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">49.3667694856254</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-17.1397577419788</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">2.49697009569508</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.6683558512829</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1091.66841042967</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">196.028306689776</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">374.60123787784</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">48.5891069025409</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">36.7571622995805</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">36.0284195611086</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-54.7919133532887</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-4.08193978912261</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">30.1755111971161</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">199.459603073901</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-52.2940909281335</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">68.0444942726459</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">3.41251932441282</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-493.407510141682</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-175.292041186547</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">83.1923927801819</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">29.483064349429</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-43.0664675978042</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">383.058066002476</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-54.1917262517112</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">25.6398487389914</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-10.0227370861875</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">460.319931801257</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">0.875600661808945</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">234.565187611355</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">168.072408311545</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">g03_g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08_g</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g03plusg08_a(double sa, double z, double y, double x2, double x)</span>
<span class="cm">=======</span>
<span class="cm">Supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g03plusg08_a</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03</span><span class="p">,</span><span class="w"> </span><span class="n">g08</span><span class="p">;</span>
<span class="w">  </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">101.342743139674</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">100015.695367145</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2544.5765420363</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">284.517778446287</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-33.3146754253611</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">4.20263108803084</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.546428511471039</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">5.90578347909402</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-270.983805184062</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">776.153611613101</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-196.51255088122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">28.9796526294175</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.13290083518327</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-12357.785933039</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1455.0364540468</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-756.558385769359</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">273.479662323528</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-55.5604063817218</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.34420671917197</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">736.741204151612</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-672.50778314507</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">499.360390819152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-239.545330654412</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">48.8012518593872</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.66307106208905</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-148.185936433658</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">397.968445406972</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-301.815380621876</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">152.196371733841</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">26.3748377232802</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">58.0259125842571</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-194.618310617595</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">120.520654902025</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-55.2723052340152</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">6.48190668077221</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-18.9843846514172</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.05081646487967</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">9.63108119393062</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">63.5113936641785</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-22.2897317140459</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.17060541818112</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))))));</span>

<span class="w">  </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1416.27648484197</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3310.49154044839</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">384.794152978599</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-96.5324320107458</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">15.8408172766824</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.62480156590992</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2432.14662381794</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2025.80115603697</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">543.835333000098</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5572509204491</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">49.3667694856254</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-17.1397577419788</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">2.49697009569508</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.6683558512829</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1091.66841042967</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">196.028306689776</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">374.60123787784</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">48.5891069025409</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">36.7571622995805</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">36.0284195611086</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-54.7919133532887</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-4.08193978912261</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">30.1755111971161</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">199.459603073901</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-52.2940909281335</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">68.0444942726459</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">3.41251932441282</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-493.407510141682</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-175.292041186547</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">83.1923927801819</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">29.483064349429</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-43.0664675978042</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">383.058066002476</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-54.1917262517112</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">25.6398487389914</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-10.0227370861875</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">460.319931801257</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">0.875600661808945</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">234.565187611355</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">168.072408311545</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">729.116529735046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-343.956902961561</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">124.687671116248</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-31.656964386073</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">7.04658803315449</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">880.031352997204</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-225.267649263401</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">91.4260447751259</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-21.6603240875311</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.13016970847183</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-297.728741987187</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">74.726141138756</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">36.4872919001588</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">694.244814133268</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-204.889641964903</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">113.561697840594</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">11.1282734326413</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-860.764303783977</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">337.409530269367</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-178.314556207638</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">44.2040358308</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">7.92001547211682</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))));</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">g08</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">5812.81456626732</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">851.226734946706</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g03plusg08_b(sa,z,y,x2,x)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">**************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g03plusg08_b</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.90578347909402</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-270.983805184062</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">776.153611613101</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-196.51255088122</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">28.9796526294175</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2.13290083518327</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-24715.571866078</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2910.0729080936</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1513.116771538718</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">546.959324647056</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-111.1208127634436</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.68841343834394</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2210.2236124548363</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2017.52334943521</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1498.081172457456</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-718.6359919632359</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">146.4037555781616</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4.9892131862671505</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-592.743745734632</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1591.873781627888</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1207.261522487504</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">608.785486935364</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">105.4993508931208</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">290.12956292128547</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-973.091553087975</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">602.603274510125</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-276.361526170076</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">32.40953340386105</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-113.90630790850321</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">21.35571525415769</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">67.41756835751434</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">381.06836198507096</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-133.7383902842754</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.023632509086724</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))));</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">168.072408311545</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">729.116529735046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-343.956902961561</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">124.687671116248</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-31.656964386073</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">7.04658803315449</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-493.407510141682</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">543.835333000098</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-196.028306689776</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">36.7571622995805</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-137.1145018408982</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">148.10030845687618</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">12.4848504784754</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.6683558512829</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-175.292041186547</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">83.1923927801819</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">29.483064349429</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-86.1329351956084</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">766.116132004952</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.3834525034224</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">51.2796974779828</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1380.9597954037708</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3.50240264723578</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">938.26075044542</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-675.802947790203</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">365.7041791005036</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.30162043765552</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">12.78101825083098</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1190.914967948748</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">298.904564555024</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">145.9491676006352</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2082.7344423998043</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-614.668925894709</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">340.685093521782</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">33.3848202979239</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1721.528607567954</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">674.819060538734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-356.629112415276</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">88.4080716616</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.84003094423364</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">g08</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">851.226734946706</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g03plusg08_c(z,y,x2,x)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g03plusg08_c</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100015.695367145</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5089.1530840726</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">853.5533353388611</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-133.2587017014444</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">21.0131554401542</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">3.278571068826234</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-270.983805184062</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1552.307223226202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-589.53765264366</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">115.91861051767</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10.664504175916349</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1455.0364540468</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1513.116771538718</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">820.438986970584</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-222.2416255268872</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">21.72103359585985</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-672.50778314507</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">998.720781638304</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-718.6359919632359</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">195.2050074375488</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">8.31535531044525</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">397.968445406972</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-603.630761243752</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">456.589115201523</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">105.4993508931208</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-194.618310617595</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">63.5113936641785</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">9.63108119393062</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-44.5794634280918</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">24.511816254543362</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">241.04130980405</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-165.8169157020456</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">25.92762672308884</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))));</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3310.49154044839</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">769.588305957198</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-289.5972960322374</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">63.3632691067296</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">13.1240078295496</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">199.459603073901</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-54.7919133532887</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">36.0284195611086</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.6683558512829</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-8.16387957824522</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.52653359134831</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-104.588181856267</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">204.1334828179377</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">13.65007729765128</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-175.292041186547</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">166.3847855603638</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">383.058066002476</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-460.319931801257</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">234.565187611355</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.3834525034224</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">76.9195462169742</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">729.116529735046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">374.063013348744</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-126.627857544292</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">35.23294016577245</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-860.764303783977</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">694.244814133268</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-297.728741987187</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">149.452282277512</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">109.46187570047641</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-409.779283929806</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">340.685093521782</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">44.5130937305652</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">674.819060538734</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-534.943668622914</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">176.8161433232</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">39.600077360584095</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.0e-8</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g03plusg08_d(z,y,x2,x)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g03plusg08_d</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-24715.571866078</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2910.0729080936</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1513.116771538718</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">546.959324647056</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-111.1208127634436</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.68841343834394</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4420.4472249096725</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-4035.04669887042</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2996.162344914912</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1437.2719839264719</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">292.8075111563232</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">9.978426372534301</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1778.231237203896</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4775.621344883664</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3621.784567462512</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">1826.356460806092</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">316.49805267936244</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1160.5182516851419</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3892.3662123519</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2410.4130980405</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1105.446104680304</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">129.6381336154442</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-569.531539542516</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">128.13429152494615</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">404.50541014508605</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1905.341809925355</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-668.691951421377</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">245.11816254543362</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))));</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-86.1329351956084</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-137.1145018408982</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">296.20061691375236</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-205.67709290374563</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">766.116132004952</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.3834525034224</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">51.2796974779828</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-60.136422517125</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2761.9195908075417</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">10.50720794170734</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">2814.78225133626</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1351.605895580406</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1097.1125373015109</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-433.20648175062206</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">63.905091254154904</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3572.7449038462437</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">896.713693665072</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">437.84750280190565</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4165.4688847996085</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1229.337851789418</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">681.370187043564</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">66.7696405958478</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1721.528607567954</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">674.819060538734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-356.629112415276</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">88.4080716616</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.84003094423364</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.000625</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g03plusg08_e(z,y,x2,x)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g03plusg08_e</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-270.983805184062</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1552.307223226202</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-589.53765264366</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">115.91861051767</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10.664504175916349</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2910.0729080936</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3026.233543077436</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1640.877973941168</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-444.4832510537744</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">43.4420671917197</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2017.52334943521</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2996.162344914912</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2155.907975889708</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">585.6150223126464</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">24.946065931335752</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1591.873781627888</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2414.523044975008</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">1826.356460806092</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">421.9974035724832</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-973.091553087975</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1205.20654902025</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-829.084578510228</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">129.6381336154442</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">381.06836198507096</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">67.41756835751434</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-267.4767805685508</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">147.07089752726017</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))));</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">729.116529735046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">374.063013348744</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-126.627857544292</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">35.23294016577245</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-175.292041186547</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.6683558512829</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">166.3847855603638</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">766.116132004952</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1380.9597954037708</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">938.26075044542</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-216.7669050068448</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">153.8390924339484</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1721.528607567954</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2082.7344423998043</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1190.914967948748</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">597.809129110048</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">437.84750280190565</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1229.337851789418</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">1022.055280565346</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">133.5392811916956</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1349.638121077468</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1069.887337245828</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">353.6322866464</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">79.20015472116819</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.5e-10</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g03plusg08_f(z,y,x2,x);</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g03plusg08_f</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">1.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.25</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">180.142097805543</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-219.1676534131548</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-16.32775915649044</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">120.7020447884644</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">));</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">g08</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">598.378809221703</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-156.8822727844005</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="p">(</span><span class="mf">204.1334828179377</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10.23755797323846</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1149.174198007428</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-162.5751787551336</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">76.9195462169742</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1380.9597954037708</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.626801985426835</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">703.695562834065</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">11625.62913253464</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="mf">1702.453469893412</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">x2</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g08</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g03plusg08_g(z,y,x2,x);</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g03plusg08_g</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g03</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-5089.1530840726</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1707.1066706777221</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-399.7761051043332</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">84.0526217606168</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">16.39285534413117</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1552.307223226202</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1179.07530528732</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">347.75583155301</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">42.658016703665396</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1513.116771538718</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1640.877973941168</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-666.7248765806615</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">86.8841343834394</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">998.720781638304</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1437.2719839264719</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">585.6150223126464</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">33.261421241781</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-603.630761243752</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">913.178230403046</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">316.49805267936244</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">241.04130980405</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-44.5794634280918</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.023632509086724</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-331.6338314040912</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">77.78288016926652</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))));</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">769.588305957198</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-579.1945920644748</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">190.08980732018878</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">52.4960313181984</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-104.588181856267</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-8.16387957824522</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">181.05306718269662</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">408.2669656358754</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">40.95023189295384</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">166.3847855603638</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">176.898386096574</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-108.3834525034224</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">153.8390924339484</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">748.126026697488</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-379.883572632876</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">140.9317606630898</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">674.819060538734</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1069.887337245828</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">530.4484299696</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">158.40030944233638</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-409.779283929806</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">149.452282277512</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">218.92375140095282</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">681.370187043564</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">133.5392811916956</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">g03</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g08</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-16</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g08_a(sa, z, y, x)</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g08_a</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8645.36753595126</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-6620.98308089678</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">769.588305957198</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-193.0648640214916</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">31.6816345533648</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">5.24960313181984</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-7296.43987145382</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">8103.20462414788</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2290036817964</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">197.4670779425016</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-68.5590309679152</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">9.98788038278032</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-5458.34205214835</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">980.14153344888</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2247.60742726704</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">340.1237483177863</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">180.142097805543</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-219.1676534131548</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-16.32775915649044</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">120.7020447884644</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">598.378809221703</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-156.8822727844005</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">204.1334828179377</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10.23755797323846</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-129.1994027934126</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1149.174198007428</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-162.5751787551336</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">76.9195462169742</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-30.0682112585625</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1380.9597954037708</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.626801985426835</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">703.695562834065</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1458.233059470092</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">249.375342232496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-63.313928772146</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">14.09317606630898</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1760.062705994408</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-450.535298526802</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">182.8520895502518</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-43.3206481750622</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4.26033941694366</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-595.457483974374</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">149.452282277512</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">72.9745838003176</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1388.489628266536</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-409.779283929806</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">227.123395681188</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">22.2565468652826</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1721.528607567954</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">674.819060538734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-356.629112415276</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">88.4080716616</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">15.84003094423364</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))));</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">g08</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="mf">11625.62913253464</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1702.453469893412</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g08</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g08_b(z,y,x);</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g08_b</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-6620.98308089678</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1539.176611914396</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-579.1945920644748</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">126.7265382134592</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">26.2480156590992</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">598.378809221703</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-219.1676534131548</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">180.142097805543</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">-32.65551831298088</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">362.10613436539325</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-313.764545568801</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">612.4004484538132</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">40.95023189295384</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">499.15435668109143</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">265.347579144861</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1149.174198007428</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1380.9597954037708</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">703.695562834065</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-325.1503575102672</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">230.7586386509226</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1458.233059470092</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1375.827611846244</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">748.126026697488</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-253.255715088584</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">70.4658803315449</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1721.528607567954</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1388.489628266536</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-595.457483974374</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">298.904564555024</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">218.92375140095282</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-819.558567859612</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">681.370187043564</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">89.0261874611304</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1349.638121077468</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1069.887337245828</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">353.6322866464</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">79.20015472116819</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5e-8</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************************</span>
<span class="cm">=======</span>
<span class="cm">method: gsw_gibbs_g08_c(sa,z,y,x);</span>
<span class="cm">=======</span>
<span class="cm">This method supplements method gsw_gibbs(ns,nt,np,sa,t,p) for clarity.</span>
<span class="cm">****************************************************************************************/</span>
<span class="kt">double</span><span class="w"> </span><span class="n">TeosBase</span><span class="o">::</span><span class="n">gsw_gibbs_g08_c</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">g08</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1187.3715515697959</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1458.233059470092</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-687.913805923122</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">249.375342232496</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-63.313928772146</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">14.09317606630898</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1480.222530425046</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2175.341332000392</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-980.14153344888</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">220.542973797483</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-548.4580073635929</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">592.4012338275047</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-274.2361238716608</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">49.9394019139016</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90.6734234051316</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-525.876123559641</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">249.57717834054571</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">88.449193048287</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-258.3988055868252</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2298.348396014856</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-325.1503575102672</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">153.8390924339484</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-90.2046337756875</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">4142.8793862113125</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">10.50720794170734</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2814.78225133626</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">3520.125411988816</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1351.605895580406</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">731.4083582010072</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-216.60324087531103</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="mf">25.56203650166196</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-2381.829935897496</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">597.809129110048</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">291.8983352012704</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">4165.4688847996085</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-1229.337851789418</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">681.370187043564</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">66.7696405958478</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-3443.057215135908</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1349.638121077468</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">-713.258224830552</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="p">(</span><span class="mf">176.8161433232</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">31.68006188846728</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="p">))));</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sa</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">g08</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1702.453469893412</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gtc</span><span class="p">.</span><span class="n">gsw_sfac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g08</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Seabot2 Team, ENSTA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>